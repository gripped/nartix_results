--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,45 +1,28 @@
 
 pkgname=mgard
-pkgver=1.5.2
-pkgrel=2
+pkgver=1.0.0
+pkgrel=1
 pkgdesc="MultiGrid Adaptive Reduction of Data"
 arch=(x86_64)
 url="https://github.com/CODARcode/MGARD"
-license=(Apache-2.0)
-depends=(
-  gcc-libs
-  glibc
-  protobuf libprotobuf.so
-  zlib libz.so
-  zstd libzstd.so
-)
-makedepends=(
-  catch2
-  cmake
-  ninja
-  python
-)
+license=(Apache)
+depends=(blas lapack glibc yaml-cpp zlib zstd)
+makedepends=(cmake) # tclap 1.4 required but unreleased
 source=(${url}/archive/${pkgver}/${pkgname}-${pkgver}.tar.gz)
-b2sums=('fbebe814483f7ebbfd1f3bc33ca387fe77f7b0f0de369e5c4d2525d01172146197458e1a070824a8697fd0b9acef267f5813562aa9848db32d9175f879ce13f7')
+sha256sums=('2dd153abc9bef7d87923cdefca6243b2050b7522e1d2b196e04c73c5cee6e880')
 
 build() {
-  local cmake_flags=(
-    -B build -S ${pkgname^^}-${pkgver} -G Ninja
+  cmake -B build -S ${pkgname^^}-${pkgver} \
     -DCMAKE_INSTALL_PREFIX=/usr
-    -DMGARD_ENABLE_SERIAL=ON
-    -DMGARD_ENABLE_OPENMP=ON
-    -DMGARD_ENABLE_MDR=ON
-    -DBUILD_TESTING=ON
-    -Wno-dev
-  )
-  cmake "${cmake_flags[@]}"
-  cmake --build build
+  make -C build
 }
 
 check() {
-  ctest --test-dir build --output-on-failure
+  cd build
+  ctest -v --output-on-failure
 }
 
 package() {
-  DESTDIR="$pkgdir" cmake --install build
+  make -C build DESTDIR="${pkgdir}" install
+  rm "${pkgdir}"/usr/include/mgard/MGARDConfig.hpp.in
 }


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,12 +1,7 @@
-catch2
+blas
 cmake
-gcc-libs
 glibc
-libprotobuf.so
-libz.so
-libzstd.so
-ninja
-protobuf
-python
+lapack
+yaml-cpp
 zlib
 zstd

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,13 +1,5 @@
 build() {
-local cmake_flags=(
--B build -S ${pkgname^^}-${pkgver} -G Ninja
+cmake -B build -S ${pkgname^^}-${pkgver} \
 -DCMAKE_INSTALL_PREFIX=/usr
--DMGARD_ENABLE_SERIAL=ON
--DMGARD_ENABLE_OPENMP=ON
--DMGARD_ENABLE_MDR=ON
--DBUILD_TESTING=ON
--Wno-dev
-)
-cmake "${cmake_flags[@]}"
-cmake --build build
+make -C build
 }
