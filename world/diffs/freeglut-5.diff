--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,50 +1,37 @@
 
 pkgname=freeglut
-pkgver=3.6.0
+pkgver=3.4.0
 pkgrel=1
-pkgdesc="Free OpenGL Utility Toolkit"
+pkgdesc="Provides functionality for small OpenGL programs"
 url="https://freeglut.sourceforge.net/"
 arch=(x86_64)
-license=(X11)
-depends=(
-  glibc
-  libgl
-  libx11
-  libxi
-  libxrandr
-  libxxf86vm
-)
-makedepends=(
-  cmake
-  git
-  glu
-  mesa
-  ninja
-)
+license=(MIT)
+depends=(libxi libxrandr libgl)
+makedepends=(mesa glu libxxf86vm cmake ninja git)
+replaces=(glut)
 provides=(glut)
 conflicts=(glut)
-source=("git+https://github.com/FreeGLUTProject/freeglut#tag=v$pkgver")
-b2sums=('2ce2bc7ff759405be701f1c43e4fe2154fce6a4ffe3801ba1f51ff362698b248b9a3d42929c44825a6f3f67029852a284cad49acbdc14908ac6c651c6c56e571')
+options=(debug)
+_commit=63c0e78d84ecbfcf8accd8bac04404427899053b  # tags/v3.4.0
+source=("git+https://github.com/FreeGLUTProject/freeglut#commit=$_commit")
+b2sums=('SKIP')
+
+pkgver() {
+  cd freeglut
+  git describe --tags | sed 's/^v//;s/[^-]*-g/r&/;s/-/+/g'
+}
 
 prepare() {
   cd freeglut
 }
 
 build() {
-  local cmake_options=(
-    -D CMAKE_BUILD_TYPE=None
-    -D CMAKE_INSTALL_LIBDIR=lib
-    -D CMAKE_INSTALL_PREFIX=/usr
-    -D FREEGLUT_BUILD_STATIC_LIBS=OFF
-  )
-
-  cmake -S freeglut -B build -G Ninja "${cmake_options[@]}"
+  cmake -S freeglut -B build -G Ninja \
+    -DFREEGLUT_BUILD_STATIC_LIBS=OFF \
+    -DCMAKE_INSTALL_PREFIX=/usr \
+    -DCMAKE_INSTALL_LIBDIR=lib \
+    -DCMAKE_BUILD_TYPE=None
   cmake --build build
-}
-
-check() {
-  cd build
-  ctest --output-on-failure --stop-on-failure -j$(nproc)
 }
 
 package() {


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,9 +1,7 @@
 cmake
 git
-glibc
 glu
 libgl
-libx11
 libxi
 libxrandr
 libxxf86vm

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -2,12 +2,10 @@
 cd freeglut
 }
 build() {
-local cmake_options=(
--D CMAKE_BUILD_TYPE=None
--D CMAKE_INSTALL_LIBDIR=lib
--D CMAKE_INSTALL_PREFIX=/usr
--D FREEGLUT_BUILD_STATIC_LIBS=OFF
-)
-cmake -S freeglut -B build -G Ninja "${cmake_options[@]}"
+cmake -S freeglut -B build -G Ninja \
+-DFREEGLUT_BUILD_STATIC_LIBS=OFF \
+-DCMAKE_INSTALL_PREFIX=/usr \
+-DCMAKE_INSTALL_LIBDIR=lib \
+-DCMAKE_BUILD_TYPE=None
 cmake --build build
 }
