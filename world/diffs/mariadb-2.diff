--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -3,13 +3,13 @@
 pkgbase=mariadb
 pkgname=('mariadb-libs' 'mariadb-clients' 'mariadb' 'mytop')
 pkgdesc='Fast SQL database server, derived from MySQL'
-pkgver=12.2.2
-pkgrel=2
+pkgver=12.1.2
+pkgrel=1
 arch=('x86_64')
 license=('GPL-2.0-only')
 url='https://mariadb.org/'
 makedepends=('git' 'boost' 'bzip2' 'cmake' 'cracklib' 'curl' 'jemalloc' 'judy' 'krb5' 'liburing'
-             'libxcrypt' 'libxml2' 'lz4' 'openssl' 'pcre2' 'systemd' 'zlib' 'zstd' 'xz')
+             'libxcrypt' 'libxml2' 'lz4' 'openssl' 'pcre2' 'zlib' 'zstd' 'xz')
 validpgpkeys=('177F4010FE56CA3336300305F1656F24C74CD1D8') # MariaDB Signing Key <signing-key@mariadb.org>
 source=("mariadb::git+https://github.com/MariaDB/server.git#tag=mariadb-${pkgver}?signed"
         'git+https://github.com/MariaDB/mariadb-connector-c.git'
@@ -19,8 +19,8 @@
         'git+https://github.com/mariadb-corporation/libmarias3.git'
         'git+https://github.com/mariadb-corporation/mariadb-columnstore-engine.git'
         '0001-arch-specific.patch'
-        '0002-MDEV-38811-crash-in-information_schema.table_constra.patch')
-sha256sums=('b93cca3f38b90c3b70e22b484f074ac0d0655c1aa80f8c59593bdda2d950b0cc'
+'mariadb.sysusers.conf' 'mariadb.tmpfiles.conf')
+sha256sums=('307cd1f1ee54424dc11724de074fbac57f02fc04d9836fc6f139931668cd9879'
             'SKIP'
             'SKIP'
             'SKIP'
@@ -28,7 +28,8 @@
             'SKIP'
             'SKIP'
             'dd5e4846f6173097130e44d60cdd880c7d1b98bf5177baaca67c0ab9e5134516'
-            'b7f475587ec8657aba5b733e90e4182a69e8bee1eb18201a67726bca5307720b')
+            'd21fa98b57b3f44d1731551ac441bf24b75662fb26393757aa22f9cb92d470cd'
+            '65dfade5bfa2338ec201e3fdcddd819ee87a94a27e1c7c293e890927f4ac7555')
 
 prepare() {
   cd mariadb/
@@ -43,13 +44,11 @@
   git -c protocol.file.allow=always submodule update
 
   patch -Np1 < ../0001-arch-specific.patch
-
-  patch -Np1 < ../0002-MDEV-38811-crash-in-information_schema.table_constra.patch
 }
 
 build() {
   local _cmake_options=(
-    -DCOMPILATION_COMMENT="Arch Linux"
+    -DCOMPILATION_COMMENT="Artix Linux"
     -DCMAKE_BUILD_TYPE=RelWithDebInfo
     -Wno-dev
 
@@ -61,7 +60,7 @@
     -DINSTALL_SCRIPTDIR=bin
     -DINSTALL_INCLUDEDIR=include/mysql
     -DINSTALL_PLUGINDIR=lib/mysql/plugin
-    -DINSTALL_SYSTEMD_UNITDIR=lib/systemd/system/
+    -DINSTALL_SYSTEMD_UNITDIR=no
     -DINSTALL_SYSTEMD_SYSUSERSDIR=lib/sysusers.d/
     -DINSTALL_SYSTEMD_TMPFILESDIR=lib/tmpfiles.d/
     -DINSTALL_SHAREDIR=share
@@ -86,7 +85,7 @@
     -DWITH_PCRE2=system
     -DWITH_READLINE=ON
     -DWITH_SSL=system
-    -DWITH_SYSTEMD=yes
+    -DWITH_SYSTEMD=no
     -DWITH_UNIT_TESTS=OFF
     -DWITH_ZLIB=system
   )
@@ -181,7 +180,7 @@
            'coreutils'
            'libxml2' 'libxml2.so'
            'lz4' 'liblz4.so'
-           'systemd-libs' 'libsystemd.so'
+
            'zstd' 'libzstd.so')
   optdepends=('cracklib: for cracklib plugin'
               'curl: for ha_s3 plugin'
@@ -192,7 +191,7 @@
               'xz: lzma provider')
   conflicts=('mysql')
   provides=("mariadb-server=${pkgver}"
-	    'mysql')
+	    "mysql=${pkgver}")
   options=('emptydirs')
 
   cd build
@@ -214,8 +213,8 @@
   mv usr/share/user_map.conf etc/security/
   mv usr/share/pam_user_map.so usr/lib/security/
 
-  rm -r usr/share/mysql/systemd/
-  rm -r usr/lib/systemd/system/mariadb@bootstrap.service.d
+  install -Dm644 $srcdir/mariadb.sysusers.conf usr/lib/sysusers.d/mariadb.conf
+  install -Dm644 $srcdir/mariadb.tmpfiles.conf usr/lib/tmpfiles.d/mariadb.conf
 
   rm usr/bin/{mariadb{_,-},mysql_}config
   rm -r usr/include/


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -15,7 +15,6 @@
 libncursesw.so
 libpcre2-8.so
 libssl.so
-libsystemd.so
 liburing
 liburing.so
 libxcrypt
@@ -32,8 +31,6 @@
 perl
 perl-dbd-mariadb
 perl-term-readkey
-systemd
-systemd-libs
 xz
 zlib
 zstd