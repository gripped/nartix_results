--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,7 +1,7 @@
 
 pkgname=arrow
 pkgver=18.1.0
-pkgrel=3
+pkgrel=2
 pkgdesc="Columnar in-memory analytics layer for big data."
 arch=(x86_64)
 url="https://arrow.apache.org"
@@ -9,10 +9,6 @@
 depends=(
   abseil-cpp
   apache-orc
-  aws-crt-cpp
-  aws-sdk-cpp-core
-  aws-sdk-cpp-iam
-  aws-sdk-cpp-s3
   brotli
   bzip2
   gcc-libs
@@ -39,33 +35,20 @@
   rapidjson
   xsimd
 )
-checkdepends=(
-  minio
-  python
-)
 provides=(parquet-cpp)
 conflicts=(parquet-cpp)
 source=(
   https://archive.apache.org/dist/$pkgname/$pkgname-$pkgver/apache-$pkgname-$pkgver.tar.gz{,.asc}
   git+https://github.com/apache/parquet-testing.git
   git+https://github.com/apache/arrow-testing.git
-  fix-repetition-levels-for-encryption-test.patch
 )
 sha512sums=('7249c03a6097bc64fb0092143e4d4aaef3227565147e6254f026ddd504177c8dd565a184a0df39743dc989070dc3785e5b66f738c8e310ed9c982b61c2ec4914'
             'SKIP'
             'SKIP'
-            'SKIP'
-            '225c1d3b513ab3f82ffa946c22a2aebc7f43af0cdbbede55cbbd9746637d8a032a2e7b888bed6d6e152d28d6d78c842a298187fab94d8864867ba436eeee835d')
+            'SKIP')
 validpgpkeys=(265F80AB84FE03127E14F01125BCCA5220D84079  # Krisztian Szucs (apache) <szucs.krisztian@gmail.com>
               08D3564B7C6A9CAFBFF6A66791D18FCF079F8007  # Kouhei Sutou <kou@cozmixng.org>
               AF6AADA4C9835B75973FF5DA275C532289DD0F4A) # Raúl Cumplido Domínguez (CODE SIGNING KEY) <raulcd@apache.org>
-
-prepare() {
-  cd apache-$pkgname-$pkgver
-  patch -Np1 -i ../fix-repetition-levels-for-encryption-test.patch
-
-  sed -i 's|COMPONENTS config|COMPONENTS|' cpp/cmake_modules/FindAWSSDKAlt.cmake
-}
 
 build() {
   local cmake_options=(
@@ -94,7 +77,6 @@
     -DARROW_JSON=ON
     -DARROW_ORC=ON
     -DARROW_PARQUET=ON
-    -DARROW_S3=ON
     -DARROW_SUBSTRAIT=ON
     -DARROW_TENSORFLOW=ON
     -DARROW_USE_GLOG=ON


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,9 +1,5 @@
 abseil-cpp
 apache-orc
-aws-crt-cpp
-aws-sdk-cpp-core
-aws-sdk-cpp-iam
-aws-sdk-cpp-s3
 boost
 brotli
 bzip2

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,8 +1,3 @@
-prepare() {
-cd apache-$pkgname-$pkgver
-patch -Np1 -i ../fix-repetition-levels-for-encryption-test.patch
-sed -i 's|COMPONENTS config|COMPONENTS|' cpp/cmake_modules/FindAWSSDKAlt.cmake
-}
 build() {
 local cmake_options=(
 -B build
@@ -30,7 +25,6 @@
 -DARROW_JSON=ON
 -DARROW_ORC=ON
 -DARROW_PARQUET=ON
--DARROW_S3=ON
 -DARROW_SUBSTRAIT=ON
 -DARROW_TENSORFLOW=ON
 -DARROW_USE_GLOG=ON
