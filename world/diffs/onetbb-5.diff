--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,36 +1,35 @@
 
 pkgname=onetbb
-pkgver=2021.12.0
+pkgver=2021.11.0
 pkgrel=1
 pkgdesc='High level abstract threading library (oneAPI Threading Building Blocks)'
 arch=('x86_64')
 url='https://oneapi-src.github.io/oneTBB/'
 license=('Apache')
 depends=('gcc-libs' 'hwloc')
-makedepends=('cmake' 'inetutils' 'ninja' 'python' 'swig' 'python-setuptools')
+makedepends=('cmake' 'inetutils' 'ninja' 'python' 'swig')
 conflicts=('intel-tbb' 'tbb')
 provides=("intel-tbb=$pkgver" "tbb=$pkgver")
 replaces=('intel-tbb' 'tbb')
 source=(https://github.com/oneapi-src/oneTBB/archive/v$pkgver/$pkgname-$pkgver.tar.gz)
-sha512sums=('64022bcb61cf7b2030a1bcc11168445ef9f0d69b70290233a7febb71cc7a12cc2282dddc045f84e30893efe276342f02fd78d176706268eeaefe9aac7446d4e9')
+sha512sums=('4779141b7602f2fa3a509fdd346824ba270a3a568df3649ce8cb51264d233df5cec5e5cb67b91319dd11d3d5e054697b4ed345e07216107985ddb6e1e7ef94e5')
 
 build() {
-  cmake -B build -S oneTBB-$pkgver -GNinja \
+  cd oneTBB-$pkgver
+  cmake . -GNinja \
           -DCMAKE_INSTALL_PREFIX=/usr \
           -DTBB_STRICT=OFF \
           -DTBB4PY_BUILD=ON \
           -DCMAKE_BUILD_TYPE=None
-  cmake --build build
+  ninja all python_build
 }
 
 check() {
-  cd build
+  cd oneTBB-$pkgver
   ninja test
 }
 
 package() {
-  DESTDIR="$pkgdir" cmake --install build
-  rm -r "$pkgdir"/usr/lib/python*
-  cd oneTBB-$pkgver/python
-  TBBROOT="$pkgdir"/usr python setup.py install --root="$pkgdir"
+  cd oneTBB-$pkgver
+  DESTDIR="$pkgdir" ninja install
 }


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -4,5 +4,4 @@
 inetutils
 ninja
 python
-python-setuptools
 swig

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,8 +1,9 @@
 build() {
-cmake -B build -S oneTBB-$pkgver -GNinja \
+cd oneTBB-$pkgver
+cmake . -GNinja \
 -DCMAKE_INSTALL_PREFIX=/usr \
 -DTBB_STRICT=OFF \
 -DTBB4PY_BUILD=ON \
 -DCMAKE_BUILD_TYPE=None
-cmake --build build
+ninja all python_build
 }
