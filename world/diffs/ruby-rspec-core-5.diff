--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,10 +1,10 @@
 
 _gemname=rspec-core
 pkgname=ruby-${_gemname}
-pkgver=3.13.4
-pkgrel=1
+pkgver=3.13.1
+pkgrel=3
 pkgdesc='RSpec runner and formatters'
-url='https://github.com/rspec/rspec'
+url='https://github.com/rspec/rspec-core'
 arch=('any')
 license=('MIT')
 depends=(
@@ -12,103 +12,18 @@
   ruby-rspec-support
 )
 makedepends=(
-  git
   ruby-rdoc
 )
-checkdepends=(
-  ruby-bigdecimal
-  ruby-bundler
-  ruby-childprocess
-  ruby-coderay
-  ruby-diff-lcs
-  ruby-drb
-  ruby-ffi
-  ruby-minitest
-  ruby-mutex_m
-  ruby-rake
-  ruby-rspec
-  ruby-rspec-core
-  ruby-rspec-expectations
-  ruby-rspec-mocks
-  ruby-test-unit
-  ruby-thread_order
-)
 options=('!emptydirs')
-source=(
-  "${pkgname}::git+${url}#tag=${_gemname}-v${pkgver}"
-  "${pkgname}_no_version_constraints.patch"
-  "${pkgname}_fix_tests.patch"
-)
-sha512sums=('12b99eafd5f72ba497d72e112dea41e99f263e12a2fc6926e2f232b9a5be7ac368eb0a5c312220c080e1e3939aac7a2c74e11368d2051990c7f7c3c21521cf15'
-            '2225c734926ffb9eee0a3a19a796f7c1a1489839c6b00650014c2396140adae87c94f2f11575bf594c2ad68e088af7100cffeb14c08472b07ac6f6c57526b632'
-            '868273158229d71f3e596590e44b066c89f34a13a51de32770cb6b1e4d15e3487d735c1bb1c414fd9b5fb43106ed3bac020e0972962b3ecb760a317bfe67c6e5')
-b2sums=('ff650041af7a64e5baa6d6a908e5a0d5b7787c434d510efa4d51fa4edad4935771b4977e990fa40d155830fad9e33c22789039b5944dcc94c3520a8c19732f42'
-        '4429c7d4bf68f745a7db3dfea0d00cbacab78d882dcd393cf203555ceee760b46c2e28806e5d1217f41d6b65d326d82593501df4b938d054bc004162469b2857'
-        '4fb189fad2b9949051a19f330b9da93f972faa3092fe25fcdbe9219f8cfd55d1ed2f8a74b242f0eaf86ab7e386f9e9a5b658e4245254366ad4c3a4373470e347')
+source=(https://rubygems.org/downloads/${_gemname}-${pkgver}.gem)
+noextract=(${_gemname}-${pkgver}.gem)
+sha512sums=('c6b906fab43ece1145480331372094eb9c02059d8aa7903b22d9bca3e6f76f34e68cfcf3b40a64ff5b00b22e564d135f03c93934bc05cba9ec5d1b1cda0e2769')
 
-prepare() {
-  cd "${pkgname}"
-
-  patch --verbose --strip=1 --input="../${pkgname}_no_version_constraints.patch"
-  patch --verbose --strip=1 --input="../${pkgname}_fix_tests.patch"
+package() {
+  local _gemdir="$(gem environment gemdir)"
+  gem install --ignore-dependencies --no-user-install -i "${pkgdir}${_gemdir}" -n "${pkgdir}/usr/bin" ${_gemname}-${pkgver}.gem
+  install -Dm 644 "${pkgdir}${_gemdir}/gems/${_gemname}-${pkgver}/LICENSE.md" "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
+  install -Dm 644 "${pkgdir}${_gemdir}/gems/${_gemname}-${pkgver}/README.md" "${pkgdir}/usr/share/doc/${pkgname}/README"
+  rm "${pkgdir}/${_gemdir}/cache/${_gemname}-${pkgver}.gem"
 }
 
-build() {
-  cd "${pkgname}/${_gemname}"
-
-  local _gemdir="$(gem env gemdir)"
-
-  gem build --verbose "${_gemname}.gemspec"
-
-  gem install \
-    --local \
-    --verbose \
-    --ignore-dependencies \
-    --no-user-install \
-    --install-dir "tmp_install${_gemdir}" \
-    --bindir "tmp_install/usr/bin" \
-    "${_gemname}-${pkgver}.gem"
-
-  rm --force --recursive --verbose \
-    "tmp_install${_gemdir}/cache/" \
-    "tmp_install${_gemdir}/gems/${_gemname}-${pkgver}/vendor/" \
-    "tmp_install${_gemdir}/doc/${_gemname}-${pkgver}/ri/ext/"
-
-  find "tmp_install${_gemdir}/gems/" \
-    -type f \
-    \( \
-      -iname "*.o" -o \
-      -iname "*.c" -o \
-      -iname "*.so" -o \
-      -iname "*.time" -o \
-      -iname "gem.build_complete" -o \
-      -iname "Makefile" \
-    \) \
-    -delete
-
-  find "tmp_install${_gemdir}/extensions/" \
-    -type f \
-    \( \
-      -iname "mkmf.log" -o \
-      -iname "gem_make.out" \
-    \) \
-    -delete
-}
-
-check() {
-  cd "${pkgname}/${_gemname}"
-
-  local _gemdir="$(gem env gemdir)"
-
-  GEM_HOME="tmp_install${_gemdir}" rake spec
-}
-
-package() {
-  cd "${pkgname}/${_gemname}"
-
-  cp --archive --verbose tmp_install/* "${pkgdir}"
-
-  install --verbose -D --mode=0644 LICENSE* --target-directory "${pkgdir}/usr/share/licenses/${pkgname}"
-  install --verbose -D --mode=0644 *.md --target-directory "${pkgdir}/usr/share/doc/${pkgname}"
-}
-


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,4 +1,3 @@
-git
 ruby-erb
 ruby-rdoc
 ruby-rspec-support

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,40 +0,0 @@
-prepare() {
-cd "${pkgname}"
-patch --verbose --strip=1 --input="../${pkgname}_no_version_constraints.patch"
-patch --verbose --strip=1 --input="../${pkgname}_fix_tests.patch"
-}
-build() {
-cd "${pkgname}/${_gemname}"
-local _gemdir="$(gem env gemdir)"
-gem build --verbose "${_gemname}.gemspec"
-gem install \
---local \
---verbose \
---ignore-dependencies \
---no-user-install \
---install-dir "tmp_install${_gemdir}" \
---bindir "tmp_install/usr/bin" \
-"${_gemname}-${pkgver}.gem"
-rm --force --recursive --verbose \
-"tmp_install${_gemdir}/cache/" \
-"tmp_install${_gemdir}/gems/${_gemname}-${pkgver}/vendor/" \
-"tmp_install${_gemdir}/doc/${_gemname}-${pkgver}/ri/ext/"
-find "tmp_install${_gemdir}/gems/" \
--type f \
-\( \
--iname "*.o" -o \
--iname "*.c" -o \
--iname "*.so" -o \
--iname "*.time" -o \
--iname "gem.build_complete" -o \
--iname "Makefile" \
-\) \
--delete
-find "tmp_install${_gemdir}/extensions/" \
--type f \
-\( \
--iname "mkmf.log" -o \
--iname "gem_make.out" \
-\) \
--delete
-}
