--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -3,8 +3,7 @@
 pkgname=('grpc' 'python-grpcio' 'python-grpcio-tools' 'php-grpc' 'php-legacy-grpc' 'grpc-cli')
 pkgver=1.71.0
 _gtestver=2dd1c131950043a8ad5ab0d2dda0e0970596586a
-_protover=30.0
-pkgrel=2
+pkgrel=1
 pkgdesc="High performance, open source, general RPC framework that puts mobile and HTTP/2 first."
 arch=('x86_64')
 url='https://grpc.io'
@@ -29,11 +28,9 @@
   're2c'
 )
 source=("https://github.com/grpc/grpc/archive/v$pkgver/$pkgbase-$pkgver.tar.gz"
-        "https://github.com/google/googletest/archive/$_gtestver/googletest-$_gtestver.tar.gz"
-        "https://github.com/protocolbuffers/protobuf/archive/v$_protover/protobuf-$_protover.tar.gz")
+        "https://github.com/google/googletest/archive/$_gtestver/googletest-$_gtestver.tar.gz")
 sha256sums=('0d631419e54ec5b29def798623ee3bf5520dac77abeab3284ef7027ec2363f91'
-            '31bf78bd91b96dd5e24fab3bb1d7f3f7453ccbaceec9afb86d6e4816a15ab109'
-            '9df0e9e8ebe39f4fbbb9cf7db3d811287fe3616b2f191eb2bf5eaa12539c881f')
+            '31bf78bd91b96dd5e24fab3bb1d7f3f7453ccbaceec9afb86d6e4816a15ab109')
 
 prepare() {
   cd "$srcdir/$pkgbase-$pkgver"
@@ -52,11 +49,6 @@
       -e '/^PROTOBUF_SUBMODULE_VERSION=/d' \
       tools/distrib/python/grpcio_tools/protoc_lib_deps.py
   ln -s ../../../.. tools/distrib/python/grpcio_tools/grpc_root
-
-  if ! pkgconf protobuf --exact-version=$_protover.0; then
-    echo "protobuf version mismatch"
-    exit 1
-  fi
 }
 
 build() {
@@ -78,7 +70,7 @@
     -DgRPC_BENCHMARK_PROVIDER:STRING='package' \
     -DgRPC_ABSL_PROVIDER:STRING='package' \
     -DgRPC_USE_PROTO_LITE=OFF \
-    -DgRPC_USE_SYSTEMD=ON \
+    -DgRPC_USE_SYSTEMD=OFF \
     -DgRPC_BUILD_GRPC_CPP_PLUGIN=ON \
     -DgRPC_BUILD_GRPC_CSHARP_PLUGIN=ON \
     -DgRPC_BUILD_GRPC_NODE_PLUGIN=ON \
@@ -109,7 +101,7 @@
   export GRPC_PYTHON_BUILD_SYSTEM_CARES=1
   export GRPC_PYTHON_BUILD_SYSTEM_RE2=1
   export GRPC_PYTHON_BUILD_SYSTEM_ABSL=1
-  export GRPC_PYTHON_BUILD_WITH_SYSTEMD=1
+  export GRPC_PYTHON_BUILD_WITH_SYSTEMD=0
   export GRPC_BUILD_WITH_BORING_SSL_ASM=0
 
   cd "$srcdir/$pkgbase-$pkgver"
@@ -117,7 +109,7 @@
   python -m build --wheel --no-isolation
 
   cd tools/distrib/python/grpcio_tools
-  GRPC_PYTHON_CFLAGS="-fno-wrapv -frtti $(pkg-config --cflags protobuf) -I$srcdir/protobuf-$_protover/src" \
+  GRPC_PYTHON_CFLAGS="-fno-wrapv -frtti $(pkg-config --cflags protobuf)" \
   GRPC_PYTHON_LDFLAGS="$(pkg-config --libs protobuf) -lprotoc" \
   python -m build --wheel --no-isolation
 }
@@ -129,7 +121,7 @@
 }
 
 package_grpc() {
-  depends=('glibc' 'gcc-libs' 'zlib' 'systemd-libs' 'c-ares' 'protobuf' 'openssl' 're2' 'abseil-cpp')
+  depends=('glibc' 'gcc-libs' 'zlib' 'c-ares' 'protobuf' 'openssl' 're2' 'abseil-cpp')
   provides=(
     'libupb.so'
     'libgrpcpp_channelz.so'


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -21,5 +21,4 @@
 python-wheel
 re2
 re2c
-systemd-libs
 zlib