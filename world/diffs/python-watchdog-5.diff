--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,38 +1,35 @@
 
 pkgname=python-watchdog
-pkgver=6.0.0
-pkgrel=1
+pkgver=3.0.0
+pkgrel=2
 pkgdesc="Python API and shell utilities to monitor file system events"
 arch=('any')
 url="https://github.com/gorakhargosh/watchdog"
-license=('Apache-2.0')
+license=('Apache')
 depends=('python')
-makedepends=(
-  'python-build'
-  'python-installer'
-  'python-setuptools'
-  'python-wheel'
-)
-checkdepends=(
-  'python-pytest'
-  'python-pytest-timeout'
-)
 optdepends=('python-yaml: for watchmedo')
-source=("https://github.com/gorakhargosh/watchdog/archive/v$pkgver/$pkgname-$pkgver.tar.gz")
-sha512sums=('4a13e1f5b27d1f2d063018ced423709d58ca2a6a77a8d34f59a0bd29b1e34368d38ad0c3b1aa3fbdbf358f72f25da9ba0bbce6d7e23418cb4864cbf1cd4df8bd')
+makedepends=('python-setuptools')
+checkdepends=('python-pytest' 'python-pytest-timeout')
+source=($pkgname-$pkgver.tar.gz::https://github.com/gorakhargosh/watchdog/archive/v$pkgver.tar.gz)
+sha512sums=('de4811f45a63b2e8c36c0daaf43c59844481e84b70a7732893a4340d2d7ed15249f993bd7b1c96b22d4b8f6ed3868fdf36df4cc4fcdcb24653d34ee6efec76ae')
+
+prepare() {
+  cd watchdog-$pkgver
+  sed -i '/--cov/d' setup.cfg
+}
 
 build() {
-  cd ${pkgname#python-}-$pkgver
-  python -m build --wheel --no-isolation
+  cd watchdog-$pkgver
+  python setup.py build
 }
 
 check() {
-  cd ${pkgname#python-}-$pkgver
-  pytest --override-ini="addopts=" \
-    --deselect tests/test_inotify_c.py::test_select_fd
+  cd watchdog-$pkgver
+  PYTHONPATH="$PWD/build/lib" pytest --deselect tests/test_inotify_buffer.py::test_unmount_watched_directory_filesystem
 }
 
 package() {
-  cd ${pkgname#python-}-$pkgver
-  python -m installer --destdir="$pkgdir" dist/*.whl
+  cd watchdog-$pkgver
+  python setup.py install --root="$pkgdir" --optimize=1
 }
+


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,5 +1,2 @@
 python
-python-build
-python-installer
 python-setuptools
-python-wheel

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,4 +1,8 @@
+prepare() {
+cd watchdog-$pkgver
+sed -i '/--cov/d' setup.cfg
+}
 build() {
-cd ${pkgname#python-}-$pkgver
-python -m build --wheel --no-isolation
+cd watchdog-$pkgver
+python setup.py build
 }
