--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,31 +1,48 @@
 
 pkgname=dpkg
-pkgver=1.22.6
+pkgver=1.22.11
 pkgrel=1
 pkgdesc='The Debian Package Manager tools'
 arch=('x86_64')
 url="https://tracker.debian.org/pkg/dpkg"
-license=('GPL')
-options=('emptydirs')
-depends=('xz' 'zlib' 'bzip2' 'zstd' 'perl' 'libmd')
-makedepends=('perl-io-string' 'perl-timedate' 'git')
-checkdepends=('perl-io-string' 'perl-test-pod')
+license=('GPL-2.0-or-later')
+depends=(
+    'bzip2'
+    'gcc-libs'
+    'glibc'
+    'libmd'
+    'perl'
+    'xz'
+    'zlib'
+    'zstd'
+)
+makedepends=(
+    'git'
+    'perl-io-string'
+    'perl-timedate'
+)
+checkdepends=(
+    'perl-io-string'
+    'perl-test-pod'
+)
+options=('!emptydirs')
 install=dpkg.install
-source=(https://salsa.debian.org/dpkg-team/dpkg/-/archive/$pkgver/dpkg-$pkgver.tar.bz2
+source=("git+https://git.dpkg.org/git/dpkg/dpkg.git?signed#tag=$pkgver"
         origin.archlinux)
-sha256sums=('5c71552e833d4aa0f8b043f2c874eb2d3fed8256d6f7e7dba31dc0e09c1a22c5'
+sha256sums=('f1afa9c0831072af60be3ae60d42befda9d991eecc6538f80369e36abd00ca63'
             '9cfd50f65f1fb52adccf48ea859871259a549f24620b52466c890931919b7e04')
+validpgpkeys=('4F3E74F436050C10F5696574B972BF3EA4AE57A3') # Guillem Jover <guillem@hadrons.org>
 
 prepare() {
-    cd dpkg-$pkgver
-    echo "$pkgver" > .dist-version
+    cd $pkgname
     ./autogen
 }
 
 build() {
-    cd dpkg-$pkgver
+    cd $pkgname
     CFLAGS+=' -ffat-lto-objects' \
-    ./configure --prefix=/usr \
+    ./configure \
+        --prefix=/usr \
         --sysconfdir=/etc \
         --localstatedir=/var \
         --sbindir=/usr/bin \
@@ -35,15 +52,15 @@
 }
 
 check() {
-    cd dpkg-$pkgver
+    cd $pkgname
+    make check
 }
 
 package() {
-    cd dpkg-$pkgver
+    cd $pkgname
     make DESTDIR="$pkgdir" install
-    install -Dm644 ../origin.archlinux "$pkgdir"/etc/dpkg/origins/archlinux
-    ln -sf archlinux "$pkgdir"/etc/dpkg/origins/default
-
-    install -d "$pkgdir/var/dpkg"/updates/
-    touch "$pkgdir/var/lib/dpkg"/{status,available}
+    install -vDm644 /dev/null "$pkgdir/var/lib/dpkg/status"
+    install -vDm644 /dev/null "$pkgdir/var/lib/dpkg/available"
+    install -vDm644 "$srcdir/origin.archlinux" "$pkgdir/etc/dpkg/origins/archlinux"
+    ln -vsf archlinux "$pkgdir/etc/dpkg/origins/default"
 }


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,5 +1,7 @@
 bzip2
+gcc-libs
 git
+glibc
 libmd
 perl
 perl-io-string

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,12 +1,12 @@
 prepare() {
-cd dpkg-$pkgver
-echo "$pkgver" > .dist-version
+cd $pkgname
 ./autogen
 }
 build() {
-cd dpkg-$pkgver
+cd $pkgname
 CFLAGS+=' -ffat-lto-objects' \
-./configure --prefix=/usr \
+./configure \
+--prefix=/usr \
 --sysconfdir=/etc \
 --localstatedir=/var \
 --sbindir=/usr/bin \
