--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,29 +1,35 @@
 
 pkgname=python-vcrpy
-pkgver=4.2.1
-pkgrel=3
+_name="${pkgname#python-}"
+pkgver=6.0.1
+pkgrel=1
 pkgdesc='Automatically mock your HTTP interactions to simplify and speed up testing'
 arch=('any')
 license=('MIT')
 url='https://github.com/kevin1024/vcrpy'
-depends=('python-yaml' 'python-wrapt' 'python-six' 'python-yarl')
-makedepends=('python-setuptools')
-checkdepends=('python-pytest-httpbin')
-source=("https://github.com/kevin1024/vcrpy/archive/v$pkgver/$pkgname-$pkgver.tar.gz")
-sha512sums=('59231e5164cda3099b18d099f0ef97e062e6401e52e5dfc4022aa89ca02881e9e6e3c782f12c288f5281b3b3bf175dc33a267bc6d2b40791582a1221f5d7aaab')
+depends=('python' 'python-pyyaml' 'python-wrapt' 'python-yarl')
+makedepends=('python-build' 'python-installer' 'python-setuptools' 'python-wheel')
+checkdepends=('python-aiohttp' 'python-boto3' 'python-httpx' 'python-pytest' 'python-pytest-aiohttp' 'python-pytest-asyncio' 'python-pytest-httpbin' 'python-requests' 'python-tornado')
+source=("$url/archive/v$pkgver/$pkgname-$pkgver.tar.gz")
+sha512sums=('79ba9ea29db20ddc3db5676d7bdb05da17848eb126ed63d813a1d2b0de80573fff3afaec2ffe1af491a0310ce922c7545c4569035d0f5868f171db25965c217f')
 
 build() {
-  cd vcrpy-$pkgver
-  python setup.py build
+  cd $_name-$pkgver
+  python -m build --wheel --no-isolation
 }
 
 check() {
-  cd vcrpy-$pkgver
-  python -m pytest
+  local pytest_options=(
+    -vv
+    --ignore tests/integration
+  )
+
+  cd $_name-$pkgver
+  PYTHONPATH=".:$PYTHONPATH" pytest "${pytest_options[@]}" tests
 }
 
 package() {
-  cd vcrpy-$pkgver
-  python setup.py install --root="$pkgdir" --optimize=1
+  cd $_name-$pkgver
+  python -m installer --destdir="$pkgdir" dist/*.whl
   install -D -m644 LICENSE.txt "$pkgdir"/usr/share/licenses/$pkgname/LICENSE.txt
 }


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,5 +1,8 @@
+python
+python-build
+python-installer
+python-pyyaml
 python-setuptools
-python-six
+python-wheel
 python-wrapt
-python-yaml
 python-yarl

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,4 +1,4 @@
 build() {
-cd vcrpy-$pkgver
-python setup.py build
+cd $_name-$pkgver
+python -m build --wheel --no-isolation
 }
