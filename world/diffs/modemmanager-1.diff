--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -6,7 +6,7 @@
   modemmanager-docs
 )
 pkgver=1.24.0
-pkgrel=2
+pkgrel=1
 pkgdesc="Mobile broadband modem management service"
 url="https://www.freedesktop.org/wiki/Software/ModemManager/"
 arch=(x86_64)
@@ -27,7 +27,7 @@
   mobile-broadband-provider-info
   polkit
   ppp
-  systemd-libs
+  libelogind
 )
 makedepends=(
   bash-completion
@@ -36,7 +36,7 @@
   gobject-introspection
   gtk-doc
   meson
-  systemd
+  elogind
   vala
 )
 checkdepends=(
@@ -45,8 +45,10 @@
 )
 source=(
   "git+https://gitlab.freedesktop.org/mobile-broadband/ModemManager.git?signed#tag=${pkgver/[a-z]/-&}"
+  0001-Fix-gtk-doc-build.patch
 )
-b2sums=('71728bbd6abda4b88c24b7ba727f809fbe84db556ceab914bd1e3982e009ea5992da4214a8efc6ac76b6ebd9f6727f3da287d4c8206e37d97b405ea74e970963')
+b2sums=('71728bbd6abda4b88c24b7ba727f809fbe84db556ceab914bd1e3982e009ea5992da4214a8efc6ac76b6ebd9f6727f3da287d4c8206e37d97b405ea74e970963'
+        '71dbf56ddd8a7786514b082ff4f5a652e4b9bd8c45f63a2580f23f4d5acece22f406cf43892b82f62ca8d3916c435bec7c493a62fcaf40414971f090c3088d79')
 validpgpkeys=(
   A814D09B9C5BC01945A64308AECE0239C6606AD5 # Aleksander Morgado <aleksandermj@chromium.org>
   3A948E16E8860C68CD68441D734614319E26A433 # Dan Williams <dan@ioncontrol.co>
@@ -54,10 +56,7 @@
 
 prepare() {
   cd ModemManager
-
-  git cherry-pick -n 1ec2b86239c3686e22034baae0068bd5d52779ae
-
-  git cherry-pick -n 018e44084825ab294ad2b5d5b301d2b9e2577eb1
+  git apply -3 ../0001-Fix-gtk-doc-build.patch
 }
 
 build() {
@@ -65,11 +64,13 @@
     -D dbus_policy_dir=/usr/share/dbus-1/system.d
     -D dist_version="\"$pkgver-$pkgrel\""
     -D gtk_doc=true
+    -D systemd_journal=false
+    -D systemdsystemunitdir=no
     -D polkit=permissive
     -D vapi=true
   )
 
-  arch-meson ModemManager build "${meson_options[@]}"
+  artix-meson ModemManager build "${meson_options[@]}"
   meson compile -C build
 }
 
@@ -91,7 +92,7 @@
     libg{lib,object,io,module}-2.0.so
     libmbim-glib.so
     libqmi-glib.so
-    libsystemd.so
+    libelogind.so
   )
   optdepends=(
     'usb_modeswitch: install if your modem shows up as a storage drive'


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,6 +1,7 @@
 
 bash
 bash-completion
+elogind
 gcc-libs
 git
 glib2
@@ -9,6 +10,8 @@
 gobject-introspection
 gtk-doc
 hicolor-icon-theme
+libelogind
+libelogind.so
 libgio-2.0.so
 libglib-2.0.so
 libgmodule-2.0.so
@@ -22,11 +25,8 @@
 libqmi
 libqmi-glib.so
 libqrtr-glib
-libsystemd.so
 meson
 mobile-broadband-provider-info
 polkit
 ppp
-systemd
-systemd-libs
 vala