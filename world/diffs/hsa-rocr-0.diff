--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,7 +1,7 @@
 
 pkgname=hsa-rocr
-pkgver=7.2.0
-pkgrel=1
+pkgver=7.1.1
+pkgrel=2
 pkgdesc='HSA Runtime API and runtime for ROCm'
 arch=('x86_64')
 url='https://github.com/ROCm/rocm-systems'
@@ -11,10 +11,17 @@
 provides=("hsakmt-roct=$pkgver")
 replaces=('hsakmt-roct')
 makedepends=('cmake' 'rocm-llvm' 'xxd')
-source=("rocm-${pkgver}.tar.gz::$url/archive/rocm-$pkgver.tar.gz")
-sha256sums=('728ea7e9bf16e6ed217a0fd1a8c9afaba2dae2e7908fa4e27201e67c803c5638')
+source=("rocm-${pkgver}.tar.gz::$url/archive/rocm-$pkgver.tar.gz"
+        "hsa-rocr-7.1.1-fix-vgpr-count.patch")
+sha256sums=('3abbc89eb9c23d4ca51a4fc15db08acf0dfca48255f72bcb2cde94e99b4dc22a'
+            '3b850e5497982fd4787e240e0a8f8af8da0677a93495f091a1c643af8c2857c6')
 _dirname="$(basename "$url")-rocm-$pkgver"/projects/rocr-runtime/
 options=(!lto)
+
+prepare() {
+    cd "rocm-systems-rocm-$pkgver"
+    patch -Np1 -i ../hsa-rocr-7.1.1-fix-vgpr-count.patch
+}
 
 build() {
   local cmake_args=(


############# Stripped diff below #################



--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,3 +1,7 @@
+prepare() {
+cd "rocm-systems-rocm-$pkgver"
+patch -Np1 -i ../hsa-rocr-7.1.1-fix-vgpr-count.patch
+}
 build() {
 local cmake_args=(
 -Wno-dev
