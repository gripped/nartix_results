--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -14,8 +14,8 @@
   'usbip'
   'x86_energy_perf_policy'
 )
-pkgver=6.19
-pkgrel=2
+pkgver=6.18
+pkgrel=3
 license=('GPL-2.0-only')
 arch=('x86_64')
 url='https://www.kernel.org'
@@ -33,18 +33,12 @@
 makedepends+=('libnl')
 groups=("$pkgbase")
 source=("git+https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git#tag=v${pkgver//_/-}?signed"
-        'usbipd.service'
-        'hv_kvp_daemon.service'
-        'hv_vss_daemon.service'
 )
 validpgpkeys=(
   'ABAF11C65A2970B130ABE3C479BE3E4300411886'  # Linus Torvalds
   '647F28654894E3BD457199BE38DBBDC86092693E'  # Greg Kroah-Hartman
 )
-sha256sums=('05c6e18573ffacca5c3ff0105090a0bb063a2927d280c5ae0372c9667a60f871'
-            '2e187734d8aec58a3046d79883510d779aa93fb3ab20bd3132c1a607ebe5498f'
-            'b1315cb77a35454e1af9172f821a52e2a0cb18561be05a340d21cf337b01ae61'
-            '2d5e2f8d40b6f19bf2e1dead57ca105d72098fb0b418c09ff2e0cb91089710af')
+sha256sums=('24f57ef27799392461ce0e1d595f96412af7ade4bfd41625e563fd797743d06a')
 
 prepare() {
   cd linux
@@ -64,8 +58,6 @@
 }
 
 build() {
-  export CFLAGS="${CFLAGS} -Wno-error=discarded-qualifiers"
-
   echo ':: perf'
   pushd linux/tools/perf
   make -f Makefile.perf \
@@ -169,7 +161,7 @@
     prefix=/usr \
     lib=lib/perf \
     perfexecdir=lib/perf \
-    EXTRA_CFLAGS=' -Wno-error=bad-function-cast -Wno-error=declaration-after-statement -Wno-error=switch-enum -Wno-error=discarded-qualifiers' \
+    EXTRA_CFLAGS=' -Wno-error=bad-function-cast -Wno-error=declaration-after-statement -Wno-error=switch-enum' \
     NO_SDT=1 \
     BUILD_BPF_SKEL=1 \
     PYTHON=python \
@@ -200,7 +192,6 @@
     confdir='/etc/default/' \
     sbindir='/usr/bin' \
     libdir='/usr/lib' \
-    libexecdir='/usr/lib/systemd/scripts' \
     mandir='/usr/share/man' \
     docdir='/usr/share/doc/cpupower' \
     install install-man
@@ -218,14 +209,13 @@
 
 package_usbip() {
   pkgdesc='An USB device sharing system over IP network'
-  depends=('glibc' 'glib2' 'sysfsutils' 'systemd-libs')
+  depends=('glibc' 'glib2' 'sysfsutils' 'libudev')
 
   pushd linux/tools/usb/usbip
   make install DESTDIR="$pkgdir"
   popd
   install -Dm 644 /dev/null "$pkgdir/usr/lib/modules-load.d/$pkgname.conf"
   printf 'usbip-core\nusbip-host\n' > "$pkgdir/usr/lib/modules-load.d/$pkgname.conf"
-  install -Dm 644 usbipd.service "$pkgdir/usr/lib/systemd/system/usbipd.service"
 }
 
 package_tmon() {
@@ -250,9 +240,6 @@
 
   cd linux/tools/hv
   make install DESTDIR="$pkgdir" sbindir=/usr/bin libexecdir=/usr/lib
-  for _p in hv_kvp_daemon hv_vss_daemon; do
-    install -Dm644 "$srcdir/$_p.service" "$pkgdir/usr/lib/systemd/system/$_p.service"
-  done
 }
 
 package_bpf() {


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -20,6 +20,7 @@
 libpfm
 libsframe.so
 libtraceevent
+libudev
 libunwind
 llvm
 llvm-libs
@@ -35,7 +36,6 @@
 readline
 slang
 sysfsutils
-systemd-libs
 tmon
 turbostat
 udev