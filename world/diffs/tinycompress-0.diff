--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,7 +1,7 @@
 
 pkgname=tinycompress
-pkgver=1.2.13
-pkgrel=1
+pkgver=1.2.11
+pkgrel=3
 pkgdesc="ALSA compressed device interface"
 url="https://github.com/alsa-project/tinycompress"
 arch=(x86_64)
@@ -14,15 +14,24 @@
 optdepends=("ffmpeg: fcplay utility")
 provides=(libtinycompress.so)
 options=(debug)
+_commit=e98e500873c9c4fdd752d1c85b6116da426a8a70  # tags/v1.2.11^0
 source=(
-  "git+$url#tag=v$pkgver"
+  "git+$url#commit=$_commit"
+  0001-Fix-build-with-FFmpeg-7.patch
 )
-b2sums=('a8317249749419196d820f3ee728519b6a8c1f0a49d2d3bec2c40d1be2ecbec68fd0decea14b60ea66aa40a2cdae326694759e2b4c1afb9bc85fa96b1ea80a94')
+b2sums=('e23df6e28228fc059613f182bf6d5c5edbd95932ccc6d36e7aefadaa7474f59a55dccb841d24c25453d416cbd31ffb3a1d651061b3441c21d813e7127fd451db'
+        '29ccd63a6c70397239ac7f9661c3b27256ae044b2de6458e55595886867300cd3c004bb9ba827a1304ba410dd3f5a869e8045755f7e9a04eebd34034bee2cd9a')
+
+pkgver() {
+  cd tinycompress
+  git describe --tags | sed 's/^v//;s/[^-]*-g/r&/;s/-/+/g'
+}
 
 prepare() {
   mkdir -p build
 
   cd tinycompress
+  git apply -3 ../0001-Fix-build-with-FFmpeg-7.patch
   ./autogen.sh
 }
 


############# Stripped diff below #################



--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,6 +1,7 @@
 prepare() {
 mkdir -p build
 cd tinycompress
+git apply -3 ../0001-Fix-build-with-FFmpeg-7.patch
 ./autogen.sh
 }
 build() {
