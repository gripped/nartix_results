--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,50 +1,34 @@
 
 pkgbase=librest
-pkgname=(
-  librest
-  librest-docs
-  librest-demos
-)
-pkgver=0.10.2
-pkgrel=1
+pkgname=(librest librest-docs librest-demos)
+pkgver=0.9.1
+pkgrel=3
 pkgdesc="Library for accessing RESTful web services"
 url="https://gitlab.gnome.org/GNOME/librest"
 arch=(x86_64)
-license=(LGPL-2.1-or-later)
-depends=(
-  gcc-libs
-  glib2
-  glibc
-  json-glib
-  libsoup3
-  libxml2
-)
-makedepends=(
-  gi-docgen
-  git
-  glib2-devel
-  gobject-introspection
-  gtk4
-  gtksourceview5
-  libadwaita
-  meson
-  vala
-)
-source=(
-  "git+https://gitlab.gnome.org/GNOME/librest.git#tag=$pkgver"
-)
-b2sums=('5efbae175b2559aaa7cbb402480b0374da5959da2018b27355132d7db408c34567e2d85c6c4c6377cfa25578999934c9724e2013b7e8f46616f4e14940a8bf6d')
+license=(LGPL)
+depends=(glib2 libxml2 libsoup3 json-glib)
+makedepends=(gobject-introspection git meson gi-docgen vala libadwaita
+             gtksourceview5 glib2-devel)
+_commit=aa9e968e381ede159414c6338da24d61ad0b5d8b  # tags/0.9.1^0
+source=("git+https://gitlab.gnome.org/GNOME/librest.git#commit=$_commit"
+        30.patch)
+b2sums=('SKIP'
+        'a5e54797a758b67c7f9aa6e90cd7b6435dfa1f7abc86b9b88c0c98e78724b15308ca8af4ccb138d1d01948e54ed9bf930ee37a7d253e6c979846f93f92fef2c2')
+
+pkgver() {
+  cd librest
+  git describe --tags | sed 's/[^-]*-g/r&/;s/-/+/g'
+}
 
 prepare() {
   cd librest
+
+  git apply -3 ../30.patch
 }
 
 build() {
-  local meson_options=(
-    -D vapi=true
-  )
-
-  arch-meson librest build "${meson_options[@]}"
+  artix-meson librest build -D vapi=true
   meson compile -C build
 }
 
@@ -63,12 +47,8 @@
 }
 
 package_librest() {
-  depends+=(
-    libg{lib,object,io}-2.0.so
-    libjson-glib-1.0.so
-    libsoup-3.0.so
-    libxml2.so
-  )
+  depends+=(libg{lib,object,io}-2.0.so libxml2.so libsoup-3.0.so
+            libjson-glib-1.0.so)
   provides+=(librest{,-extras}-1.0.so)
 
   meson install -C build --destdir "$pkgdir"
@@ -89,17 +69,7 @@
 
 package_librest-demos() {
   pkgdesc+=" (demo applications)"
-  depends=(
-    gcc-libs
-    glib2
-    glibc
-    gtk4
-    gtksourceview5
-    json-glib
-    libadwaita
-    librest
-    libsoup3
-  )
+  depends=(librest libadwaita gtksourceview5)
   mv demo/* "$pkgdir"
 }
 


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,12 +1,9 @@
 
-gcc-libs
 gi-docgen
 git
 glib2
 glib2-devel
-glibc
 gobject-introspection
-gtk4
 gtksourceview5
 json-glib
 libadwaita

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,10 +1,8 @@
 prepare() {
 cd librest
+git apply -3 ../30.patch
 }
 build() {
-local meson_options=(
--D vapi=true
-)
-arch-meson librest build "${meson_options[@]}"
+artix-meson librest build -D vapi=true
 meson compile -C build
 }
