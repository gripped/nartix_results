--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,8 +1,8 @@
 
 _name=ucc
 pkgname=openucc
-pkgver=1.3.0
-pkgrel=5
+pkgver=1.4.4
+pkgrel=1
 pkgdesc="Unified Collective Communication Library"
 arch=(x86_64)
 url="https://github.com/openucx/ucc"
@@ -34,10 +34,10 @@
 source=(
   "$pkgname-$pkgver.tar.gz::$url/archive/refs/tags/v$pkgver.tar.gz"
 )
-sha256sums=('b56379abe5f1c125bfa83be305d78d81a64aa271b7b5fff0ac17b86725ff3acf')
+b2sums=('4df2fd7cbdc908d89fd86ee818a7fa34cb3012338906bc7c186dd7779297de1a1d386775796935191049cf41f437d8aa1117e7c4628b41ce84a0b8459cb9a753')
 
 prepare() {
-  sed -i 's/--offload-arch=native//g' $_name-$pkgver/cuda_lt.sh
+  sed -i '1i\#include <cstdint>' $_name-$pkgver/test/gtest/common/gtest-all.cc
 }
 
 build() {
@@ -46,6 +46,7 @@
     --with-ucx=/usr
     --with-cuda=/opt/cuda
     --with-rocm=/opt/rocm
+    --with-rocm-arch=all-arch-no-native
     --enable-gtest
     CFLAGS="$CFLAGS"
     CXXFLAGS="$CXXFLAGS"
@@ -62,11 +63,13 @@
 }
 
 check() {
-  make gtest -C $_name-$pkgver GTEST_FILTER='-test_mc_rocm.*:test_*reduce*:test_bcast_*:test_barrier.*:test_team.*:test_mc.*:test_active_set_2.*:test_scatter*:test_*gather*:*test_alltoall*:test_context.global'
+  make gtest -C $_name-$pkgver GTEST_FILTER='-test_mc_rocm.*:test_*reduce*:test_bcast_*:test_barrier.*:test_team.*:test_mc.*:test_active_set_2.*:test_scatter*:test_*gather*:*test_alltoall*:test_context.global:test_asymmetric_memory.*:test_asymmetric_memory_v.*:test_active_set.*'
 }
 
 package() {
   make DESTDIR="$pkgdir" install -C $_name-$pkgver
 
-  install -vDm 644 $_name-$pkgver/LICENSE -t "$pkgdir/usr/share/licenses/$pkgname/"
+  install -vDm 644 $_name-$pkgver/LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname/
+
+  rm "$pkgdir"/usr/bin/gtest
 }


############# Stripped diff below #################



--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,5 +1,5 @@
 prepare() {
-sed -i 's/--offload-arch=native//g' $_name-$pkgver/cuda_lt.sh
+sed -i '1i\#include <cstdint>' $_name-$pkgver/test/gtest/common/gtest-all.cc
 }
 build() {
 local configure_options=(
@@ -7,6 +7,7 @@
 --with-ucx=/usr
 --with-cuda=/opt/cuda
 --with-rocm=/opt/rocm
+--with-rocm-arch=all-arch-no-native
 --enable-gtest
 CFLAGS="$CFLAGS"
 CXXFLAGS="$CXXFLAGS"
