--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -2,36 +2,24 @@
 pkgname=libappimage
 pkgver=1.0.4.5
 _pkgver=1.0.4-5
-pkgrel=6
+pkgrel=5
 pkgdesc='Reference implementation of the AppImage specification'
 arch=(x86_64)
 url='https://appimage.org/'
-license=(MIT)
-depends=(boost-libs
-         cairo
-         gcc-libs
-         glib2
-         glibc
-         libarchive
-         librsvg
-         squashfuse)
-makedepends=(boost
-             cmake
-             desktop-file-utils
-             git
-             vim
-             wget
-             xdg-utils-cxx)
-source=(git+https://github.com/AppImage/libappimage#tag=v$_pkgver)
-sha256sums=('764b20065271769bb66fe1b5409fdfad18e6f8c9ecf8b9b8e5ca400d61327eb9')
+license=(GPL)
+depends=(libarchive squashfuse boost-libs librsvg)
+makedepends=(cmake wget vim desktop-file-utils boost xdg-utils-cxx)
+source=(https://github.com/AppImage/libappimage/archive/v$_pkgver/$pkgname-$_pkgver.tar.gz
+        https://github.com/AppImageCommunity/libappimage/commit/1e0515b2.patch)
+sha256sums=('2c4e18860a790c5959da6eb064cbd07f165fe6a9b15989491a3a3f176d06af31'
+            'd82b2519ba25a6a8a7743cc738a8c8e61cd49cfaca134741024a32f6cc5007ac')
 
 prepare() {
-  cd $pkgname
-  git cherry-pick -n 1e0515b2 # Fix build with GCC 13
+  patch -d $pkgname-$_pkgver -p1 < 1e0515b2.patch # Fix build with GCC 13
 }
 
 build() {
-  cmake -B build -S $pkgname \
+  cmake -B build -S $pkgname-$_pkgver \
     -DCMAKE_INSTALL_PREFIX=/usr \
     -DCMAKE_C_FLAGS="$CFLAGS -ffat-lto-objects" \
     -DUSE_SYSTEM_XZ=ON \
@@ -45,5 +33,4 @@
 
 package() {
   DESTDIR="$pkgdir" cmake --install build
-  install -Dm644 $pkgname/LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname
 }


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,12 +1,7 @@
 boost
 boost-libs
-cairo
 cmake
 desktop-file-utils
-gcc-libs
-git
-glib2
-glibc
 libarchive
 librsvg
 squashfuse

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,9 +1,8 @@
 prepare() {
-cd $pkgname
-git cherry-pick -n 1e0515b2 # Fix build with GCC 13
+patch -d $pkgname-$_pkgver -p1 < 1e0515b2.patch # Fix build with GCC 13
 }
 build() {
-cmake -B build -S $pkgname \
+cmake -B build -S $pkgname-$_pkgver \
 -DCMAKE_INSTALL_PREFIX=/usr \
 -DCMAKE_C_FLAGS="$CFLAGS -ffat-lto-objects" \
 -DUSE_SYSTEM_XZ=ON \
