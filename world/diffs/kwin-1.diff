--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,8 +1,8 @@
 
 pkgname=kwin
-pkgver=6.5.5
+pkgver=6.5.4
 _dirver=$(echo $pkgver | cut -d. -f1-3)
-pkgrel=1
+pkgrel=5
 pkgdesc='An easy to use, but flexible, Wayland compositor'
 arch=(x86_64)
 url='https://kde.org/plasma-desktop/'
@@ -61,7 +61,7 @@
          qt6-sensors
          qt6-svg
          qt6-tools
-         systemd-libs
+         libelogind
          wayland
          xcb-util-keysyms
          xcb-util-wm)
@@ -74,14 +74,20 @@
              xorg-xwayland)
 optdepends=('plasma-keyboard: virtual keyboard')
 groups=(plasma)
-source=(https://download.kde.org/stable/plasma/$_dirver/$pkgname-$pkgver.tar.xz{,.sig})
-sha256sums=('fbad845044231174ca7aad45572d1713d1b6f65289d94cac24776a103f051e46'
-            'SKIP')
+source=(https://download.kde.org/stable/plasma/$_dirver/$pkgname-$pkgver.tar.xz{,.sig}
+        https://invent.kde.org/plasma/kwin/-/commit/ef450432.patch)
+sha256sums=('258443f72180cf5a8141b440bb51a714a2e67e30867736290793ce50d7bb1d70'
+            'SKIP'
+            '4e35db494b436d2d4dc35eb467a90d93db2279561be3fc2c3f4a74a64ffa6081')
 validpgpkeys=('E0A3EB202F8E57528E13E72FD7574483BB57B18D'  # Jonathan Esk-Riddell <jr@jriddell.org>
               '0AAC775BB6437A8D9AF7A3ACFE0784117FBCE11D'  # Bhushan Shah <bshah@kde.org>
               'D07BD8662C56CB291B316EB2F5675605C74E02CF'  # David Edmundson <davidedmundson@kde.org>
               '90A968ACA84537CC27B99EAF2C8DF587A6D4AAC1'  # Nicolas Fella <nicolas.fella@kde.org>
               '1FA881591C26B276D7A5518EEAAF29B42A678C20') # Marco Martin <notmart@gmail.com>
+
+prepare() {
+  patch -d $pkgname-$pkgver -p1 < ef450432.patch # Fix freezes
+}
 
 build() {
   cmake -B build  -S $pkgname-$pkgver \
@@ -93,4 +99,6 @@
 package() {
   DESTDIR="$pkgdir" cmake --install build
   setcap CAP_SYS_NICE=+ep "$pkgdir"/usr/bin/kwin_wayland
+
+  rm -r $pkgdir/usr/lib/systemd
 }


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -38,6 +38,7 @@
 libdisplay-info
 libdrm
 libei
+libelogind
 libepoxy
 libinput
 libpipewire
@@ -57,7 +58,6 @@
 qt6-sensors
 qt6-svg
 qt6-tools
-systemd-libs
 wayland
 wayland-protocols
 xcb-util-keysyms