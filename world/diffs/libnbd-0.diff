--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,10 +1,10 @@
 pkgname=libnbd
-pkgver=1.20.0
-pkgrel=1
+pkgver=1.18.2
+pkgrel=2
 pkgdesc="NBD client library in userspace"
 arch=('x86_64')
 url="https://gitlab.com/nbdkit/libnbd"
-license=('LGPL-2.1-or-later')
+license=('LGPL')
 depends=('glibc' 'gnutls' 'libxml2')
 makedepends=('perl' 'ocamlbuild' 'ocaml-findlib' 'rust' 'fuse3' 'python' 'go')
 optdepends=(
@@ -12,32 +12,30 @@
   'ocaml: For OCaml bindings'
   'python>=3: For Python bindings'
 )
+validpgpkeys=('F7774FB1AD074A7E8C8767EA91738F73E1B768A0')
+_dldir="${pkgver%.*}"
 source=(
-  "https://download.libguestfs.org/libnbd/${pkgver%.*}-stable/libnbd-${pkgver}.tar.gz"{,.sig}
+	"http://download.libguestfs.org/libnbd/${_dldir}-stable/libnbd-${pkgver}.tar.gz"
+    "http://download.libguestfs.org/libnbd/${_dldir}-stable/libnbd-${pkgver}.tar.gz.sig"
 )
-sha256sums=('21680ad26b1cccfeb47257c2eae8bfeaea7dfc11fdea723cce02f1a8e769353a'
+sha256sums=('398b4d1c020683026e6a9a0934431592ead42bd6d0eca3be576db76c60b44c52'
             'SKIP')
-validpgpkeys=('F7774FB1AD074A7E8C8767EA91738F73E1B768A0')  # Richard W.M. Jones <rjones@redhat.com>
-
-prepare() {
-  cd "${pkgname}-${pkgver}"
-  autoreconf -fiv
-}
 
 build() {
-  cd "${pkgname}-${pkgver}"
+  cd "${srcdir}/${pkgname}-${pkgver}"
   export CFLAGS+=" -ffat-lto-objects"
+  autoreconf -i
   ./configure --prefix=/usr --sbindir=/usr/bin
   make
 }
 
-check() {
-  cd "${pkgname}-${pkgver}"
-  make check
-}
-
 package() {
-  cd "${pkgname}-${pkgver}"
+  cd "${srcdir}/${pkgname}-${pkgver}"
   make DESTDIR="$pkgdir" install
   rm -rf "$pkgdir"/usr/src
 }
+
+check() {
+  cd "${srcdir}/${pkgname}-${pkgver}"
+  make check
+}


############# Stripped diff below #################



--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,10 +1,7 @@
-prepare() {
-cd "${pkgname}-${pkgver}"
-autoreconf -fiv
-}
 build() {
-cd "${pkgname}-${pkgver}"
+cd "${srcdir}/${pkgname}-${pkgver}"
 export CFLAGS+=" -ffat-lto-objects"
+autoreconf -i
 ./configure --prefix=/usr --sbindir=/usr/bin
 make
 }
