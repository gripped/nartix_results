--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -2,8 +2,8 @@
 _name=cheroot
 pkgname=python-cheroot
 pkgdesc="Highly-optimized, pure-python HTTP server"
-pkgver=10.0.1
-pkgrel=3
+pkgver=10.0.0
+pkgrel=2
 arch=(any)
 url="https://github.com/cherrypy/cheroot"
 license=(BSD-3-Clause)
@@ -11,6 +11,9 @@
   python
   python-jaraco.functools
   python-more-itertools
+)
+optdepends=(
+  'python-pyopenssl: for SSL and certificate handling within cheroot'
 )
 makedepends=(
   python-build
@@ -20,6 +23,7 @@
   python-wheel
 )
 checkdepends=(
+  python-apipkg
   python-chardet
   python-colorama
   python-jaraco.context
@@ -37,34 +41,37 @@
   python-urllib3
   python-watchdog
 )
-optdepends=('python-pyopenssl: for SSL and certificate handling within cheroot')
-source=("$pkgname-$pkgver.tar.gz::$url/archive/refs/tags/v$pkgver.tar.gz")
-sha512sums=('de771a64176ff07d8c70c8ec7de071cad10829bd71a3477c0d936dffa0cbd5c1cd2076eb25fb57331865e170180c3e9ff7d759bda2ed3ba718426dc68fddb34a')
-b2sums=('7e9da269b7df67a68dd814d76eb0ef75266a7839cbbcbe2f36cc1ff1e4141c79d1eb88e528149fcea827867841d565c740a1ca3e712da5d6e05b56bb90c9c185')
+source=($pkgname-$pkgver.tar.gz::$url/archive/refs/tags/v$pkgver.tar.gz)
+sha512sums=('bfeebded828607441d91e4d6c2704df90387aa516744b59642d7daf5dc7e3b5f960066d9437aee61800e269046f14d72ee0c6078c1a84ec32c58323d3ad08156')
+b2sums=('cc3bf89af3b59ec16f9cf276baf565f5c3637f42c70a01f35d70c0541fdc809dfeccd2c0d7cd3de576162442b3013b869b2fca09195dc9734fae7e6a2affdf9b')
+
+prepare() {
+  cd $_name-$pkgver
+  sed -e '/setuptools_scm_git_archive/d' -i pyproject.toml setup.cfg requirements/*
+}
 
 build() {
+  export SETUPTOOLS_SCM_PRETEND_VERSION="$pkgver"
+
   cd $_name-$pkgver
-  export SETUPTOOLS_SCM_PRETEND_VERSION="$pkgver"
   python -m build --wheel --no-isolation
 }
 
 check() {
-  cd $_name-$pkgver
   local pytest_options=(
     -vv
-    --override-ini="addopts="
-    --ignore cheroot/test/test_server.py
-    --deselect cheroot/test/test_conn.py::test_broken_connection_during_http_communication_fallback
-    --deselect cheroot/test/test_conn.py::test_kb_int_from_http_handler
-    --deselect cheroot/test/test_conn.py::test_remains_alive_post_unhandled_exception
-    --deselect cheroot/test/test_conn.py::test_unhandled_exception_in_request_handler
+    -o addopts=''
+    --ignore cheroot/test/test_server.py  # requires python-pypytools
     --deselect cheroot/test/test_ssl.py::test_https_over_http_error
   )
+
+  cd $_name-$pkgver
   pytest "${pytest_options[@]}"
 }
 
 package() {
   cd $_name-$pkgver
   python -m installer --destdir="$pkgdir" dist/*.whl
-  install -vDm644 -t "$pkgdir/usr/share/licenses/$pkgname" LICENSE.md
+  install -vDm 644 LICENSE.md -t "$pkgdir/usr/share/licenses/$pkgname/"
 }
+


############# Stripped diff below #################



--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,5 +1,9 @@
+prepare() {
+cd $_name-$pkgver
+sed -e '/setuptools_scm_git_archive/d' -i pyproject.toml setup.cfg requirements/*
+}
 build() {
+export SETUPTOOLS_SCM_PRETEND_VERSION="$pkgver"
 cd $_name-$pkgver
-export SETUPTOOLS_SCM_PRETEND_VERSION="$pkgver"
 python -m build --wheel --no-isolation
 }
