--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,19 +1,7 @@
 
-pkgbase=syslog-ng
-pkgname=(
-  syslog-ng
-  syslog-ng-python
-  syslog-ng-amqp
-  syslog-ng-geoip2
-  syslog-ng-kafka
-  syslog-ng-mongodb
-  syslog-ng-redis
-  syslog-ng-smtp
-  syslog-ng-snmp
-  syslog-ng-sql
-)
-pkgver=4.10.2
-pkgrel=2
+pkgname=syslog-ng
+pkgver=4.10.1
+pkgrel=1
 pkgdesc="Next-generation syslogd with advanced networking and filtering capabilities"
 arch=(x86_64)
 url="https://github.com/syslog-ng/syslog-ng"
@@ -21,33 +9,35 @@
   GPL-2.0-or-later
   LGPL-2.1-or-later
 )
-makedepends=(
+depends=(
   abseil-cpp
-  autoconf-archive
   bash
   curl
-  docbook-xsl
   gawk
   gcc-libs
-  git
   glib2
   glibc
   grpc
-  hiredis
   json-c
   libcap
+  libnet
+  openssl
+  pcre2
+  protobuf
+)
+makedepends=(
+  autoconf-archive
+  docbook-xsl
+  git
+  hiredis
   libdbi
   libesmtp
   libmaxminddb
-  libnet
   librabbitmq-c
   librdkafka
   libxslt
   mongo-c-driver
   net-snmp
-  openssl
-  pcre2
-  protobuf
   python
   python-boto3
   python-botocore
@@ -67,11 +57,9 @@
   python-requests-oauthlib
   python-rsa
   python-setuptools
+  python-six
   python-urllib3
   python-websocket-client
-  systemd
-  systemd-libs
-  zlib
 )
 checkdepends=(
   criterion
@@ -79,36 +67,58 @@
   python-pytest
   python-pytest-mock
 )
+optdepends=(
+  'hiredis: for the Redis plugin'
+  'libdbi: for the SQL plugin'
+  'libesmtp: for the SMTP plugin'
+  'libmaxminddb: for the GeoIP2 plugin'
+  'librabbitmq-c: for the AMQP plugin'
+  'librdkafka: for the Kafka C plugin'
+  'logrotate: for rotating log files'
+  'mongo-c-driver: for the MongoDB plugin'
+  'net-snmp: for the SNMP plugin'
+  'python-boto3: for Python S3 module'
+  'python-botocore: for Python S3 module'
+  'python-kubernetes: for Python Kubernetes module'
+  'python-ply: for debugger CLI'
+  'python-requests: for Python hypr module'
+  'python: for Python-based plugins'
+)
+conflicts=(eventlog)
+replaces=(eventlog)
+backup=(
+  "etc/$pkgname/$pkgname.conf"
+  "etc/logrotate.d/$pkgname"
+  "etc/default/$pkgname@default"
+)
+install=$pkgname.install
 source=(
-  "git+$url.git#tag=$pkgbase-$pkgver"
+  "git+$url.git#tag=$pkgname-$pkgver"
   "git+https://github.com/balabit/ivykis.git"
   "git+https://github.com/open-telemetry/opentelemetry-proto.git"
   "git+https://github.com/Thalhammer/jwt-cpp.git"
-  "$pkgbase.logrotate"
-  "$pkgbase-systemd-integration.patch"
-  "$pkgbase-do-not-install-python-venv.patch"
-  "$pkgbase-config.patch"
+  "$pkgname.logrotate"
+  "$pkgname-do-not-install-python-venv.patch"
+  "$pkgname-config.patch"
 )
-sha256sums=('8542b1347942602bbf7a084ff82a08779fcbb9d0116636f0fb77b4c53a4687b4'
+sha256sums=('79906a4bacc30369172bea3297cee3dd180b1cbedb2b0879a32d9a590e9fba79'
             'SKIP'
             'SKIP'
             'SKIP'
             '93c935eca56854011ea9e353b7a1da662ad40b2e8452954c5b4b5a1d5b2d5317'
-            '12e7d38ca2b79aae9417207a7b3a777f8f7646cc23bddfd383a6a6e9b7014d6e'
             '7ca7f0d9fb203b3814fe2f609904af84df346b84591eeeb171bb2e5eb6393990'
             '1039550b091df1a50e8d30b624d52a7fd56c29d0ceec596b4b029a7cc92a3825')
 
 prepare() {
-  cd $pkgbase
+  cd $pkgname
   git submodule init
   git config submodule.lib/ivykis.url "$srcdir/ivykis"
   git config submodule.modules/grpc/protos/opentelemetry-proto.url "$srcdir/opentelemetry-protos"
   git config submodule.modules/cloud-auth/jwt-cpp.url "$srcdir/jwt-cpp"
   git -c protocol.file.allow=always submodule update
 
-  patch -Np1 < ../$pkgbase-systemd-integration.patch
-  patch -Np1 < ../$pkgbase-do-not-install-python-venv.patch
-  patch -Np1 < ../$pkgbase-config.patch
+  patch -Np1 < ../$pkgname-do-not-install-python-venv.patch
+  patch -Np1 < ../$pkgname-config.patch
 
   sed -i '/include lib\/secret-storage\/tests\/Makefile.am/d' lib/secret-storage/Makefile.am
   rm -r lib/secret-storage/tests
@@ -117,8 +127,10 @@
 }
 
 build() {
-  cd $pkgbase
+  cd $pkgname
   local configure_options=(
+    --disable-systemd
+    --with-systemdsystemunitdir=no
     --datadir=/usr/share
     --disable-java
     --disable-java-modules
@@ -128,16 +140,14 @@
     --enable-ipv6
     --enable-manpages
     --enable-spoof-source
-    --enable-systemd
     --libexecdir=/usr/lib
-    --localstatedir="/var/lib/$pkgbase"
+    --localstatedir="/var/lib/$pkgname"
     --prefix=/usr
     --sbindir=/usr/bin
-    --sysconfdir="/etc/$pkgbase"
+    --sysconfdir="/etc/$pkgname"
     --with-jsonc=system
     --with-pidfile-dir=/run
     --with-python-packages=system
-    --with-systemdsystemunitdir=/usr/lib/systemd/system
   )
   ./configure "${configure_options[@]}"
 
@@ -146,192 +156,13 @@
 }
 
 check() {
-  cd $pkgbase
+  cd $pkgname
   make check
 }
 
-_pick() {
-  local dest="$1"
-  shift
-  for obj in "$@"; do
-    mkdir -p "$dest/$(dirname "$obj")/"
-    mv -v -t "$dest/$(dirname "$obj")/" "$obj"
-  done
-}
-
-package_syslog-ng() {
-  depends=(
-    abseil-cpp
-    bash
-    curl
-    gawk
-    gcc-libs
-    glib2
-    glibc
-    grpc
-    json-c
-    libcap
-    libnet
-    openssl
-    pcre2
-    protobuf
-    systemd-libs
-    zlib
-  )
-  optdepends=('logrotate: for rotating log files')
-  conflicts=(eventlog)
-  replaces=(eventlog)
-  backup=(
-    "etc/$pkgname/$pkgname.conf"
-    "etc/logrotate.d/$pkgname"
-    "etc/default/$pkgname@default"
-  )
-  install=$pkgbase.install
-
-  cd $pkgbase
+package() {
+  cd $pkgname
   make DESTDIR="$pkgdir" install
-  install -vDm644 -t "$pkgdir/etc/default" "contrib/systemd/$pkgname@default"
   install -vdm755 "$pkgdir/var/lib/$pkgname"
   install -vDm644 "$srcdir/$pkgname.logrotate" "$pkgdir/etc/logrotate.d/$pkgname"
-
-  cd "$pkgdir"
-  _pick "$srcdir/syslog-ng-python" \
-    etc/syslog-ng/python \
-    usr/lib/syslog-ng/libmod-python.so \
-    usr/lib/syslog-ng/python \
-    usr/share/syslog-ng/include/scl/python
-
-  _pick "$srcdir/syslog-ng-amqp" usr/lib/syslog-ng/libafamqp.so
-  _pick "$srcdir/syslog-ng-geoip2" usr/lib/syslog-ng/libgeoip2-plugin.so
-  _pick "$srcdir/syslog-ng-kafka" usr/lib/syslog-ng/libkafka.so
-  _pick "$srcdir/syslog-ng-mongodb" usr/lib/syslog-ng/libafmongodb.so
-  _pick "$srcdir/syslog-ng-redis" usr/lib/syslog-ng/libredis.so
-  _pick "$srcdir/syslog-ng-smtp" usr/lib/syslog-ng/libafsmtp.so
-  _pick "$srcdir/syslog-ng-snmp" usr/lib/syslog-ng/libafsnmp.so
-  _pick "$srcdir/syslog-ng-sql" usr/lib/syslog-ng/libafsql.so
 }
-
-package_syslog-ng-python() {
-  pkgdesc+=" (Python modules)"
-  groups=(syslog-ng-modules)
-  depends=(
-    glib2
-    glibc
-    python
-    syslog-ng
-  )
-  optdepends=(
-    'python-boto3: for S3 module'
-    'python-botocore: for S3 module'
-    'python-kubernetes: for Kubernetes module'
-    'python-ply: for debugger CLI'
-    'python-requests: for hypr module'
-  )
-
-  cp -va -t "$pkgdir" "$pkgname/"*
-}
-
-package_syslog-ng-amqp() {
-  pkgdesc+=" (AMQP module)"
-  groups=(syslog-ng-modules)
-  depends=(
-    glib2
-    glibc
-    librabbitmq-c
-    syslog-ng
-  )
-
-  cp -va -t "$pkgdir" "$pkgname/"*
-}
-
-package_syslog-ng-geoip2() {
-  pkgdesc+=" (GeoIP2 module)"
-  groups=(syslog-ng-modules)
-  depends=(
-    glib2
-    glibc
-    libmaxminddb
-    syslog-ng
-  )
-
-  cp -va -t "$pkgdir" "$pkgname/"*
-}
-
-package_syslog-ng-kafka() {
-  pkgdesc+=" (Kafka module)"
-  groups=(syslog-ng-modules)
-  depends=(
-    glib2
-    glibc
-    librdkafka
-    syslog-ng
-  )
-
-  cp -va -t "$pkgdir" "$pkgname/"*
-}
-
-package_syslog-ng-mongodb() {
-  pkgdesc+=" (MongoDB module)"
-  groups=(syslog-ng-modules)
-  depends=(
-    glib2
-    glibc
-    mongo-c-driver
-    syslog-ng
-  )
-
-  cp -va -t "$pkgdir" "$pkgname/"*
-}
-
-package_syslog-ng-redis() {
-  pkgdesc+=" (Redis module)"
-  groups=(syslog-ng-modules)
-  depends=(
-    glib2
-    glibc
-    hiredis
-    syslog-ng
-  )
-
-  cp -va -t "$pkgdir" "$pkgname/"*
-}
-
-package_syslog-ng-smtp() {
-  pkgdesc+=" (SMTP module)"
-  groups=(syslog-ng-modules)
-  depends=(
-    glib2
-    glibc
-    libesmtp
-    syslog-ng
-  )
-
-  cp -va -t "$pkgdir" "$pkgname/"*
-}
-
-package_syslog-ng-snmp() {
-  pkgdesc+=" (SNMP module)"
-  groups=(syslog-ng-modules)
-  depends=(
-    glib2
-    glibc
-    net-snmp
-    syslog-ng
-  )
-
-  cp -va -t "$pkgdir" "$pkgname/"*
-}
-
-package_syslog-ng-sql() {
-  pkgdesc+=" (SQL module)"
-  groups=(syslog-ng-modules)
-  depends=(
-    glib2
-    glibc
-    libdbi
-    openssl
-    syslog-ng
-  )
-
-  cp -va -t "$pkgdir" "$pkgname/"*
-}


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -43,9 +43,6 @@
 python-requests-oauthlib
 python-rsa
 python-setuptools
+python-six
 python-urllib3
 python-websocket-client
-syslog-ng
-systemd
-systemd-libs
-zlib