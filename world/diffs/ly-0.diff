--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -2,73 +2,38 @@
 pkgname=ly
 pkgver=1.3.2
 pkgrel=1
-pkgdesc="TUI display manager"
+pkgdesc="Lightweight TUI (ncurses-like) display manager"
 arch=(x86_64)
-url="https://codeberg.org/fairyglade/ly"
+url="https://codeberg.org/AnErrupTion/ly"
 license=('WTFPL')
-depends=(pam glibc libxcb)
-makedepends=(git zig)
-install=ly.install
-optdepends=('xorg-xauth: for X server sessions'
+depends=(pam glibc)
+makedepends=(git libxcb zig)
+optdepends=('brightnessctl: for controling brightness'
+            'xorg-xmessage: for displaying a message or query in a window'
+            'xorg-xauth: for X server sessions'
             'libxcb: for X server sessions')
-backup=(
-    etc/$pkgname/{config.ini,setup.sh}
-    etc/pam.d/ly
-)
-_zig_deps=(
-    clap-0.11.0.tar.gz::https://github.com/Hejsil/zig-clap/archive/refs/tags/0.11.0.tar.gz
-    ini-0.1.0.tar.gz::https://github.com/AnErrupTion/ini/archive/918f16d0dcf893d0c1cdffe204faa08bb3584e04.tar.gz
-    zigini-0.3.3.tar.gz::https://github.com/AnErrupTion/zigini/archive/9281f47702b57779e831d7618e158abb8eb4d4a2.tar.gz
-    termbox2-496730697c662893eec43192f48ff616c2539da6.tar.gz::https://github.com/AnErrupTion/termbox2/archive/496730697c662893eec43192f48ff616c2539da6.tar.gz
-)
-source=("git+$url.git#tag=v${pkgver}"
-        "${_zig_deps[@]}")
-noextract=("${_zig_deps[@]}")
-b2sums=('2c28171c16b01776f7c63b45525e45bad7b13a79aa04a4023b54301c5069c153cf36a18a6ecd8b76b93ddf4ca5c74e8c65d56b29e4767ebf07df325fd61310a5'
-        '584cdd4e38d44c504f9a0af8d489900122b1b99e0b31b0608abf64ccb835167c002d067cdda12ffb5902636901425cc8e9e18947e98461a8abf5339759f13a7c'
-        '6d3e2f21247b3eeae1842d8d9d3b1ff0d663849da2237b1ba618e45961a61e1550d49015a0172e4726e177b96fd6a18dd0e83a7a0b37da7e5d92aff98b433486'
-        '0aa283c5ab270bfb80f84c602058eab8b81ba6d1c5094d09c94332fe07f0c275330a4a19f05f69b63e935ce5d1b954cc67c78bdf354af301f6e948074fb4ec2d'
-        'a54ec90b7b4e3ffad8d33177a230c7f3723341b715ec9891f049dd86c79eb7ff21d52a7a901b95f2bda814154f33a5a77d3f1753bfca8cde9ddee588e0905274')
+backup=(etc/$pkgname/{config.ini,setup.sh}
+        etc/pam.d/ly)
+source=("git+$url.git#tag=v${pkgver}")
+b2sums=('2c28171c16b01776f7c63b45525e45bad7b13a79aa04a4023b54301c5069c153cf36a18a6ecd8b76b93ddf4ca5c74e8c65d56b29e4767ebf07df325fd61310a5')
 
 prepare() {
-    for dep in "${_zig_deps[@]}"; do
-        zig fetch --global-cache-dir ./zig-global-cache "${dep%%::*}"
-    done
-
-    cd $pkgname
-    git cherry-pick -n \
-        ced8f9bee35ad97c1e59ef1e182e064c04eb76a7 \
-        c7e442be8b083dd3dba818806f143cb5dddd4c1f
+  cd "$pkgname"
+  sed -i '/try install_service(allocator, patch_map);/d' build.zig
+  sed -i 's|restart_cmd = /sbin/shutdown -r now|restart_cmd = /usr/bin/loginctl reboot|' res/config.ini
+  sed -i 's|shutdown_cmd = /sbin/shutdown $PLATFORM_SHUTDOWN_ARG now|shutdown_cmd = /usr/bin/loginctl poweroff|' res/config.ini
+  sed -i 's|sleep_cmd = null|sleep_cmd = /usr/bin/loginctl suspend|' res/config.ini
+  git cherry-pick -n ced8f9bee35ad97c1e59ef1e182e064c04eb76a7
 }
 
 build() {
-    cd "$pkgname"
-    zig build \
-      --search-prefix /usr \
-      -Ddest_directory="$pkgdir" \
-      -Dname="ly-dm" \
-      --global-cache-dir ../zig-global-cache \
-      --system ../zig-global-cache/p \
-      --build-id=sha1 \
-      -Dtarget=native-linux.6.6-gnu.2.40 \
-      -Dcpu=baseline \
-      -Doptimize=ReleaseSafe
+  cd "$pkgname"
+  zig build -Ddest_directory="$pkgdir" -Dname="ly-dm" -Dcpu=baseline -Doptimize=ReleaseSafe
 }
 
 package() {
-    cd "$pkgname"
+  cd "$pkgname"
+  zig build -Ddest_directory="$pkgdir" -Dname="ly-dm" -Dcpu=baseline -Doptimize=ReleaseSafe installexe
+  install -Dm644 license.md "$pkgdir/usr/share/licenses/$pkgname/WTFPL"
+}
 
-    zig build \
-      --search-prefix /usr \
-      -Ddest_directory="$pkgdir" \
-      -Dname="ly-dm" \
-      --global-cache-dir ../zig-global-cache \
-      --system ../zig-global-cache/p \
-      --build-id=sha1 \
-      -Dtarget=native-linux.6.6-gnu.2.40 \
-      -Dcpu=baseline \
-      -Doptimize=ReleaseSafe \
-      installexe
-
-    install -Dm644 license.md "$pkgdir/usr/share/licenses/$pkgname/WTFPL"
-}


############# Stripped diff below #################



--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,22 +1,12 @@
 prepare() {
-for dep in "${_zig_deps[@]}"; do
-zig fetch --global-cache-dir ./zig-global-cache "${dep%%::*}"
-done
-cd $pkgname
-git cherry-pick -n \
-ced8f9bee35ad97c1e59ef1e182e064c04eb76a7 \
-c7e442be8b083dd3dba818806f143cb5dddd4c1f
+cd "$pkgname"
+sed -i '/try install_service(allocator, patch_map);/d' build.zig
+sed -i 's|restart_cmd = /sbin/shutdown -r now|restart_cmd = /usr/bin/loginctl reboot|' res/config.ini
+sed -i 's|shutdown_cmd = /sbin/shutdown $PLATFORM_SHUTDOWN_ARG now|shutdown_cmd = /usr/bin/loginctl poweroff|' res/config.ini
+sed -i 's|sleep_cmd = null|sleep_cmd = /usr/bin/loginctl suspend|' res/config.ini
+git cherry-pick -n ced8f9bee35ad97c1e59ef1e182e064c04eb76a7
 }
 build() {
 cd "$pkgname"
-zig build \
---search-prefix /usr \
--Ddest_directory="$pkgdir" \
--Dname="ly-dm" \
---global-cache-dir ../zig-global-cache \
---system ../zig-global-cache/p \
---build-id=sha1 \
--Dtarget=native-linux.6.6-gnu.2.40 \
--Dcpu=baseline \
--Doptimize=ReleaseSafe
+zig build -Ddest_directory="$pkgdir" -Dname="ly-dm" -Dcpu=baseline -Doptimize=ReleaseSafe
 }
