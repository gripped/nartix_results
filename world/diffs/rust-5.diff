--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -8,8 +8,8 @@
   rust-src
 )
 epoch=1
-pkgver=1.78.0
-pkgrel=1
+pkgver=1.77.2
+pkgrel=2
 pkgdesc="Systems programming language focused on safety, speed and concurrency"
 url=https://www.rust-lang.org/
 arch=(x86_64)
@@ -19,21 +19,15 @@
   !lto
 )
 depends=(
-  bash
   curl
   gcc
   gcc-libs
-  glibc
   libssh2
   llvm-libs
-  openssl
-  zlib
 )
 makedepends=(
-  clang
   cmake
   lib32-gcc-libs
-  lib32-glibc
   libffi
   lld
   llvm
@@ -55,11 +49,11 @@
   0003-compiler-Change-LLVM-targets.patch
   0004-compiler-Use-wasm-ld-for-wasm-targets.patch
 )
-b2sums=('3f43a1c50e268afbe76755ae24bccb3db9ff4dd8bbb8130c75d486c4c0e40f0253c4d4cad1de1040600c090d03d93b08adee5b16fa8abcf36d47a3c14024719f'
+b2sums=('cf9fd96580d2c696e8d2992a5b4ee285824648bfa721212dd7691d63c876cf8fda1d50e924bec891af2c721e3746c4227fd23a0bed48e0b505fcd328936f5a35'
         'SKIP'
-        'ef56a70741bae70a95695b4d05d1a6395f545e671c9d016c7180732f69a09b828ff5e16964ef16f9ebec55dd778a1b50927275cd4c21a7b78ae4959946a0657c'
-        'd20861a8a8e16d4bb0143f00d4beb42e2c52eeb2c1894e9f9c04e3d74ecd750d9bdacf15bb39fd0ade4487b9d3d14da24cf5f25ceab112f096fddcd329320a15'
-        '64391cf17e7d801fb263e9d637928c3a2f6aa11aca6afbf115be4e38e9afce42371ed4884929cf11d6c74c2aa497fb26abbba1812d4f31f44dcda38e4978a33f'
+        'd3ed7043e288c78ac4007b267448457db0972905037754b67249d81be0889f47c4d93573c24d730907c31ec44e80ce696fbf50f98521eadee92c003d2324a1a3'
+        '6afaf5bff729618aa35d84f20b1447694c887b84a406f55344864b9e8dce72f80467412c128b5309d5b962b605ca396b77a52f275dd35681ab50cbedc68f873a'
+        '18ca47c350373d9a095aff9a658c61816a542bb391a2a8ddf582f25795a21e9fc344b3e71a2eed7b094610bb61d9658e5360ef2ace9441fd21e4193746d45be7'
         '23f399d5ea776df5dba1ec42a96020a7ae3b18f5a83121d90ca0256a90027529135bac751373a31480860c0dbad30598833a7da43d1e7f25ce5b6d5d945ce550')
 validpgpkeys=(
   108F66205EAEB0AAA8DD5E1C85AB96E6FA1BE5FE  # Rust Language (Tag and Release Signing Key) <rust-key@rust-lang.org>
@@ -78,7 +72,7 @@
 
   cat >config.toml <<END
 profile = "user"
-change-id = 121754
+change-id = 118703
 
 [llvm]
 link-shared = true
@@ -115,17 +109,18 @@
 prefix = "/usr"
 
 [rust]
-codegen-units-std = 1
-debuginfo-level = 1
 debuginfo-level-std = 2
 channel = "stable"
 description = "Arch Linux $pkgbase $epoch:$pkgver-$pkgrel"
 rpath = false
-frame-pointers = true
+backtrace-on-ice = true
+jemalloc = true
+
+remap-debuginfo = false
+
+codegen-units-std = 1
+
 deny-warnings = false
-backtrace-on-ice = true
-remap-debuginfo = false
-jemalloc = true
 
 [dist]
 compression-formats = ["gz"]
@@ -172,29 +167,21 @@
   cd rustc-$pkgver-src
 
   export RUST_BACKTRACE=1
-  unset CFLAGS CXXFLAGS LDFLAGS
 
   DESTDIR="$srcdir/dest-rust" python ./x.py install -j "$(nproc)"
 
   cd ../dest-rust
 
-  rm -v usr/lib/rustlib/{components,install.log,rust-installer-version,uninstall.sh}
-  rm -v usr/lib/rustlib/manifest-*
-
-  local ldir="usr/share/licenses/rust" f d
-  mkdir -p "$ldir"
-  for f in usr/share/doc/*/{COPYRIGHT,LICENSE}*; do
-    d="$(dirname "$f")"
-    case $f in
-      */LICENSE-APACHE) rm -v "$f" ;;
-      *) mv -v "$f" "$ldir/${f##*/}.${d##*/}" ;;
-    esac
-    rmdir -p --ignore-fail-on-non-empty "$d"
-  done
-
-  mkdir -pv usr/lib32
-  ln -srvft usr/lib   usr/lib/rustlib/x86_64-unknown-linux-gnu/lib/*.so
-  ln -srvft usr/lib32 usr/lib/rustlib/i686-unknown-linux-gnu/lib/*.so
+  rm usr/bin/*.old
+  rm usr/lib/rustlib/{components,install.log,rust-installer-version,uninstall.sh}
+  rm usr/lib/rustlib/manifest-*
+
+  mkdir -p usr/lib32
+  ln -srft usr/lib   usr/lib/rustlib/x86_64-unknown-linux-gnu/lib/*.so
+  ln -srft usr/lib32 usr/lib/rustlib/i686-unknown-linux-gnu/lib/*.so
+
+  mkdir -p usr/share/licenses/rust
+  mv -t usr/share/licenses/rust usr/share/doc/rust/{COPYRIGHT,LICENSE*}
 
   _pick dest-i686 usr/lib/rustlib/i686-unknown-linux-gnu usr/lib32
   _pick dest-musl usr/lib/rustlib/x86_64-unknown-linux-musl
@@ -230,7 +217,6 @@
   pkgdesc="32-bit target and libraries for Rust"
   depends=(
     lib32-gcc-libs
-    lib32-glibc
     rust
   )
   provides=(lib32-rust)
@@ -239,8 +225,8 @@
 
   cp -a dest-i686/* "$pkgdir"
 
-  install -Dt "$pkgdir/usr/share/licenses/$pkgname" -m644 \
-    rustc-$pkgver-src/{COPYRIGHT,LICENSE-MIT}
+  mkdir -p "$pkgdir/usr/share/licenses"
+  ln -s rust "$pkgdir/usr/share/licenses/$pkgname"
 }
 
 package_rust-musl() {
@@ -249,8 +235,8 @@
 
   cp -a dest-musl/* "$pkgdir"
 
-  install -Dt "$pkgdir/usr/share/licenses/$pkgname" -m644 \
-    rustc-$pkgver-src/{COPYRIGHT,LICENSE-MIT}
+  mkdir -p "$pkgdir/usr/share/licenses"
+  ln -s rust "$pkgdir/usr/share/licenses/$pkgname"
 }
 
 package_rust-wasm() {
@@ -262,8 +248,8 @@
 
   cp -a dest-wasm/* "$pkgdir"
 
-  install -Dt "$pkgdir/usr/share/licenses/$pkgname" -m644 \
-    rustc-$pkgver-src/{COPYRIGHT,LICENSE-MIT}
+  mkdir -p "$pkgdir/usr/share/licenses"
+  ln -s rust "$pkgdir/usr/share/licenses/$pkgname"
 }
 
 package_rust-src() {
@@ -272,7 +258,7 @@
 
   cp -a dest-src/* "$pkgdir"
 
-  install -Dt "$pkgdir/usr/share/licenses/$pkgname" -m644 \
-    rustc-$pkgver-src/{COPYRIGHT,LICENSE-MIT}
-}
-
+  mkdir -p "$pkgdir/usr/share/licenses"
+  ln -s rust "$pkgdir/usr/share/licenses/$pkgname"
+}
+


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,12 +1,8 @@
-bash
-clang
 cmake
 curl
 gcc
 gcc-libs
-glibc
 lib32-gcc-libs
-lib32-glibc
 libffi
 libssh2
 lld
@@ -14,9 +10,7 @@
 llvm-libs
 musl
 ninja
-openssl
 perl
 python
 rust
 wasi-libc
-zlib

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -6,7 +6,7 @@
 patch -Np1 -i ../0004-compiler-Use-wasm-ld-for-wasm-targets.patch
 cat >config.toml <<END
 profile = "user"
-change-id = 121754
+change-id = 118703
 [llvm]
 link-shared = true
 [build]
@@ -38,17 +38,15 @@
 [install]
 prefix = "/usr"
 [rust]
-codegen-units-std = 1
-debuginfo-level = 1
 debuginfo-level-std = 2
 channel = "stable"
 description = "Arch Linux $pkgbase $epoch:$pkgver-$pkgrel"
 rpath = false
-frame-pointers = true
+backtrace-on-ice = true
+jemalloc = true
+remap-debuginfo = false
+codegen-units-std = 1
 deny-warnings = false
-backtrace-on-ice = true
-remap-debuginfo = false
-jemalloc = true
 [dist]
 compression-formats = ["gz"]
 [target.x86_64-unknown-linux-gnu]
@@ -77,24 +75,16 @@
 build() {
 cd rustc-$pkgver-src
 export RUST_BACKTRACE=1
-unset CFLAGS CXXFLAGS LDFLAGS
 DESTDIR="$srcdir/dest-rust" python ./x.py install -j "$(nproc)"
 cd ../dest-rust
-rm -v usr/lib/rustlib/{components,install.log,rust-installer-version,uninstall.sh}
-rm -v usr/lib/rustlib/manifest-*
-local ldir="usr/share/licenses/rust" f d
-mkdir -p "$ldir"
-for f in usr/share/doc/*/{COPYRIGHT,LICENSE}*; do
-d="$(dirname "$f")"
-case $f in
-*/LICENSE-APACHE) rm -v "$f" ;;
-*) mv -v "$f" "$ldir/${f##*/}.${d##*/}" ;;
-esac
-rmdir -p --ignore-fail-on-non-empty "$d"
-done
-mkdir -pv usr/lib32
-ln -srvft usr/lib   usr/lib/rustlib/x86_64-unknown-linux-gnu/lib/*.so
-ln -srvft usr/lib32 usr/lib/rustlib/i686-unknown-linux-gnu/lib/*.so
+rm usr/bin/*.old
+rm usr/lib/rustlib/{components,install.log,rust-installer-version,uninstall.sh}
+rm usr/lib/rustlib/manifest-*
+mkdir -p usr/lib32
+ln -srft usr/lib   usr/lib/rustlib/x86_64-unknown-linux-gnu/lib/*.so
+ln -srft usr/lib32 usr/lib/rustlib/i686-unknown-linux-gnu/lib/*.so
+mkdir -p usr/share/licenses/rust
+mv -t usr/share/licenses/rust usr/share/doc/rust/{COPYRIGHT,LICENSE*}
 _pick dest-i686 usr/lib/rustlib/i686-unknown-linux-gnu usr/lib32
 _pick dest-musl usr/lib/rustlib/x86_64-unknown-linux-musl
 _pick dest-wasm usr/lib/rustlib/wasm32-*
