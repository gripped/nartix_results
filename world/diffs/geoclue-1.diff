--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,7 +1,7 @@
 
 pkgname=geoclue
 pkgver=2.7.1
-pkgrel=3
+pkgrel=2
 pkgdesc="Modular geoinformation service built on the D-Bus messaging system"
 url="https://gitlab.freedesktop.org/geoclue/geoclue/-/wikis/home"
 arch=(x86_64)
@@ -21,7 +21,7 @@
   gtk-doc
   libnotify
   meson
-  systemd
+  udev
   vala
 )
 optdepends=('libnotify: Demo Agent')
@@ -29,31 +29,26 @@
 conflicts=(geoclue2)
 replaces=(geoclue2)
 backup=(etc/geoclue/geoclue.conf)
-source=(
-  "git+https://gitlab.freedesktop.org/geoclue/geoclue.git#tag=$pkgver"
-  0001-WIP-Use-Google-Maps-Platform-by-default.patch
-)
-b2sums=('0e8ab05d8124598d9bd306bb2f81a9c4e47c02b710265048e19d950d8587e3ff729234b2e07847c3f0b9118c7b89153f9e59b6414a6660007203e7a831ce839b'
-        '192e35693aa8145ac3ad23ee0fb64a247298e57959095281614cc33be27e60ad7ce16117df043ab7bff9ca721cce3e82cea0bfaddb9c5996b24be7cb4ebd95ce')
+_commit=8a24f60969d4c235d9918796c38a6a9c42e10131  # tags/2.7.1
+source=("git+https://gitlab.freedesktop.org/geoclue/geoclue.git#commit=$_commit")
+b2sums=('SKIP')
 
-_google_api_key=AIzaSyDwr302FpOSkGRpLlUpPThNTDPbXcIn_FM
-
-_mozilla_api_key=e05d56db0a694edc8b5aaebda3f2db6a
+pkgver() {
+  cd geoclue
+  git describe --tags | sed 's/[^-]*-g/r&/;s/-/+/g'
+}
 
 prepare() {
   cd geoclue
-
-  git apply -3 ../0001-WIP-Use-Google-Maps-Platform-by-default.patch
 }
 
 build() {
   local meson_options=(
     -D dbus-srv-user=geoclue
-    -D google-api-key="$_google_api_key"
-    -D mozilla-api-key="$_mozilla_api_key"
+    -D dbus-sys-dir=/usr/share/dbus-1/system.d
   )
 
-  arch-meson geoclue build "${meson_options[@]}"
+  artix-meson geoclue build "${meson_options[@]}"
   meson compile -C build
 }
 


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -7,5 +7,5 @@
 libnotify
 libsoup3
 meson
-systemd
+udev
 vala