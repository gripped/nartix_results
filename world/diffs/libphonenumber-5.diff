--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,7 +1,7 @@
 
 pkgname=libphonenumber
-pkgver=8.13.46
-pkgrel=1
+pkgver=8.13.45
+pkgrel=2
 epoch=1
 pkgdesc="Google's common library for parsing, formatting, and validating international phone numbers"
 url="https://github.com/googlei18n/libphonenumber"
@@ -17,12 +17,14 @@
 makedepends=(
   cmake
   git
+  gtest
+  jre-openjdk-headless
 )
 source=(
   "git+$url#tag=v$pkgver"
   0001-Use-find_package-for-protobuf.patch
 )
-b2sums=('d240dabb3e2e240db0eaf0b967cb6b1505a95b748245f7b3a7f4e91a3149ff505164d06a70118b813911e1231177d6c25d0903e1c9a2be701f295af0d0dbdafd'
+b2sums=('db600668e2d14975e9450185831a920ae72677dbc2bf68c02b5846d57e0264d844aba62f79d51b15b7dc0479a9320e0e6af7f2c84d95b1befa33352222c7cea0'
         '8fc1c65d863051052bb1cb3759a252a3b36a9dffa1335eae4d043821797651e57ca8902cced0672d3c47192b50b9b54436a1551ce65b2e9a4bd82351a58ef1ac')
 
 prepare() {
@@ -33,18 +35,19 @@
 
 build() {
   local cmake_options=(
-    -D CMAKE_INSTALL_PREFIX=/usr
-    -D CMAKE_BUILD_TYPE=None
-    -D CMAKE_CXX_STANDARD=17
-    -D USE_BOOST=OFF
-    -D USE_STDMUTEX=ON
-
-    -D BUILD_TESTING=OFF
-    -D REGENERATE_METADATA=OFF
+    -DCMAKE_INSTALL_PREFIX=/usr
+    -DCMAKE_BUILD_TYPE=None
+    -DCMAKE_CXX_STANDARD=17
+    -DUSE_BOOST=OFF
+    -DUSE_STDMUTEX=ON
   )
 
   cmake -S $pkgname/cpp -B build "${cmake_options[@]}"
   cmake --build build
+}
+
+check() {
+  cmake --build build --target tests
 }
 
 package() {


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -3,7 +3,9 @@
 gcc-libs
 git
 glibc
+gtest
 icu
+jre-openjdk-headless
 libicui18n.so
 libicuuc.so
 libprotobuf.so

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -4,13 +4,11 @@
 }
 build() {
 local cmake_options=(
--D CMAKE_INSTALL_PREFIX=/usr
--D CMAKE_BUILD_TYPE=None
--D CMAKE_CXX_STANDARD=17
--D USE_BOOST=OFF
--D USE_STDMUTEX=ON
--D BUILD_TESTING=OFF
--D REGENERATE_METADATA=OFF
+-DCMAKE_INSTALL_PREFIX=/usr
+-DCMAKE_BUILD_TYPE=None
+-DCMAKE_CXX_STANDARD=17
+-DUSE_BOOST=OFF
+-DUSE_STDMUTEX=ON
 )
 cmake -S $pkgname/cpp -B build "${cmake_options[@]}"
 cmake --build build
