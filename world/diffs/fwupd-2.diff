--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -4,7 +4,7 @@
   fwupd
   fwupd-docs
 )
-pkgver=2.0.0
+pkgver=1.9.25
 pkgrel=1
 pkgdesc="Simple daemon to allow session software to update firmware"
 arch=(x86_64)
@@ -24,11 +24,12 @@
   json-glib
   libarchive
   libcbor
+  libgudev
+  libgusb
   libjcat
   libmbim
   libmm-glib
   libqmi
-  libusb
   libxmlb
   passim
   polkit
@@ -36,7 +37,6 @@
   python
   shared-mime-info
   sqlite
-  systemd-libs
   tpm2-tss
   xz
   zlib
@@ -58,45 +58,36 @@
   vala
   valgrind
 )
-checkdepends=(
-  umockdev
-  python-dbusmock
-)
+checkdepends=(umockdev)
 source=(
   "https://github.com/fwupd/fwupd/releases/download/${pkgver}/${pkgname}-${pkgver}.tar.xz"{,.asc}
   fwupd.sysusers
-  fix-2.0.0-build.patch::https://github.com/fwupd/fwupd/commit/9637c35339111d92add461fc3ad2a032e90abc9c.patch
 )
-sha512sums=('5558bfb53128bb13a8e6802bb663043877b65509fbb37f6abbc23713f9414e888f0fa4be9a4bcef2a971c6a6d819342cbb2044efd7af8c9d7c43b34b3ffd04a3'
+sha512sums=('1c50c444456f12a048d9b476c78fd539b11079e3a8a8eb87c1f6cfc0419c4e80691622e9615a38b5c92aec7ef9174d16dcf63fabbabf223cda34350eb196e220'
             'SKIP'
-            '637203080b55eda74a659f58c853a9a723a2dad5da70915b2b0e036c6145a649468ebec700cc83975d9cb5378b9dced8b3a3b26bdbcc75ddc774837355e75deb'
-            '2a29ae3e41b5ee871ffa5a183595734ac5ef47c033f59a8d798d0c5dc773eb71e941074c5c4b918dca8329fb9262136e803f9bb2deba2f06349c51ef9aca2e21')
-b2sums=('4563abe4d61e929573fcab478e0c94f7568f476f315ea9a9b2c4162776d309cd7985d1fb4a1c1c62d95ee4bfeddab7264ed2a63b543572236ca76323a009d28a'
+            '637203080b55eda74a659f58c853a9a723a2dad5da70915b2b0e036c6145a649468ebec700cc83975d9cb5378b9dced8b3a3b26bdbcc75ddc774837355e75deb')
+b2sums=('783d880f7d092a03e2b54c8f1b34e9de5dde2138409fca958dfa8fe72169d066dc86140055f2af95dc31055dda893542bbbe42c37984d5d3066a77754c960e7b'
         'SKIP'
-        'e65ca7da22a20a40882cfc1fe4479643f9a38c90a4f2c3e71e6e5e3de1d6db212a0f17d600097619fe3cdb0a9b860422f8b0b9a9d45441518e51a7eb12a918bb'
-        'c03a978e6558d039257219c16e385acd2b6e3c0e1b640f1793e8642a5ebd1ffe22397b48829090ea5dd5740e1e2ff034d9011d1fab4573a43e6ab12ba0e43685')
+        'e65ca7da22a20a40882cfc1fe4479643f9a38c90a4f2c3e71e6e5e3de1d6db212a0f17d600097619fe3cdb0a9b860422f8b0b9a9d45441518e51a7eb12a918bb')
 validpgpkeys=(163EB50119225DB3DF8F49EA17ACBA8DFA970E17) # Richard Hughes <richard@hughsie.com>
-
-prepare() {
-  cd ${pkgname}-${pkgver}
-  patch -Np1 < ../fix-2.0.0-build.patch
-}
 
 build() {
   local meson_options=(
+    -D systemd=disabled
+    -D offline=disabled
+    -D elogind=enabled
     -D docs=enabled
     -D efi_binary=false
     -D launchd=disabled
     -D supported_build=enabled
-    -D systemd_unit_user=fwupd
   )
 
-  arch-meson ${pkgname}-${pkgver} build "${meson_options[@]}"
+  artix-meson ${pkgname}-${pkgver} build "${meson_options[@]}"
   meson compile -C build
 }
 
 check() {
-  meson test -C build --print-errorlogs
+  meson test -C build --print-errorlogs || :
 }
 
 _pick() {
@@ -139,8 +130,8 @@
   rm -r "${pkgdir}"/usr/{lib,share}/installed-tests/
   mv "${pkgdir}"/usr/bin/{,fwupd-}dbxtool
   mv "${pkgdir}"/usr/share/man/man1/{,fwupd-}dbxtool.1
-  rm "${pkgdir}"/usr/lib/modules-load.d/fwupd-msr.conf
-  rmdir "${pkgdir}"/usr/lib/modules-load.d
+  rm "${pkgdir}"/usr/lib/modules-load.d/fwupd-msr.conf || :
+  rmdir "${pkgdir}"/usr/lib/modules-load.d || :
 
   _pick docs "${pkgdir}"/usr/share/doc/{,fwupd/}{libfwupdplugin,libfwupd}
 }


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -20,7 +20,9 @@
 libcbor.so
 libcurl.so
 libdrm
+libgudev
 libgudev-1.0.so
+libgusb
 libjcat
 libjson-glib-1.0.so
 libmbim
@@ -30,7 +32,6 @@
 libprotobuf-c.so
 libqmi
 libqmi-glib.so
-libusb
 libxmlb
 meson
 noto-fonts
@@ -46,7 +47,6 @@
 python-pillow
 shared-mime-info
 sqlite
-systemd-libs
 tpm2-tss
 vala
 valgrind