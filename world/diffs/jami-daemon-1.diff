--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,7 +1,7 @@
 
 pkgname=jami-daemon
-pkgver=20260206
-pkgrel=1
+pkgver=20250929
+pkgrel=2
 pkgdesc="Free and universal communication platform which preserves the usersâ€™ privacy and freedoms (daemon component)"
 arch=(x86_64)
 url="https://jami.net"
@@ -9,24 +9,26 @@
 groups=(jami)
 depends=(glibc opendht gnutls nettle libgit2 libsecp256k1 libsecp256k1.so ffmpeg speexdsp
          fmt yaml-cpp jsoncpp zlib alsa-lib libpulse jack libupnp libnatpmp
-         openssl webrtc-audio-processing-0.3 systemd-libs libarchive)
-makedepends=(git cmake perl asio msgpack-c msgpack-cxx restinio systemd meson)
+         openssl webrtc-audio-processing-0.3 libudev libarchive)
+makedepends=(git cmake perl asio msgpack-c msgpack-cxx restinio udev meson)
 checkdepends=(cppunit)
-_commit=55dd53736b9e6cd7204cc17e01d10d8a9276618f
-_pjprojectver=59d9e1355686cf4f3f3d81d45560058354f42802
-_dhtnetver=cff03260fa037f59d6768bac26014b01c07b3fb9
+_commit=afe2446133eb3c9279e42b0d1dcfdd9a3c76a35f
+_pjprojectver=93dc96918bb6ba74e1e1d00c40c80402e856f2ac
+_dhtnetver=7861b4620b4cec5fa34c5d1bb2b304912730f638
 source=(git+https://git.jami.net/savoirfairelinux/${pkgname}.git#commit=${_commit}
         https://github.com/savoirfairelinux/pjproject/archive/${_pjprojectver}/pjproject-${_pjprojectver}.tar.gz
-        dhtnet-$_dhtnetver.tar.gz::https://git.jami.net/savoirfairelinux/dhtnet/-/archive/$_dhtnetver/dhtnet-$_dhtnetver.tar.gz
+        dhtnet-$_dhtnetver.tar.gz::https://git.jami.net/savoirfairelinux/dhtnet/-/archive/${_dhtnetver}/dhtnet-${_dhtnetver}.tar.gz
         ffmpeg-7.patch
-        ffmpeg-8.patch)
+        ffmpeg-8.patch
+        fmt-12.patch)
 noextract=(pjproject-${_pjprojectver}.tar.gz
            dhtnet-${_dhtnetver}.tar.gz)
-sha512sums=('e544bfac1eb2184f2b3a10d9e98a644068b5d2d5d622822e647d23b4ded21054d0e6e72defe7d74df4d2d44ca246643196228ccda19c41b7fbd4371ebfc36ce7'
-            'c5966468225782bedfbed218e58ebe2491ba8fa897edc1590de22ffe513a7b1bf814c5e75761d980d651c9d56e5c4f64b16f68d413062a4a9960d53cdd0ae047'
+sha512sums=('1748c2ebbdfbce597f0c3f409963a7898f097b85c2a2ac56e097cb3abe4ff070d5c559ffa5224dc37af26d4c0f8a0713b4ef96c6716c709f6946bfdaba9de114'
+            'a6e95c93a12e66f86020d506916dfe9f028bc8fd5fb7308839358734b19de73b33696493a3958ac3797295d68eb285cfa3077c9c1f7eae3a571236d400dd2870'
             'SKIP'
-            '6e927376938e6687a438b4984e37a23a921fb6b3e87f804b6eb9365af18b04bd5b601fd7be95ae326d8e5f15d82552ae7dd5367a1eb834bd0d7d77600e05c82e'
-            '8fcfe52808d00b8535dc6d181af0233dc0f3a51e8da69728a04e7f6edc82c54fb11e62ffad05344d9eeb6d203dc323ffa03181c615c7c6f84682f70a02ee4319')
+            '720c60053779e72273d7abf339008284f5473b4f9a101e21eae352e9663559c7591f8e3481d9b479d113f306da9d0b3ffa53d32091c8d795b3252afd7e39afec'
+            '933e223f4bcaacaaf052de906daa10ed85020677a20158df96b78b9648edf27c601d932434315d16563dadc61338a7124e5cc8e2495281ed1f83b1f30234b496'
+            'b645545120608e70f70ee664d43de03fa07ebc5b2af9a6515a40220aabfe057d4f69034b15781a21c5e8ff6f2fbb353b7dea69d840cb299f9dbf58eeaf082a40')
 
 pkgver() {
   cd ${pkgname}
@@ -40,6 +42,16 @@
   cp ../dhtnet-$_dhtnetver.tar.gz contrib/tarballs/
   mkdir -p contrib/native
 
+  cd contrib/tarballs
+  mkdir -p dhtnet
+  tar -xzf dhtnet-$_dhtnetver.tar.gz -C dhtnet --strip-components=1
+  cd dhtnet
+  patch -p1 -i "$srcdir"/fmt-12.patch
+  tar -czf ../dhtnet-$_dhtnetver.tar.gz *
+  cd ..
+  rm -fr dhtnet
+  cd ../..
+
   patch -p1 -i ../ffmpeg-7.patch # Fix build with ffmpeg 7+
   patch -p1 -i ../ffmpeg-8.patch # Fix build with ffmpeg 8
 }
@@ -52,10 +64,13 @@
       --enable-pjproject \
       --enable-dhtnet
 
+  make dhtnet
+  sed -io 's/fmt::ptr(pimpl_)/fmt::ptr(pimpl_.get())/g' dhtnet/src/ice_transport.cpp
+
   make DEPS_pjproject= DEPS_dhtnet=pjproject
 
   cd "${srcdir}"
-  arch-meson ${pkgname} build -D interfaces=library -D opensl=disabled -D portaudio=disabled \
+  artix-meson ${pkgname} build -D interfaces=library -D opensl=disabled -D portaudio=disabled \
                               $( ((CHECKFUNC)) && echo -D tests=true) \
                               -D pkg_config_path="${PWD}/${pkgname}/contrib/$(cc -dumpmachine)/lib/pkgconfig"
   meson compile -C build


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -14,6 +14,7 @@
 libpulse
 libsecp256k1
 libsecp256k1.so
+libudev
 libupnp
 meson
 msgpack-c
@@ -24,8 +25,7 @@
 perl
 restinio
 speexdsp
-systemd
-systemd-libs
+udev
 webrtc-audio-processing-0.3
 yaml-cpp
 zlib