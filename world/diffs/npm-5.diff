--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,6 +1,6 @@
 
 pkgname=npm
-pkgver=11.4.2
+pkgver=11.4.1
 pkgrel=1
 pkgdesc='JavaScript package manager'
 arch=(any)
@@ -12,18 +12,14 @@
   nodejs-nopt
   semver
 )
-makedepends=(
-  git
-  jq
-)
+makedepends=(git)
 optdepends=("git: for dependencies using Git URL's")
 source=("npm-cli::git+https://github.com/npm/cli.git#tag=v$pkgver")
-b2sums=('223f4ba1e54ad96939d493f425fa0f9ca02f4a4cead055439ca9a9ac8aa2263a86b7f31dd437c635ca15040d9b394b243827680abe536ed6a3f120579d5a6eff')
+b2sums=('8c5c20e6063b64f6648ffc59cfd47feed8fccbb2e59aa308c6e226533902fd6e7fa82f3fe6c3e2d32dbffbe19cf89e47d8920bc2b15f6b1f59317498f165b327')
 
 build() {
   cd npm-cli
   node scripts/resetdeps.js
-  node . run build -w docs
 }
 
 check() {
@@ -36,19 +32,16 @@
 package() {
   local mod_dir=/usr/lib/node_modules/$pkgname
 
-  install -d "$pkgdir"/{usr/{bin,share/{bash-completion/completions,licenses/$pkgname}},$mod_dir}
-  ln -s $mod_dir/bin/$pkgname-cli.js "$pkgdir"/usr/bin/$pkgname
-  ln -s $mod_dir/bin/npx-cli.js "$pkgdir"/usr/bin/npx
+  install -d "$pkgdir"/usr/share/{bash-completion/completions,licenses/$pkgname}
   ln -s $mod_dir/LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
 
   cd npm-cli
-  mapfile -t mod_files < <(node . pack --ignore-scripts --dry-run --json | jq -r .[].files.[].path)
-  cp --parents -a "${mod_files[@]}" "$pkgdir"/$mod_dir
+  node . install -g --prefix="$pkgdir/usr" "$(node . pack --ignore-scripts | tail -1)"
   node . completion > "$pkgdir"/usr/share/bash-completion/completions/npm
   echo 'globalconfig=/etc/npmrc' > "$pkgdir"/$mod_dir/npmrc
 
   cd "$pkgdir"/$mod_dir
-  rm -r bin/{node-gyp-bin,np{m,x}{,.{cmd,ps1}}}
+  rm -r {bin/{node-gyp-bin,np{m,x}{,.{cmd,ps1}}},node_modules/.bin}
 
   rm -r node_modules/{node-gyp,nopt,semver}
 


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,5 +1,4 @@
 git
-jq
 node-gyp
 nodejs-nopt
 nodejs>

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,5 +1,4 @@
 build() {
 cd npm-cli
 node scripts/resetdeps.js
-node . run build -w docs
 }
