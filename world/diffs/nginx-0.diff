--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,8 +1,8 @@
 
 pkgbase=nginx
 pkgname=(nginx nginx-src)
-pkgver=1.26.0
-pkgrel=2
+pkgver=1.24.0
+pkgrel=3
 arch=(x86_64)
 url='https://nginx.org'
 license=(custom)
@@ -19,18 +19,16 @@
         etc/nginx/win-utf
         etc/logrotate.d/nginx)
 source=($url/download/nginx-$pkgver.tar.gz{,.asc}
-        hg+https://hg.nginx.org/nginx-tests
-        nginx.service
-        logrotate)
-validpgpkeys=('B0F4253373F8F6F510D42178520A9993A1C052F8'  # Maxim Dounin <mdounin@mdounin.ru>
-              '43387825DDB1BB97EC36BA5D007C8D7C15D87369'  # Roman Arutyunyan <r.arutyunyan@f5.com>
-              'D6786CE303D9A9022998DC6CC8464D549AF75C0A'  # Sergey Kandaurov <s.kandaurov@f5.com>
+        hg+https://hg.nginx.org/nginx-tests#revision=24482e311749
+        logrotate
+        HTTP2_per-iteration-stream-handling-limit.patch::https://hg.nginx.org/nginx/raw-rev/cdda286c0f1b)
+validpgpkeys=('B0F4253373F8F6F510D42178520A9993A1C052F8' # Maxim Dounin <mdounin@mdounin.ru>
               '13C82A63B603576156E30A4EA0EA981B66B0D967') # Konstantin Pavlov <thresh@nginx.com>
-sha512sums=('1f604a4a29f1b74eb56de7f1d8b0e5610fa055280b4ad2d3550c56926460de24da81b17485cffb358d8814061d4a9db1e0e5079af7921f1dc329e283e2775791'
+sha512sums=('1114e37de5664a8109c99cfb2faa1f42ff8ac63c932bcf3780d645e5ed32c0b2ac446f80305b4465994c8f9430604968e176ae464fd80f632d1cb2c8f6007ff3'
             'SKIP'
             'SKIP'
-            'ca7d8666177d31b6c4924e9ab44ddf3d5b596b51da04d38da002830b03bd176d49354bbdd2a496617d57f44111ad59833296af87d03ffe3fca6b99327a7b4c3c'
-            '2f4dfcfa711b8bcbc5918ba635f5e430ef7132e66276261ade62bb1cba016967432c8dce7f84352cb8b07dc7c6b18f09177aa3eb92c8e358b2a106c8ca142fe9')
+            '2f4dfcfa711b8bcbc5918ba635f5e430ef7132e66276261ade62bb1cba016967432c8dce7f84352cb8b07dc7c6b18f09177aa3eb92c8e358b2a106c8ca142fe9'
+            '18b69643648119dfab45101bb9404be667aeb9d550aa3bc9706e63e7da1c2806106e9a6bbfb2d10bd57ef56b9b5b0b524059353ec30a51469b44641cb7dbd8a6')
 
 _common_flags=(
   --with-compat
@@ -53,7 +51,6 @@
   --with-http_stub_status_module
   --with-http_sub_module
   --with-http_v2_module
-  --with-http_v3_module
   --with-mail
   --with-mail_ssl_module
   --with-pcre-jit
@@ -70,6 +67,8 @@
 
 prepare() {
   cp -r $pkgbase-$pkgver{,-src}
+  cd $pkgbase-$pkgver
+  patch -Np1 -i "$srcdir/HTTP2_per-iteration-stream-handling-limit.patch"
 }
 
 build() {
@@ -128,7 +127,6 @@
   mv "$pkgdir"/etc/nginx/html/ "$pkgdir"/usr/share/nginx
 
   install -Dm644 ../logrotate "$pkgdir"/etc/logrotate.d/nginx
-  install -Dm644 ../nginx.service "$pkgdir"/usr/lib/systemd/system/nginx.service
   install -Dm644 LICENSE "$pkgdir"/usr/share/licenses/$pkgbase/LICENSE
 
   rmdir "$pkgdir"/run


############# Stripped diff below #################



--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,5 +1,7 @@
 prepare() {
 cp -r $pkgbase-$pkgver{,-src}
+cd $pkgbase-$pkgver
+patch -Np1 -i "$srcdir/HTTP2_per-iteration-stream-handling-limit.patch"
 }
 build() {
 cd $pkgbase-$pkgver
