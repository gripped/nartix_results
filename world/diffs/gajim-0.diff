--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,6 +1,6 @@
 
 pkgname=gajim
-pkgver=1.9.4
+pkgver=1.9.3
 pkgrel=1
 pkgdesc="Full featured and easy to use XMPP (Jabber) client"
 url="https://gajim.org/"
@@ -26,13 +26,21 @@
             'libxss: for idle time checking on X11'
             'python-gnupg: encrypting chat messages with OpenPGP'
             'emoji-font: for emojis support')
-source=("https://dev.gajim.org/gajim/gajim/-/archive/${pkgver}/gajim-${pkgver}.tar.gz")
-sha512sums=('a0f34de8bdcf5e603e69d9ecfb0b66085a49bace4e2c85d36c2bd923c1b618d3f5619d90bdb11c91c1f04d40aca00eec42ce761fb26b71bdc850df7776bd22d9')
-b2sums=('814d7625025656fa3e87da5e4332ad6f1f3137c53b0f0ea667d6bbdbabcf5190a6563226e488e1a2a465b6d4690b88f807d4a99666880641d708fd7806e27d43')
+source=("https://dev.gajim.org/gajim/gajim/-/archive/${pkgver}/gajim-${pkgver}.tar.gz"
+        disable-failing-test.patch)
+sha512sums=('19a4dfed6116e62b2cd692192b472f0cc2965364d6d14c053d25816bb55a03a9d552b3ef239ba19c07ca3bc3b74fd53d32cc1d075d1a3c7e6d58cf2edf74a1c4'
+            '6244bf8738baf57e391140a7df7f270394b05055ebdf57acd5f30ffd0afec542ccd4348e59a7c64a1ecfb7b7d29ef21e2f823ea765a5281eba63692b9ab488f3')
+b2sums=('69366379d4c928197f6553378c28cd92e120a9006e8aa1de4c1dbd63efe688124d3e1213b801f478b8326ba5e3ef12e2562348de1340db5d3c939ee02ebd7923'
+        '4bcc5859ea58bee9fabb2888172aed80bfe240bc5888c9795e382ddc511b51b7f0f5b63e6c207370e182ed41bc08242f8f38574dddf26803c30fda465924870c')
+
+prepare() {
+	cd "${pkgname}-${pkgver}"
+	patch -p1 -i ../disable-failing-test.patch # Disable test that fails with pango
+}
 
 build() {
 	cd "${pkgname}-${pkgver}"
-	./make.py build --dist unix
+	./pep517build/build_metadata.py -o dist/metadata
 	python -m build --wheel --no-isolation
 }
 
@@ -44,5 +52,5 @@
 package() {
 	cd "${pkgname}-${pkgver}"
 	python -m installer --destdir="${pkgdir}" dist/*.whl
-	./make.py install --dist unix --prefix="${pkgdir}/usr"
+	./pep517build/install_metadata.py dist/metadata --prefix="${pkgdir}/usr"
 }


############# Stripped diff below #################



--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,5 +1,9 @@
+prepare() {
+cd "${pkgname}-${pkgver}"
+patch -p1 -i ../disable-failing-test.patch # Disable test that fails with pango
+}
 build() {
 cd "${pkgname}-${pkgver}"
-./make.py build --dist unix
+./pep517build/build_metadata.py -o dist/metadata
 python -m build --wheel --no-isolation
 }
