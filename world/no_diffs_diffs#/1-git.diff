--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,7 +1,7 @@
 
 pkgbase=git
 pkgname=(git git-zsh-completion)
-pkgver=2.51.2
+pkgver=2.51.1
 pkgrel=2
 pkgdesc='the fast distributed version control system'
 arch=('x86_64')
@@ -14,12 +14,8 @@
 install=git.install
 validpgpkeys=('96E07AF25771955980DAD10020D04E5A713660A7') # Junio C Hamano
 source=("git+https://github.com/git/git#tag=v${pkgver}?signed"
-        'git-daemon@.service'
-        'git-daemon.socket'
         'git-sysusers.conf')
-sha256sums=('a36180466af73b15e1bc5dac6fb56fec69d9d2791c0792ce1196e9aa80d5a089'
-            '14c0b67cfe116b430645c19d8c4759419657e6809dfa28f438c33a005245ad91'
-            'ac4c90d62c44926e6d30d18d97767efc901076d4e0283ed812a349aece72f203'
+sha256sums=('f53dbc1ee567e38b37427c28eb0accc13f681e63d0d343b2096494f32a295665'
             '7630e8245526ad80f703fac9900a1328588c503ce32b37b9f8811674fcda4a45')
 
 _make() {
@@ -53,6 +49,8 @@
 check() {
   cd "$pkgbase"
 
+  sed -i '/eval/s|ssh-agent|ssh-agent -T|' t/t7528-signed-commit-ssh.sh
+
   local jobs
   jobs=$(expr "$MAKEFLAGS" : '.*\(-j[0-9]*\).*') || true
   mkdir -p /dev/shm/git-test
@@ -63,6 +61,8 @@
     GIT_PROVE_OPTS="$jobs -Q" \
     GIT_TEST_OPTS="--root=/dev/shm/git-test" \
     test
+
+  git restore -- .
 }
 
 package_git() {
@@ -100,8 +100,6 @@
   find contrib/ -name '.gitignore' -delete
   cp -a ./contrib/* "$pkgdir"/usr/share/git/
 
-  install -D -m 0644 "$srcdir"/git-daemon@.service "$pkgdir"/usr/lib/systemd/system/git-daemon@.service
-  install -D -m 0644 "$srcdir"/git-daemon.socket "$pkgdir"/usr/lib/systemd/system/git-daemon.socket
 
   install -D -m 0644 "$srcdir"/git-sysusers.conf "$pkgdir"/usr/lib/sysusers.d/git.conf
 }
