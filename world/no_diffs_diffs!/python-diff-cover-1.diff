--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,7 +1,7 @@
 
 pkgname=python-diff-cover
 _pkgname=diff_cover
-pkgver=9.2.1
+pkgver=9.2.2
 pkgrel=1
 pkgdesc="Automatically find diff lines that need test coverage"
 arch=(any)
@@ -21,6 +21,7 @@
   python-wheel
 )
 checkdepends=(
+  flake8
   python-pycodestyle
   python-pyflakes
   python-pylint
@@ -29,28 +30,25 @@
   python-pytest-mock
 )
 optdepends=('python-tomli: for TOML support')
-source=("$_pkgname-$pkgver.tar.gz::$url/archive/v$pkgver.tar.gz")
-sha256sums=('c02c3dcdccc23caca47db7adb4f4c882a7193be5d59e238624839a9eb9b89391')
+source=("$pkgname-$pkgver.tar.gz::$url/archive/v$pkgver.tar.gz")
+sha256sums=('cf6f2215c2cede3ac5b727563010170e45bcdad10667ff2214d07d87220d12f7')
 
 build() {
   cd $_pkgname-$pkgver
-
   python -m build --wheel --no-isolation
 }
 
 check() {
   cd $_pkgname-$pkgver
-
-  python -m installer -d tmp_install dist/*.whl
-  local site_packages=$(python -c "import site; print(site.getsitepackages()[0])")
-  export PYTHONPATH="$PWD/tmp_install/$site_packages"
-  pytest \
-    --deselect 'tests/test_violations_reporter.py::TestFlake8QualityReporterTest::test_file_does_not_exist'
+  python -m venv --system-site-packages test-env
+  test-env/bin/python -m installer dist/*.whl
+  test-env/bin/python -m pytest \
+    --deselect tests/test_integration.py::TestDiffQualityIntegration::test_html_with_external_css \
+    --deselect tests/test_snippets.py::test_style_defs
 }
 
 package() {
   cd $_pkgname-$pkgver
-
   python -m installer --destdir="$pkgdir" dist/*.whl
   install -vDm644 -t "$pkgdir/usr/share/doc/$pkgname" README.rst
 }
