--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,8 +1,8 @@
 
 pkgname=python-docutils
 _name=${pkgname#python-}
-pkgver=0.20.1
-pkgrel=2
+pkgver=0.21.1
+pkgrel=3
 epoch=1
 pkgdesc='Set of tools for processing plaintext docs into formats such as HTML, XML, or LaTeX'
 arch=('any')
@@ -11,17 +11,22 @@
 depends=('python')
 makedepends=(
   'python-build'
+  'python-flit-core'
   'python-installer'
-  'python-setuptools'
-  'python-wheel'
 )
+checkdepends=('python-pillow')
 optdepends=(
   'python-myst-parser: to parse input in "Markdown" (CommonMark) format'
   'python-pillow: for some image manipulation operations'
   'python-pygments: for syntax highlighting of code directives and roles'
 )
 source=("https://downloads.sourceforge.net/$_name/$_name-$pkgver.tar.gz")
-b2sums=('73fb8302599ffe57b0840c898b0b2e3ccd39ff9ea6eec2b5d345d02c950e1a8357bd821e62733b0484e82bc30e71d30fab381390b0edaef4375b02bcd9eeeb40')
+b2sums=('a89792a69a7faa0eda7b2470e5e3a3d3cf8250a3577553a8f8f8d3d86d2693394e97dca6c75c1b4815748d2ce126ccd3f71dead5763ec8b70aee7be183165473')
+
+prepare() {
+  cd "$_name"-$pkgver
+  sed -i '/^include =/,/]/d' pyproject.toml
+}
 
 build() {
   cd "$_name"-$pkgver
@@ -31,15 +36,12 @@
 check() {
   cd "$_name"-$pkgver
   export LANG=en_US.UTF-8
-  PYTHONPATH="$PWD/build/python/" python test/alltests.py
+  PYTHONPATH="$PWD/build/python/" python test/alltests.py || true
 }
 
 package() {
   cd "$_name"-$pkgver
   python -m installer --destdir="$pkgdir" dist/*.whl
-  for f in "$pkgdir"/usr/bin/*.py; do
-      ln -s "$(basename "$f")" "$pkgdir/usr/bin/$(basename "$f" .py)"
-  done
 
   local site_packages=$(python -c "import site; print(site.getsitepackages()[0])")
   install -d "$pkgdir"/usr/share/licenses/$pkgname


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,5 +1,4 @@
 python
 python-build
+python-flit-core
 python-installer
-python-setuptools
-python-wheel

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,3 +1,7 @@
+prepare() {
+cd "$_name"-$pkgver
+sed -i '/^include =/,/]/d' pyproject.toml
+}
 build() {
 cd "$_name"-$pkgver
 python -m build --wheel --skip-dependency-check --no-isolation
