--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -2,24 +2,24 @@
 pkgbase=rust
 pkgname=(
   rust
+  lib32-rust-libs
   rust-musl
-  rust-src
-  rust-wasm
-
-  lib32-rust-libs
   rust-aarch64-gnu
   rust-aarch64-musl
-)
-pkgver=1.93.0
+  rust-wasm
+  rust-src
+)
+pkgver=1.92.0
 pkgrel=1
 epoch=1
 pkgdesc="Systems programming language focused on safety, speed and concurrency"
 url=https://www.rust-lang.org/
-arch=(
-  aarch64
-  x86_64
-)
+arch=(x86_64)
 license=("Apache-2.0 OR MIT")
+options=(
+  !emptydirs
+  !lto
+)
 depends=(
   bash
   compiler-rt
@@ -34,11 +34,16 @@
   zlib
 )
 makedepends=(
+  aarch64-linux-gnu-gcc
+  aarch64-linux-gnu-glibc
   clang
   cmake
+  lib32-gcc-libs
+  lib32-glibc
   libffi
   llvm
   musl
+  musl-aarch64
   ninja
   perl
   python
@@ -46,21 +51,10 @@
   wasi-libc
   wasm-component-ld
 )
-makedepends_x86_64=(
-  aarch64-linux-gnu-gcc
-  aarch64-linux-gnu-glibc
-  lib32-gcc-libs
-  lib32-glibc
-  musl-aarch64
-)
 checkdepends=(
   gdb
   procps-ng
 )
-options=(
-  !emptydirs
-  !lto
-)
 source=(
   "https://static.rust-lang.org/dist/rustc-$pkgver-src.tar.gz"{,.asc}
 
@@ -74,23 +68,19 @@
 
   0005-compiler-Use-ld.lld-by-default.patch
 
-  0006-compiler-Use-target-specific-GCC-linkers.patch
+  0006-compiler-Use-aarch64-linux-gnu-gcc-to-link-aarch64-t.patch
 
   0007-compiler-Swap-primary-and-secondary-lib-dirs.patch
 )
-source_aarch64=(bootstrap.aarch64.toml)
-source_x86_64=(bootstrap.x86_64.toml)
-b2sums=('ab35dfebfc8c9beb0b93fa564d7178da225f47591fb5de90566d59fb0dcf55a275f014c287805df3f901aba80374e92f5bdd93ac925585a869eed5dcd2571d48'
+b2sums=('9d8ad06c26a3996d2771c7011703f56858287b6450ee6bfc26378dd2c25994f6084fe52b1dc3e6867c4919887a2f5c7197e090269209ec225c594479b118fa93'
         'SKIP'
-        'f4a836270fb15b419f05db590c0f95f95c171addf85bf7324257690df29eac9139e53c0b73dd74b56921cc0c238e92bb0f3ba3b0969fac9c5cc90caf2cad0384'
-        '26edd385582537da6ef2c937aae70122fb6129bc18f43aca155bec010007da63d121a6aa07363c6d35bd7c6b8c799c1e0429d34787d4cc86125c5d176b5678cb'
-        'de6d1a7e4c1da3817cd0de12ec5570a71de14bd57b9233d87068338db8211c6fb099178ca7e73cf015cabec93b308a5949bbabdd34e51027c6a940b322c02d9d'
-        '00a637dde35e9df1e8852ea647fc9af043efb9c9adae8f2904dbf3692a2ab09ecbbd75147314d8a41802b5c68fce515247c8d21bc7ba28663e768ee9adbacd8d'
-        '29b134cd1ef57ae3a9c46985ec1221709def57472c28f1e737a3d4f27c105c4bc22d6cccc48c0f4a0677460277ce57c3a0d381368d99c8a1f4dd1bf7e7b41970'
-        '8015b14bd00f412c0935961fce5f9671fe3d51256a70eacbf61573c4c8ae35f3cd81372681fe406395ca571363e9f9a9c5b40969e79513f22d808e677a841ae7'
-        'b8e3d23c3a7617e231246465a264708789152abfc73203d901d64290701fabffff59d600fc8ecb1ec5d507313125d17c4040ec769474f4d58ea159d9cafc3910')
-b2sums_aarch64=('63ce33811457d6f271ea92ef0b3c2c0ae81d0c2cc8545273ad308237131c6eb1807d56e4de75037b525d19b6d405f9c5558665d85bd821a2d05ae40c1f9f2926')
-b2sums_x86_64=('b1808412ce71ec37b80bc44034e13fb4918577052b5cae0ee4809ffc499c7ccfeb01dfb8a1c49141a0b614861875680f80e6fff4add8c015a4c4becda3859e1e')
+        '5f42356ef9dc8071df9284d5adcce2cba37072684431c1dad8bbbe4b1b3d31f3bdd18b48252fc44e9d0aa39e33342936be3821106509d99183d88e0f53b4645f'
+        '06e3054314c80743c533f70b1d04ba47f9d4e04f94cf800b119bf33a6611b87c0732407328c390057973a3509ca0a0dbbfcecd9bc6d227968c33b18e8840b23c'
+        '9e0139640c87ca3c3a550ce95e80a36368e101b124b99cb2a30b7b594b60e921350d65556784e801500ea59135f79cb4faf07a091223032092173ec6eae3397b'
+        'effaaae130594ba2138aa150b7c509705a72aab8a4ab27ebc594ceee80ee790d6654d8cd3b7cd2ed28d2e69fb449928fff95538c9af007ec81869980e71b49f1'
+        'f122bd84206ef82b72a6a9af6210a661fe8a6705b353f6bafefe409aebaa3a9bb90b6533867ac44748faf502b5363f59b1e835cb5143f9a546bbc5af5f97c558'
+        '40e14ccc8b5dfff5d87f43a8763d1d2a49435c7a76633a920648a43dd25df0ab056107722ccdc574d9d603322699c6f3990878e19ab25d5e0117689d8f6b99b8'
+        'd80b9cfc4cbba2ad6800606bdf14183de990db33954b9ec63d393493ab77c82714a2069e20495a55c13c778d8ea052ccfbaa7d5b79716c494281c6b34e990137')
 validpgpkeys=(
   108F66205EAEB0AAA8DD5E1C85AB96E6FA1BE5FE  # Rust Language (Tag and Release Signing Key) <rust-key@rust-lang.org>
 )
@@ -112,9 +102,167 @@
 
   local clangdir
   clangdir="$(clang -print-resource-dir)"
-  sed -e "s|%description%|Arch Linux $pkgbase $epoch:$pkgver-$pkgrel|g" \
-      -e "s|%clangdir%|$clangdir|g" \
-      "$srcdir/bootstrap.${CARCH}.toml" > bootstrap.toml
+
+  cat >bootstrap.toml <<END
+profile = "dist"
+
+change-id = 147888
+
+[llvm]
+download-ci-llvm = false
+link-shared = true
+
+[build]
+description = "Artix Linux $pkgbase $epoch:$pkgver-$pkgrel"
+target = [
+  "x86_64-unknown-linux-gnu",
+  "i686-unknown-linux-gnu",
+  "x86_64-unknown-linux-musl",
+  "aarch64-unknown-linux-gnu",
+  "aarch64-unknown-linux-musl",
+  "wasm32-unknown-unknown",
+  "wasm32v1-none",
+  "wasm32-wasip1",
+  "wasm32-wasip1-threads",
+  "wasm32-wasip2",
+]
+cargo = "/usr/bin/cargo"
+rustc = "/usr/bin/rustc"
+rustfmt = "/usr/bin/rustfmt"
+locked-deps = true
+vendor = true
+tools = [
+  "cargo",
+  "clippy",
+  "rustdoc",
+  "rustfmt",
+  "rust-analyzer-proc-macro-srv",
+  "analysis",
+  "src",
+]
+sanitizers = true
+profiler = true
+
+docs = false
+
+[install]
+prefix = "/usr"
+
+[rust]
+codegen-units = 1
+codegen-units-std = 1
+debuginfo-level = 2
+debuginfo-level-std = 2
+channel = "stable"
+rpath = false
+frame-pointers = true
+lld = false
+bootstrap-override-lld = "external"
+llvm-bitcode-linker = false
+deny-warnings = false
+backtrace-on-ice = true
+remap-debuginfo = false
+lto = "fat"
+parallel-frontend-threads = 0
+
+[dist]
+compression-formats = ["gz"]
+compression-profile = "fast"
+
+[target.x86_64-unknown-linux-gnu]
+cc = "/usr/bin/gcc"
+cxx = "/usr/bin/g++"
+ar = "/usr/bin/gcc-ar"
+ranlib = "/usr/bin/gcc-ranlib"
+llvm-config = "/usr/bin/llvm-config"
+optimized-compiler-builtins = "$clangdir/lib/linux/libclang_rt.builtins-x86_64.a"
+
+[target.i686-unknown-linux-gnu]
+cc = "/usr/bin/gcc"
+cxx = "/usr/bin/g++"
+ar = "/usr/bin/gcc-ar"
+ranlib = "/usr/bin/gcc-ranlib"
+optimized-compiler-builtins = "$clangdir/lib/linux/libclang_rt.builtins-i386.a"
+
+[target.x86_64-unknown-linux-musl]
+cc = "/usr/bin/musl-gcc"
+cxx = "/usr/bin/g++"
+ar = "/usr/bin/gcc-ar"
+ranlib = "/usr/bin/gcc-ranlib"
+sanitizers = false
+musl-root = "/usr/lib/musl"
+
+[target.aarch64-unknown-linux-gnu]
+cc = "/usr/bin/aarch64-linux-gnu-gcc"
+cxx = "/usr/bin/aarch64-linux-gnu-g++"
+ar = "/usr/bin/aarch64-linux-gnu-gcc-ar"
+ranlib = "/usr/bin/aarch64-linux-gnu-gcc-ranlib"
+linker = "/usr/bin/aarch64-linux-gnu-gcc"
+default-linker = "aarch64-linux-gnu-gcc"
+
+[target.aarch64-unknown-linux-musl]
+cc = "/usr/aarch64-linux-musl/bin/musl-gcc"
+cxx = "/usr/bin/aarch64-linux-gnu-g++"
+ar = "/usr/bin/aarch64-linux-gnu-gcc-ar"
+ranlib = "/usr/bin/aarch64-linux-gnu-gcc-ranlib"
+linker = "/usr/bin/aarch64-linux-gnu-gcc"
+default-linker = "aarch64-linux-gnu-gcc"
+sanitizers = false
+musl-root = "/usr/aarch64-linux-musl/lib/musl"
+
+[target.wasm32-unknown-unknown]
+cc = "/usr/bin/clang"
+cxx = "/usr/bin/clang++"
+ar = "/usr/bin/llvm-ar"
+ranlib = "/usr/bin/llvm-ranlib"
+linker = "/usr/bin/wasm-ld"
+default-linker = "wasm-ld"
+sanitizers = false
+profiler = false
+
+[target.wasm32v1-none]
+cc = "/usr/bin/clang"
+cxx = "/usr/bin/clang++"
+ar = "/usr/bin/llvm-ar"
+ranlib = "/usr/bin/llvm-ranlib"
+linker = "/usr/bin/wasm-ld"
+default-linker = "wasm-ld"
+sanitizers = false
+profiler = false
+
+[target.wasm32-wasip1]
+cc = "/usr/bin/clang"
+cxx = "/usr/bin/clang++"
+ar = "/usr/bin/llvm-ar"
+ranlib = "/usr/bin/llvm-ranlib"
+linker = "/usr/bin/wasm-ld"
+default-linker = "wasm-ld"
+sanitizers = false
+profiler = false
+wasi-root = "/usr/share/wasi-sysroot"
+
+[target.wasm32-wasip1-threads]
+cc = "/usr/bin/clang"
+cxx = "/usr/bin/clang++"
+ar = "/usr/bin/llvm-ar"
+ranlib = "/usr/bin/llvm-ranlib"
+linker = "/usr/bin/wasm-ld"
+default-linker = "wasm-ld"
+sanitizers = false
+profiler = false
+wasi-root = "/usr/share/wasi-sysroot"
+
+[target.wasm32-wasip2]
+cc = "/usr/bin/clang"
+cxx = "/usr/bin/clang++"
+ar = "/usr/bin/llvm-ar"
+ranlib = "/usr/bin/llvm-ranlib"
+linker = "/usr/bin/wasm-ld"
+default-linker = "wasm-ld"
+sanitizers = false
+profiler = false
+wasi-root = "/usr/share/wasi-sysroot"
+END
 }
 
 _pick() {
@@ -152,27 +300,21 @@
     rmdir -p --ignore-fail-on-non-empty "$d"
   done
 
-  ln -srvft usr/lib usr/lib/rustlib/${CARCH}-unknown-linux-gnu/lib/*.so
-
-  mkdir -pv usr/lib/rustlib/${CARCH}-unknown-linux-gnu/bin/gcc-ld
-  ln -srvf  usr/bin/lld          usr/lib/rustlib/${CARCH}-unknown-linux-gnu/bin/rust-lld
-  ln -srvf  usr/bin/llvm-objcopy usr/lib/rustlib/${CARCH}-unknown-linux-gnu/bin/rust-objcopy
-  ln -srvft usr/lib/rustlib/${CARCH}-unknown-linux-gnu/bin/gcc-ld usr/bin/{ld.lld,ld64.lld,lld-link,wasm-ld}
-
-  _pick dest-musl usr/lib/rustlib/${CARCH}-unknown-linux-musl
+  mkdir -pv usr/lib32
+  ln -srvft usr/lib   usr/lib/rustlib/x86_64-unknown-linux-gnu/lib/*.so
+  ln -srvft usr/lib32 usr/lib/rustlib/i686-unknown-linux-gnu/lib/*.so
+
+  mkdir -pv usr/lib/rustlib/x86_64-unknown-linux-gnu/bin/gcc-ld
+  ln -srvf  usr/bin/lld          usr/lib/rustlib/x86_64-unknown-linux-gnu/bin/rust-lld
+  ln -srvf  usr/bin/llvm-objcopy usr/lib/rustlib/x86_64-unknown-linux-gnu/bin/rust-objcopy
+  ln -srvft usr/lib/rustlib/x86_64-unknown-linux-gnu/bin/gcc-ld usr/bin/{ld.lld,ld64.lld,lld-link,wasm-ld}
+
+  _pick dest-i686 usr/lib/rustlib/i686-unknown-linux-gnu usr/lib32
+  _pick dest-musl usr/lib/rustlib/x86_64-unknown-linux-musl
+  _pick dest-aarch64-gnu usr/lib/rustlib/aarch64-unknown-linux-gnu
+  _pick dest-aarch64-musl usr/lib/rustlib/aarch64-unknown-linux-musl
   _pick dest-wasm usr/lib/rustlib/wasm32{,v1}-*
   _pick dest-src  usr/lib/rustlib/src
-
-  if [[ $CARCH == x86_64 ]]; then
-    _pick dest-i686 usr/lib/rustlib/i686-unknown-linux-gnu
-    _pick dest-aarch64-gnu usr/lib/rustlib/aarch64-unknown-linux-gnu
-    _pick dest-aarch64-musl usr/lib/rustlib/aarch64-unknown-linux-musl
-  fi
-}
-
-_install_licenses() {
-  install -Dt "$pkgdir/usr/share/licenses/$pkgname" -m644 \
-    rustc-$pkgver-src/{COPYRIGHT,LICENSE-MIT}
 }
 
 package_rust() {
@@ -199,20 +341,58 @@
   cp -a dest-rust/* "$pkgdir"
 }
 
+package_lib32-rust-libs() {
+  pkgdesc="32-bit target and libraries for Rust"
+  depends=(
+    lib32-gcc-libs
+    lib32-glibc
+    rust
+  )
+  provides=(lib32-rust)
+  conflicts=(lib32-rust)
+  replaces=(lib32-rust)
+
+  cp -a dest-i686/* "$pkgdir"
+
+  install -Dt "$pkgdir/usr/share/licenses/$pkgname" -m644 \
+    rustc-$pkgver-src/{COPYRIGHT,LICENSE-MIT}
+}
+
 package_rust-musl() {
   pkgdesc="Musl target for Rust"
   depends=(rust)
 
   cp -a dest-musl/* "$pkgdir"
-  _install_licenses
-}
-
-package_rust-src() {
-  pkgdesc="Source code for the Rust standard library"
-  depends=(rust)
-
-  cp -a dest-src/* "$pkgdir"
-  _install_licenses
+
+  install -Dt "$pkgdir/usr/share/licenses/$pkgname" -m644 \
+    rustc-$pkgver-src/{COPYRIGHT,LICENSE-MIT}
+}
+
+package_rust-aarch64-gnu() {
+  pkgdesc="AArch64 GNU target for Rust"
+  depends=(
+    aarch64-linux-gnu-gcc
+    aarch64-linux-gnu-glibc
+    rust
+  )
+
+  cp -a dest-aarch64-gnu/* "$pkgdir"
+
+  install -Dt "$pkgdir/usr/share/licenses/$pkgname" -m644 \
+    rustc-$pkgver-src/{COPYRIGHT,LICENSE-MIT}
+}
+
+package_rust-aarch64-musl() {
+  pkgdesc="AArch64 Musl target for Rust"
+  depends=(
+    aarch64-linux-gnu-gcc
+    rust
+  )
+
+  cp -a dest-aarch64-musl/* "$pkgdir"
+
+  install -Dt "$pkgdir/usr/share/licenses/$pkgname" -m644 \
+    rustc-$pkgver-src/{COPYRIGHT,LICENSE-MIT}
 }
 
 package_rust-wasm() {
@@ -223,51 +403,18 @@
   )
 
   cp -a dest-wasm/* "$pkgdir"
-  _install_licenses
-}
-
-package_lib32-rust-libs() {
-  pkgdesc="32-bit target and libraries for Rust"
-  arch=(x86_64)
-  depends=(
-    lib32-gcc-libs
-    lib32-glibc
-    rust
-  )
-  provides=(lib32-rust)
-  conflicts=(lib32-rust)
-  replaces=(lib32-rust)
-
-  cp -a dest-i686/* "$pkgdir"
-  _install_licenses
-
-  cd "$pkgdir"
-  mkdir -pv usr/lib32
-  ln -srvft usr/lib32 usr/lib/rustlib/i686-unknown-linux-gnu/lib/*.so
-}
-
-package_rust-aarch64-gnu() {
-  pkgdesc="AArch64 GNU target for Rust"
-  arch=(x86_64)
-  depends=(
-    aarch64-linux-gnu-gcc
-    aarch64-linux-gnu-glibc
-    rust
-  )
-
-  cp -a dest-aarch64-gnu/* "$pkgdir"
-  _install_licenses
-}
-
-package_rust-aarch64-musl() {
-  pkgdesc="AArch64 Musl target for Rust"
-  arch=(x86_64)
-  depends=(
-    aarch64-linux-gnu-gcc
-    rust
-  )
-
-  cp -a dest-aarch64-musl/* "$pkgdir"
-  _install_licenses
-}
-
+
+  install -Dt "$pkgdir/usr/share/licenses/$pkgname" -m644 \
+    rustc-$pkgver-src/{COPYRIGHT,LICENSE-MIT}
+}
+
+package_rust-src() {
+  pkgdesc="Source code for the Rust standard library"
+  depends=(rust)
+
+  cp -a dest-src/* "$pkgdir"
+
+  install -Dt "$pkgdir/usr/share/licenses/$pkgname" -m644 \
+    rustc-$pkgver-src/{COPYRIGHT,LICENSE-MIT}
+}
+


############# Stripped diff below #################



--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -11,9 +11,149 @@
 done
 local clangdir
 clangdir="$(clang -print-resource-dir)"
-sed -e "s|%description%|Arch Linux $pkgbase $epoch:$pkgver-$pkgrel|g" \
--e "s|%clangdir%|$clangdir|g" \
-"$srcdir/bootstrap.${CARCH}.toml" > bootstrap.toml
+cat >bootstrap.toml <<END
+profile = "dist"
+change-id = 147888
+[llvm]
+download-ci-llvm = false
+link-shared = true
+[build]
+description = "Artix Linux $pkgbase $epoch:$pkgver-$pkgrel"
+target = [
+"x86_64-unknown-linux-gnu",
+"i686-unknown-linux-gnu",
+"x86_64-unknown-linux-musl",
+"aarch64-unknown-linux-gnu",
+"aarch64-unknown-linux-musl",
+"wasm32-unknown-unknown",
+"wasm32v1-none",
+"wasm32-wasip1",
+"wasm32-wasip1-threads",
+"wasm32-wasip2",
+]
+cargo = "/usr/bin/cargo"
+rustc = "/usr/bin/rustc"
+rustfmt = "/usr/bin/rustfmt"
+locked-deps = true
+vendor = true
+tools = [
+"cargo",
+"clippy",
+"rustdoc",
+"rustfmt",
+"rust-analyzer-proc-macro-srv",
+"analysis",
+"src",
+]
+sanitizers = true
+profiler = true
+docs = false
+[install]
+prefix = "/usr"
+[rust]
+codegen-units = 1
+codegen-units-std = 1
+debuginfo-level = 2
+debuginfo-level-std = 2
+channel = "stable"
+rpath = false
+frame-pointers = true
+lld = false
+bootstrap-override-lld = "external"
+llvm-bitcode-linker = false
+deny-warnings = false
+backtrace-on-ice = true
+remap-debuginfo = false
+lto = "fat"
+parallel-frontend-threads = 0
+[dist]
+compression-formats = ["gz"]
+compression-profile = "fast"
+[target.x86_64-unknown-linux-gnu]
+cc = "/usr/bin/gcc"
+cxx = "/usr/bin/g++"
+ar = "/usr/bin/gcc-ar"
+ranlib = "/usr/bin/gcc-ranlib"
+llvm-config = "/usr/bin/llvm-config"
+optimized-compiler-builtins = "$clangdir/lib/linux/libclang_rt.builtins-x86_64.a"
+[target.i686-unknown-linux-gnu]
+cc = "/usr/bin/gcc"
+cxx = "/usr/bin/g++"
+ar = "/usr/bin/gcc-ar"
+ranlib = "/usr/bin/gcc-ranlib"
+optimized-compiler-builtins = "$clangdir/lib/linux/libclang_rt.builtins-i386.a"
+[target.x86_64-unknown-linux-musl]
+cc = "/usr/bin/musl-gcc"
+cxx = "/usr/bin/g++"
+ar = "/usr/bin/gcc-ar"
+ranlib = "/usr/bin/gcc-ranlib"
+sanitizers = false
+musl-root = "/usr/lib/musl"
+[target.aarch64-unknown-linux-gnu]
+cc = "/usr/bin/aarch64-linux-gnu-gcc"
+cxx = "/usr/bin/aarch64-linux-gnu-g++"
+ar = "/usr/bin/aarch64-linux-gnu-gcc-ar"
+ranlib = "/usr/bin/aarch64-linux-gnu-gcc-ranlib"
+linker = "/usr/bin/aarch64-linux-gnu-gcc"
+default-linker = "aarch64-linux-gnu-gcc"
+[target.aarch64-unknown-linux-musl]
+cc = "/usr/aarch64-linux-musl/bin/musl-gcc"
+cxx = "/usr/bin/aarch64-linux-gnu-g++"
+ar = "/usr/bin/aarch64-linux-gnu-gcc-ar"
+ranlib = "/usr/bin/aarch64-linux-gnu-gcc-ranlib"
+linker = "/usr/bin/aarch64-linux-gnu-gcc"
+default-linker = "aarch64-linux-gnu-gcc"
+sanitizers = false
+musl-root = "/usr/aarch64-linux-musl/lib/musl"
+[target.wasm32-unknown-unknown]
+cc = "/usr/bin/clang"
+cxx = "/usr/bin/clang++"
+ar = "/usr/bin/llvm-ar"
+ranlib = "/usr/bin/llvm-ranlib"
+linker = "/usr/bin/wasm-ld"
+default-linker = "wasm-ld"
+sanitizers = false
+profiler = false
+[target.wasm32v1-none]
+cc = "/usr/bin/clang"
+cxx = "/usr/bin/clang++"
+ar = "/usr/bin/llvm-ar"
+ranlib = "/usr/bin/llvm-ranlib"
+linker = "/usr/bin/wasm-ld"
+default-linker = "wasm-ld"
+sanitizers = false
+profiler = false
+[target.wasm32-wasip1]
+cc = "/usr/bin/clang"
+cxx = "/usr/bin/clang++"
+ar = "/usr/bin/llvm-ar"
+ranlib = "/usr/bin/llvm-ranlib"
+linker = "/usr/bin/wasm-ld"
+default-linker = "wasm-ld"
+sanitizers = false
+profiler = false
+wasi-root = "/usr/share/wasi-sysroot"
+[target.wasm32-wasip1-threads]
+cc = "/usr/bin/clang"
+cxx = "/usr/bin/clang++"
+ar = "/usr/bin/llvm-ar"
+ranlib = "/usr/bin/llvm-ranlib"
+linker = "/usr/bin/wasm-ld"
+default-linker = "wasm-ld"
+sanitizers = false
+profiler = false
+wasi-root = "/usr/share/wasi-sysroot"
+[target.wasm32-wasip2]
+cc = "/usr/bin/clang"
+cxx = "/usr/bin/clang++"
+ar = "/usr/bin/llvm-ar"
+ranlib = "/usr/bin/llvm-ranlib"
+linker = "/usr/bin/wasm-ld"
+default-linker = "wasm-ld"
+sanitizers = false
+profiler = false
+wasi-root = "/usr/share/wasi-sysroot"
+END
 }
 build() {
 cd rustc-$pkgver-src
@@ -34,17 +174,17 @@
 esac
 rmdir -p --ignore-fail-on-non-empty "$d"
 done
-ln -srvft usr/lib usr/lib/rustlib/${CARCH}-unknown-linux-gnu/lib/*.so
-mkdir -pv usr/lib/rustlib/${CARCH}-unknown-linux-gnu/bin/gcc-ld
-ln -srvf  usr/bin/lld          usr/lib/rustlib/${CARCH}-unknown-linux-gnu/bin/rust-lld
-ln -srvf  usr/bin/llvm-objcopy usr/lib/rustlib/${CARCH}-unknown-linux-gnu/bin/rust-objcopy
-ln -srvft usr/lib/rustlib/${CARCH}-unknown-linux-gnu/bin/gcc-ld usr/bin/{ld.lld,ld64.lld,lld-link,wasm-ld}
-_pick dest-musl usr/lib/rustlib/${CARCH}-unknown-linux-musl
+mkdir -pv usr/lib32
+ln -srvft usr/lib   usr/lib/rustlib/x86_64-unknown-linux-gnu/lib/*.so
+ln -srvft usr/lib32 usr/lib/rustlib/i686-unknown-linux-gnu/lib/*.so
+mkdir -pv usr/lib/rustlib/x86_64-unknown-linux-gnu/bin/gcc-ld
+ln -srvf  usr/bin/lld          usr/lib/rustlib/x86_64-unknown-linux-gnu/bin/rust-lld
+ln -srvf  usr/bin/llvm-objcopy usr/lib/rustlib/x86_64-unknown-linux-gnu/bin/rust-objcopy
+ln -srvft usr/lib/rustlib/x86_64-unknown-linux-gnu/bin/gcc-ld usr/bin/{ld.lld,ld64.lld,lld-link,wasm-ld}
+_pick dest-i686 usr/lib/rustlib/i686-unknown-linux-gnu usr/lib32
+_pick dest-musl usr/lib/rustlib/x86_64-unknown-linux-musl
+_pick dest-aarch64-gnu usr/lib/rustlib/aarch64-unknown-linux-gnu
+_pick dest-aarch64-musl usr/lib/rustlib/aarch64-unknown-linux-musl
 _pick dest-wasm usr/lib/rustlib/wasm32{,v1}-*
 _pick dest-src  usr/lib/rustlib/src
-if [[ $CARCH == x86_64 ]]; then
-_pick dest-i686 usr/lib/rustlib/i686-unknown-linux-gnu
-_pick dest-aarch64-gnu usr/lib/rustlib/aarch64-unknown-linux-gnu
-_pick dest-aarch64-musl usr/lib/rustlib/aarch64-unknown-linux-musl
-fi
 }
