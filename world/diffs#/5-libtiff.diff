--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,34 +1,15 @@
 
 pkgname=libtiff
 pkgver=4.7.0
-pkgrel=2
+pkgrel=1
 pkgdesc='Library for manipulation of TIFF images'
 url='http://www.simplesystems.org/libtiff/'
-arch=(x86_64)
-license=(libtiff)
-depends=(
-  gcc-libs
-  glibc
-  jbigkit
-  libdeflate
-  libjpeg-turbo
-  libjpeg.so
-  libwebp
-  xz
-  zlib
-  zstd
-)
-makedepends=(
-  cmake
-  freeglut
-  git
-  glu
-  mesa
-)
-optdepends=(
-  'freeglut: for using tiffgt'
-)
-provides=(libtiff.so libtiffxx.so)
+arch=('x86_64')
+license=('custom')
+depends=('gcc-libs' 'glibc' 'jbigkit' 'libjpeg-turbo' 'libjpeg.so' 'zlib' 'xz' 'zstd')
+makedepends=('freeglut' 'git' 'glu' 'mesa')
+optdepends=('freeglut: for using tiffgt')
+provides=('libtiff.so' 'libtiffxx.so')
 source=("git+https://gitlab.com/libtiff/libtiff.git?signed#tag=v${pkgver}")
 sha256sums=('5db48dfd7c67c67df49868fc68a99be7544f1c60306b5bfc70bbe207661b1776')
 b2sums=('15c36e609a96fe58ffb6123d0f99dbed22e3af532e1b2f72347b3fb37932437d85ae2e7489edb67553e3339da3742693abe2d38dcc3d8fe3c3a6df9be38ca948')
@@ -37,21 +18,34 @@
   'B1FA7D81EEB8E66399178B9733EBBFC47B3DD87D' # Even Rouault <even.rouault@spatialys.com>
 )
 
+prepare() {
+  cd libtiff
+  autoreconf -fiv
+}
+
 build() {
-  cmake -B build -S $pkgname \
-  -DCMAKE_INSTALL_PREFIX=/usr \
-  -DCMAKE_BUILD_TYPE=None \
-  -DCMAKE_POLICY_VERSION_MINIMUM=3.5
+  local configure_options=(
+    --prefix=/usr
+    --sysconfdir=/etc
+    --enable-ld-version-script
+    --mandir=/usr/share/man
+    --with-docdir=/usr/share/doc/${pkgname}
+  )
 
-  cmake --build build
+  cd libtiff
+  ./configure "${configure_options[@]}"
+  sed -i -e 's/ -shared / -Wl,-O1,--as-needed\0/g' libtool
+  make
 }
 
 check() {
-  ctest --test-dir build
+  cd libtiff
+  make check
 }
 
 package() {
-  DESTDIR="${pkgdir}" cmake --install build
-  install -Dm 644 libtiff/LICENSE.md -t "${pkgdir}/usr/share/licenses/${pkgname}/"
+  cd libtiff
+  make DESTDIR="${pkgdir}" install
+  install -Dm 644 LICENSE.md -t "${pkgdir}/usr/share/licenses/${pkgname}/"
 }
 


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,14 +1,11 @@
-cmake
 freeglut
 gcc-libs
 git
 glibc
 glu
 jbigkit
-libdeflate
 libjpeg-turbo
 libjpeg.so
-libwebp
 mesa
 xz
 zlib

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,7 +1,17 @@
+prepare() {
+cd libtiff
+autoreconf -fiv
+}
 build() {
-cmake -B build -S $pkgname \
--DCMAKE_INSTALL_PREFIX=/usr \
--DCMAKE_BUILD_TYPE=None \
--DCMAKE_POLICY_VERSION_MINIMUM=3.5
-cmake --build build
+local configure_options=(
+--prefix=/usr
+--sysconfdir=/etc
+--enable-ld-version-script
+--mandir=/usr/share/man
+--with-docdir=/usr/share/doc/${pkgname}
+)
+cd libtiff
+./configure "${configure_options[@]}"
+sed -i -e 's/ -shared / -Wl,-O1,--as-needed\0/g' libtool
+make
 }
