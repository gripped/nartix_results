--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -2,7 +2,7 @@
 pkgbase=lv2
 pkgname=(lv2 lv2-docs lv2-example-plugins)
 pkgver=1.18.10
-pkgrel=2
+pkgrel=1
 pkgdesc="Plugin standard for audio systems"
 arch=(x86_64)
 url="https://lv2plug.in/"
@@ -12,6 +12,9 @@
   codespell
   doxygen
   flake8
+  gtk2
+  libsamplerate
+  libsndfile
   meson
   pygmentize
   python-black
@@ -23,6 +26,7 @@
   serd
   sord
 )
+options=(debug)
 source=(https://lv2plug.in/spec/$pkgbase-$pkgver.tar.xz{,.sig})
 sha512sums=('ab4bcf593f633b1ed16c0eb6aa4525458a00655ef9c87619bf85eaa966f8fd094a8e871b825f679e0d97923f8bbbf11841ff467022390ca2f1a5b5f66ccd5d1b'
             'SKIP')
@@ -40,19 +44,13 @@
   done
 }
 
-prepare() {
-  cd $pkgbase-$pkgver
-
-  sed -i -e '/eg-sampler.lv2/d' -e '/eg-scope.lv2/d' plugins/meson.build
-}
-
 build() {
-  arch-meson $pkgbase-$pkgver build
+  artix-meson $pkgbase-$pkgver build
   meson compile -C build
 }
 
 check() {
-  meson test -C build || : # syntax and codespell tests fail
+  meson test -C build
 }
 
 package_lv2() {
@@ -87,7 +85,10 @@
 
 package_lv2-example-plugins() {
   pkgdesc+=" - example plugins"
-  depends=(lv2-host)
+  depends=(libsamplerate libsndfile lv2-host)
+  optdepends=(
+    'gtk2: for eg-sampler.lv2 and eg-scope.lv2'
+  )
   groups=(lv2-plugins pro-audio)
 
   mv -v $pkgname/* "$pkgdir"


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -2,6 +2,9 @@
 codespell
 doxygen
 flake8
+gtk2
+libsamplerate
+libsndfile
 lv2-host
 meson
 pygmentize

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,8 +1,4 @@
-prepare() {
-cd $pkgbase-$pkgver
-sed -i -e '/eg-sampler.lv2/d' -e '/eg-scope.lv2/d' plugins/meson.build
-}
 build() {
-arch-meson $pkgbase-$pkgver build
+artix-meson $pkgbase-$pkgver build
 meson compile -C build
 }
