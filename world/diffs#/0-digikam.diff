--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,7 +1,8 @@
 
 pkgname=digikam
-pkgver=8.8.0
-pkgrel=2
+_pkgver=8.7.0
+pkgver=${_pkgver//-/} # for beta versions
+pkgrel=4
 pkgdesc='An advanced digital photo management application'
 arch=(x86_64)
 license=(GPL-2.0-or-later)
@@ -67,25 +68,29 @@
             'hugin: panorama tool'
             'qt6-imageformats: support for additional image formats (WEBP, TIFF)'
             'rawtherapee: RAW import')
-source=(https://download.kde.org/stable/$pkgname/${pkgver%-*}/digiKam-$pkgver.tar.xz{,.sig})
-sha256sums=('db3a1b6e3c73f903e3dff8003f52455dd2ecd198cb66534fee4abbd0bdeb6b9a'
-            'SKIP')
+source=(https://download.kde.org/stable/$pkgname/${_pkgver%-*}/digiKam-$_pkgver.tar.xz{,.sig}
+        afe5772b-2.patch::https://invent.kde.org/graphics/digikam/-/commit/afe5772b.patch
+        https://invent.kde.org/graphics/digikam/-/commit/b9a5754b.patch)
+sha256sums=('79e35ec20a43934cf8322d47c9c0540b0b8b727fa7d9aceb90f710fcfe9da02f'
+            'SKIP'
+            '65bc3d2bc3ac541f595aa4d41b4d9c4b745b302a65bc3ded30a53463bf428eed'
+            '45fd24b1b46f968fb10a205e9d09d1cec65eb7b07393fd0fecbcc70f5d7da4fe')
 validpgpkeys=(D1CF2444A7858C5F2FB095B74A77747BC2386E50) # digiKam.org (digiKam project) <digikamdeveloper@gmail.com>
 
 prepare() {
-  rm $pkgname-$pkgver/core/cmake/modules/FindEigen3.cmake # Fix build with Eigen 5
+  patch -d $pkgname-$_pkgver -p1 < afe5772b-2.patch # Fix face recognition with openCV 4.12
+  patch -d $pkgname-$_pkgver -p1 < b9a5754b.patch # Fix build with Qt 6.9.2
 }
 
 build() {
-  cmake -B build -S $pkgname-$pkgver \
+  cmake -B build -S $pkgname-$_pkgver \
     -DBUILD_TESTING=OFF \
     -DBUILD_WITH_QT6=ON \
     -DENABLE_KFILEMETADATASUPPORT=ON \
     -DENABLE_MEDIAPLAYER=ON \
     -DENABLE_AKONADICONTACTSUPPORT=ON \
     -DENABLE_MYSQLSUPPORT=ON \
-    -DENABLE_APPSTYLES=ON \
-    -DEIGEN3_INCLUDE_DIR=/usr/include/eigen3
+    -DENABLE_APPSTYLES=ON
   cmake --build build
 }
 


############# Stripped diff below #################



--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,15 +1,15 @@
 prepare() {
-rm $pkgname-$pkgver/core/cmake/modules/FindEigen3.cmake # Fix build with Eigen 5
+patch -d $pkgname-$_pkgver -p1 < afe5772b-2.patch # Fix face recognition with openCV 4.12
+patch -d $pkgname-$_pkgver -p1 < b9a5754b.patch # Fix build with Qt 6.9.2
 }
 build() {
-cmake -B build -S $pkgname-$pkgver \
+cmake -B build -S $pkgname-$_pkgver \
 -DBUILD_TESTING=OFF \
 -DBUILD_WITH_QT6=ON \
 -DENABLE_KFILEMETADATASUPPORT=ON \
 -DENABLE_MEDIAPLAYER=ON \
 -DENABLE_AKONADICONTACTSUPPORT=ON \
 -DENABLE_MYSQLSUPPORT=ON \
--DENABLE_APPSTYLES=ON \
--DEIGEN3_INCLUDE_DIR=/usr/include/eigen3
+-DENABLE_APPSTYLES=ON
 cmake --build build
 }
