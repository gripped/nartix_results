--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,7 +1,7 @@
 
 pkgname=cloud-init
-pkgver=24.2
-pkgrel=1
+pkgver=24.1
+pkgrel=2
 pkgdesc="Cloud instance initialization"
 arch=(any)
 url="https://cloud-init.io"
@@ -21,10 +21,8 @@
   python-requests
   python-typing_extensions
   sudo
-  systemd
 )
 makedepends=(
-  netplan
   python-build
   python-installer
   python-setuptools
@@ -40,7 +38,6 @@
 )
 optdepends=(
   'cloud-guest-utils: for growpart'
-  'netplan: for configuring network using netplan'
   'python-passlib: for Azure and BSD support'
   'python-urllib3: for LXD and Scaleway data sources'
 )
@@ -50,20 +47,13 @@
 )
 source=(
   https://github.com/canonical/cloud-init/archive/$pkgver/$pkgname-$pkgver.tar.gz
-  $pkgname-24.2-Fix-btrfs-version-check-for-btrfs-6.10.patch
 )
-sha512sums=('2257de8c23f3a94324a7fe9e2105e6343ffe11cc86b27a68c7447b6e386a951bf2643988f3d26371420e3702a0b568107bb343d000ecae80d5e229b5a023513d'
-            'a92d1db1b73eae2a98e2a8fd6e8bdbaeba8f9ffdf2762f9c1cd43730da090317c41061295204392c440ed8b80a1f8746a8250ad4805bf7e0eab6b19fdd92de0a')
-b2sums=('19f1dd16aa673b4fdc0a8368fbf490773195f765834b89409c0fda6f6fb897c18a5632cdbd4c4cac85373fba31e0de279ce86ca6253686bc0e7eac19e8adf4f8'
-        'df454ed55e3f3f9d4a71e4f362ab59c125eb64c6e173e7b98a7a0e9c6be07a95c55a40c18288c732bf530a8ee4c29e405467ddd060d0474bf97feefe9d02a519')
-
-prepare() {
-  patch -Np1 -d $pkgname-$pkgver -i ../$pkgname-24.2-Fix-btrfs-version-check-for-btrfs-6.10.patch
-}
+sha512sums=('216a824b341947189dbb252e549525bf7001c55778d9a51dde328ae4fd17da041e11813963ffedbb765245202a1e7a05ddc39350cdd8dc8e3bfb70b432b3ea5e')
+b2sums=('cdc55e9fa7c79e686aa6ac62c59bce8d243093eef90e4ef58f1cfaeae28939518c828ed688c41598216ea3614c77abea2568621240a64a4a7f1a3886ab361e8a')
 
 build() {
   cd $pkgname-$pkgver
-  python -m build --wheel --no-isolation -C--distro=arch -C--prefix=/usr
+  python -m build --wheel --no-isolation -C--distro=arch -C--prefix=/usr -C--init-system=sysvinit_openrc
 }
 
 check() {
@@ -72,9 +62,10 @@
     --deselect tests/unittests/config/test_cc_ca_certs.py::TestRemoveDefaultCaCerts::test_commands
     --deselect tests/unittests/test_ds_identify.py::TestWSL::test_empty_cloudinitdir
     --deselect tests/unittests/test_ds_identify.py::TestWSL::test_found_via_userdata
-    --deselect tests/unittests/config/test_schema.py::TestNetplanValidateNetworkSchema::test_network_config_schema_validation_false_when_skipped
-    --deselect 'tests/unittests/config/test_schema.py::TestNetworkSchema::test_network_schema[net_v2_complex_example]'
-    --deselect 'tests/unittests/config/test_schema.py::TestNetworkSchema::test_network_schema[net_v2_invalid_config]'
+    --deselect 'tests/unittests/config/test_schema.py::TestNetplanValidateNetworkSchema::test_network_config_schema_validation_false_when_skipped[config0-]'
+    --deselect 'tests/unittests/config/test_schema.py::TestNetplanValidateNetworkSchema::test_network_config_schema_validation_false_when_skipped[config1-]'
+    --deselect 'tests/unittests/config/test_schema.py::TestNetplanValidateNetworkSchema::test_network_config_schema_validation_false_when_skipped[config2-Skipping netplan schema validation. No netplan available]'
+    --deselect 'tests/unittests/config/test_schema.py::TestNetplanValidateNetworkSchema::test_network_config_schema_validation_false_when_skipped[config3-Skipping netplan schema validation. No netplan available]'
     --deselect 'tests/unittests/config/test_schema.py::TestNetworkSchema::test_network_schema[net_v2_skipped]'
   )
   cd $pkgname-$pkgver
@@ -99,12 +90,4 @@
   install -vDm 644 doc/man/*.1 -t "$pkgdir/usr/share/man/man1/"
   install -vDm 655 bash_completion/$pkgname -t "$pkgdir/usr/share/bash-completion/completions/"
   install -vDm 644 udev/*.rules -t "$pkgdir/usr/lib/udev/rules.d/"
-  install -vdm 755 "$pkgdir/usr/lib/systemd/system"{,-generators}
-  for _file in cloud-{config,final,init-local,init}.service; do
-    ./tools/render-template --variant arch ./systemd/$_file.tmpl "$pkgdir/usr/lib/systemd/system/$_file"
-  done
-  install -vDm 644 systemd/*.{service,socket,target} "$pkgdir/usr/lib/systemd/system/"
-  ./tools/render-template --variant arch ./systemd/cloud-init-generator.tmpl "$pkgdir/usr/lib/systemd/system-generators/cloud-init-generator"
-  chmod 755 "$pkgdir/usr/lib/systemd/system-generators/cloud-init-generator"
-  install -vDm 644 systemd/disable-sshd-keygen-if-cloud-init-active.conf -t "$pkgdir/usr/lib/systemd/system/sshd-keygen@.service.d/"
 }


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,6 +1,5 @@
 bash
 dhclient
-netplan
 python
 python-build
 python-configobj
@@ -17,4 +16,3 @@
 python-typing_extensions
 python-wheel
 sudo
-systemd