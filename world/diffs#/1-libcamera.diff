--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -8,8 +8,8 @@
   gst-plugin-libcamera
   python-libcamera
 )
-pkgver=0.5.2
-pkgrel=1
+pkgver=0.5.1
+pkgrel=2
 pkgdesc="A complex camera support library for Linux, Android, and ChromeOS"
 arch=(x86_64)
 url="https://libcamera.org/"
@@ -33,16 +33,17 @@
   python-ply
   python-pyyaml
   python-sphinx
-  python-sphinxcontrib-doxylink
   qt6-base
   qt6-tools
   sdl2
-  systemd
+  udev
   texlive-core
 )
-source=("git+$_url#tag=v$pkgver")
-sha512sums=('4d9688e2587854cd7bd4b98cb53b4f5c89dab588c793523f0d3d41cdb7f884dca5490dd72eb78aeee838bc33a2db6db580409d4835841e8c123e3edf1fa7bf78')
-b2sums=('749b620a993140ac3ce4d7c1808d588f65a99592f03247cff117d3949d3a169650d7f763fb4f67eb296c95f8f663daf7b3fedca1e2c8c48345b2733d54d8cfb2')
+source=(
+  "git+$_url#tag=v$pkgver"
+)
+sha512sums=('12a3e04860b24fdc34526431f2c4d5c941cb87754b0ed09dab6390c37eaaefa54de85c4ef1eae2e1daf79be5fb8e6dd00626f505884a047d751d8d8e44d622ca')
+b2sums=('4cb0c84f7e051468a1e36aa9ab6b82b89dd0fcdf02145a45647cb9189b4eabd6f1660c79acba0e28c28825cff7e298f9e2f115e555ce7ee987327cf339505dda')
 
 _pick() {
   local p="$1" f d; shift
@@ -54,10 +55,17 @@
   done
 }
 
+pkgver() {
+  cd $pkgbase
+  git describe --tags | sed 's/\([^-]*-g\)/r\1/;s/-/./g;s/v//g'
+}
+
 prepare() {
   cd $pkgbase
 
   printf "%s\n" "$pkgver" > .tarball-version
+
+  git cherry-pick -n 1ea124c7a3de5cb1289ec6416f957f7da5f0c1c1
 }
 
 build() {
@@ -67,19 +75,10 @@
     -D test=true
   )
 
-  arch-meson $pkgbase build "${meson_options[@]}"
+  artix-meson $pkgbase build "${meson_options[@]}"
   meson compile -C build
 }
 
-check() {
-  local tests=$(
-    meson test -C build --list | awk '{print $3}' \
-      | grep -v single_stream_test \
-      | grep -v multi_stream_test \
-      | grep -v memory_lifetime_test \
-  )
-  meson test -C build ${tests[@]}
-}
 
 package_libcamera() {
   license=(
@@ -101,7 +100,7 @@
     libyaml
     libyuv
     sh
-    systemd-libs libudev.so
+    libudev libudev.so
   )
   optdepends=(
     'gst-plugin-libcamera: GStreamer plugin'


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -25,6 +25,7 @@
 libjpeg.so
 libtiff
 libtiff.so
+libudev
 libudev.so
 libunwind
 libyaml
@@ -36,11 +37,9 @@
 python-ply
 python-pyyaml
 python-sphinx
-python-sphinxcontrib-doxylink
 qt6-base
 qt6-tools
 sdl2
 sh
-systemd
-systemd-libs
 texlive-core
+udev