--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,7 +1,7 @@
 
 pkgname=ruby-protocol-http1
-pkgver=0.34.0
-pkgrel=2
+pkgver=0.30.0
+pkgrel=1
 pkgdesc='A low level implementation of the HTTP/1 protocol'
 arch=(any)
 url='https://github.com/socketry/protocol-http1'
@@ -14,7 +14,7 @@
   ruby-rdoc
 )
 checkdepends=(
-  ruby-bake
+  ruby-bake-modernize
   ruby-bake-test
   ruby-bake-test-external
   ruby-bundler
@@ -24,21 +24,20 @@
 )
 options=(!emptydirs)
 source=(https://github.com/socketry/protocol-http1/archive/v$pkgver/$pkgname-$pkgver.tar.gz)
-sha512sums=('7a79ce7c7d2589b74147223c2bd246cecd21976904b8dc65202b7aeeb2aed0a6297fc7f74109544f52a8c4b1b8fa911f336ea400bb56a94615d2bbfcd97e0481')
-b2sums=('24d9a8aa2482eb6e8aff5d221db2c03282b9ae30aaa087cc142e1905b28b13b4739c2fe83f6ed98d908aa54941bda97cd9f2c79b58976853701224f5f7235218')
+sha512sums=('44168c223c92fb2fca30ae07bceb01c153efb45769ec535b2d9ee0de2d87891b5f82dd501ba83dc4d989a91dd204a9eda8c0670168b9411b79cf49abb54f4610')
+b2sums=('c0593782f42cc315ad8e662d3e30a8bed3545674d925389c06351d3fa5b61e8798491356adbcaf8165815d26e8293acc5e9ccf7d614dad81c0c15414233aeb19')
 
 prepare() {
   cd protocol-http1-$pkgver
 
-  sed -i -r \
+  sed -r \
     -e 's|~>|>=|g' \
     -e '/signing_key/d' \
-    protocol-http1.gemspec \
-    gems.rb
+    -i protocol-http1.gemspec
 
-  sed --in-place \
-    --expression '/group :maintenance/,/end/d' \
-    --expression '/rubocop/d' \
+  sed -i \
+    -e '/bake-gem/d;/bake-github-pages/d;/utopia-project/d;s/gem "stringio".*$/gem "stringio"/' \
+    -e '/rubocop/d' \
     gems.rb
 }
 


############# Stripped diff below #################



--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,13 +1,12 @@
 prepare() {
 cd protocol-http1-$pkgver
-sed -i -r \
+sed -r \
 -e 's|~>|>=|g' \
 -e '/signing_key/d' \
-protocol-http1.gemspec \
-gems.rb
-sed --in-place \
---expression '/group :maintenance/,/end/d' \
---expression '/rubocop/d' \
+-i protocol-http1.gemspec
+sed -i \
+-e '/bake-gem/d;/bake-github-pages/d;/utopia-project/d;s/gem "stringio".*$/gem "stringio"/' \
+-e '/rubocop/d' \
 gems.rb
 }
 build() {
