--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,65 +1,31 @@
 
 pkgname=mongo-c-driver
-pkgver=1.28.0
+pkgver=1.27.1
 pkgrel=1
-pkgdesc="A client library written in C for MongoDB"
-arch=(x86_64)
-url="https://www.mongodb.org/display/DOCS/C+Language+Center"
-license=(Apache-2.0)
-depends=(
-  glibc
-  libsasl
-  openssl
-  snappy
-  zstd
-)
-makedepends=(cmake)
-provides=(
-  libbson
-  libbson-1.0.so
-  libmongoc
-  libmongoc-1.0.so
-)
-conflicts=(
-  libbson
-  libmongoc
-)
-replaces=(
-  libbson
-  libmongoc
-)
+pkgdesc='A client library written in C for MongoDB'
+arch=('x86_64')
+url='https://www.mongodb.org/display/DOCS/C+Language+Center'
+license=('Apache')
+depends=('libsasl' 'snappy' 'zstd')
+makedepends=('cmake')
+provides=('libbson' 'libmongoc')
+conflicts=('libbson' 'libmongoc')
+replaces=('libbson' 'libmongoc')
 source=("https://github.com/mongodb/mongo-c-driver/archive/$pkgver/$pkgname-$pkgver.tar.gz")
-sha256sums=('fc8ef2d081d9388b9016d74826f4a229d213a2813708d26063d771ab12e457cb')
+sha512sums=('642264ec4358eb2de76b5dc0d7534c8751df980fc7fe21a010a44e4a7799a351ec6a8ed46fba54a6029b5d5e8c82df055a1a0eb01f23c1247a91bab8d6a5b306')
 
 build() {
-  cd $pkgname-$pkgver
-  cmake -S . -B build \
-    -DCMAKE_BUILD_TYPE=None \
+  cmake -B build -S mongo-c-driver-$pkgver \
     -DCMAKE_INSTALL_PREFIX=/usr \
-    -Wno-dev \
     -DBUILD_VERSION="$pkgver" \
-    -DENABLE_STATIC=ON \
-    -DENABLE_TESTS=ON
+    -DENABLE_STATIC=OFF -DENABLE_TESTS=OFF
   cmake --build build
 }
 
 check() {
-  cd $pkgname-$pkgver
-  cmake --build build --target check
-  export MONGOC_TEST_OFFLINE=ON
-  export MONGOC_TEST_SKIP_LIVE=ON
-  local skip_tests=(
-    mongoc/ClientPool/openssl/change_ssl_opts
-    mongoc/MongoDB/handshake/null_args
-    mongoc/TOPOLOGY/scanner_ssl
-    mongoc/azure/imds/http/talk
-    mongoc/gcp/http/talk
-  )
-  local skip_tests_pattern="${skip_tests[0]}$(printf '|%s' "${skip_tests[@]:1}")"
-  ctest --test-dir build --output-on-failure -E "$skip_tests_pattern"
+  cd build
 }
 
 package() {
-  cd $pkgname-$pkgver
-  DESTDIR="$pkgdir" cmake --install build
+  DESTDIR="$pkgdir/" cmake --install build
 }


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,6 +1,4 @@
 cmake
-glibc
 libsasl
-openssl
 snappy
 zstd

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,11 +1,7 @@
 build() {
-cd $pkgname-$pkgver
-cmake -S . -B build \
--DCMAKE_BUILD_TYPE=None \
+cmake -B build -S mongo-c-driver-$pkgver \
 -DCMAKE_INSTALL_PREFIX=/usr \
--Wno-dev \
 -DBUILD_VERSION="$pkgver" \
--DENABLE_STATIC=ON \
--DENABLE_TESTS=ON
+-DENABLE_STATIC=OFF -DENABLE_TESTS=OFF
 cmake --build build
 }
