--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,16 +1,15 @@
 
 pkgname=bind
 pkgver=9.20.3
-pkgrel=2
+pkgrel=1
 pkgdesc='A complete, highly portable implementation of the DNS protocol'
 url='https://www.isc.org/software/bind/'
 license=('MPL2')
 arch=('x86_64')
 options=('!emptydirs')
-depends=('bash' 'dnssec-anchors' 'e2fsprogs' 'glibc' 'icu' 'libedit' 'json-c'
+depends=('esysusers' 'etmpfiles' 'bash' 'dnssec-anchors' 'e2fsprogs' 'glibc' 'icu' 'libedit' 'json-c'
   'krb5' 'libcap' 'libidn2' 'libmaxminddb' 'libnsl' 'libuv' 'libxml2' 'lmdb'
   'openssl' 'readline' 'xz' 'zlib' 'jemalloc' 'libnghttp2' 'liburcu')
-makedepends=('git' 'python-sphinx')
 conflicts=('bind-tools' 'dnsutils')
 replaces=('bind-tools' 'dnsutils' 'host')
 provides=('bind-tools' 'dnsutils' 'dns-server')
@@ -19,30 +18,38 @@
         'var/named/localhost.zone'
         'var/named/localhost.ip6.zone')
 install=bind.install
-source=("git+https://gitlab.isc.org/isc-projects/bind9.git#tag=v${pkgver}"
+validpgpkeys=('D99CCEAF879747014F038D63182E23579462EFAA'  # Michal Nowak
+              '706B6C28620E76F91D11F7DF510A642A06C52CEC') # Michał Kępień
+source=("https://ftp.isc.org/isc/bind9/${pkgver}/bind-${pkgver}.tar.xz"{,.asc}
         'tmpfiles.conf'
         'sysusers.conf'
         'named.conf'
-        'named.service'
         'localhost.zone'
         'localhost.ip6.zone'
         '127.0.0.zone')
-sha256sums=('e71ea81ec264124eb66e4166ed505285cd1073705f7ed7589331a4352af35f22'
+sha256sums=('f90c2da1621299f56a2e6585a6fe459ec3efd6f2fdf84a8fbf31b40be7698a73'
+            'SKIP'
             'f0423c4ee8495da487e07e9144bec1d25f46a0cd2dfa7cfd7a761ef15bfefc98'
             '7c0acefcfcc3ae093550caed7ec90fe84bec8f7477459ffa7e71dda76bcbdb2c'
             'e08a01d41b18bdb771d534daca99642314939aafdb088e5cfcf0ef2d33f8e7eb'
-            '3f0f8db0a1deae270dd166b4750be7c1041b4b44891176f35a8df7dd55d24d34'
             '0011708e516128647dd25b59b6ebc465f36e85bbe0a8fbdc3eb04b7f28c2197f'
             'c06fc270e32a843c8b6d86335a2ec607d405dfba6875de8d8a9abde39a9e2c17'
             'b88fd2b99e7d42d414b329b814b9ff3304fa0ef9c67df81bde235bbfa0f3a3b8')
 
 prepare() {
-  cd bind9
-  autoreconf -fiv
+  cd bind-$pkgver
+  local src
+  for src in "${source[@]}"; do
+    src="${src%%::*}"
+    src="${src##*/}"
+    [[ $src = *.patch ]] || continue
+    echo "Applying patch $src..."
+    patch -Np1 < "../$src"
+  done
 }
 
 build() {
-  cd bind9
+  cd bind-$pkgver
   export CFLAGS
   CFLAGS+=' -DDIG_SIGCHASE'
   ./configure \
@@ -64,7 +71,7 @@
 
 
 package() {
-  cd bind9
+  cd bind-$pkgver
   install -dm755 "$pkgdir/usr/share/licenses/$pkgname/"
   install -Dm644 LICENSE COPYRIGHT "$pkgdir/usr/share/licenses/$pkgname/"
   make DESTDIR="$pkgdir" install
@@ -73,7 +80,6 @@
   install -D -m644 tmpfiles.conf "$pkgdir/usr/lib/tmpfiles.d/$pkgname.conf"
   install -D -m644 sysusers.conf "$pkgdir/usr/lib/sysusers.d/$pkgname.conf"
 
-  install -D -m644 named.service "$pkgdir/usr/lib/systemd/system/named.service"
   install -D -m640 -o 0 -g 40 named.conf "$pkgdir/etc/named.conf"
 
   install -d -m770 -o 0 -g 40 "$pkgdir/var/named"


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,7 +1,8 @@
 bash
 dnssec-anchors
 e2fsprogs
-git
+esysusers
+etmpfiles
 glibc
 icu
 jemalloc
@@ -18,7 +19,6 @@
 libxml2
 lmdb
 openssl
-python-sphinx
 readline
 xz
 zlib

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,9 +1,16 @@
 prepare() {
-cd bind9
-autoreconf -fiv
+cd bind-$pkgver
+local src
+for src in "${source[@]}"; do
+src="${src%%::*}"
+src="${src##*/}"
+[[ $src = *.patch ]] || continue
+echo "Applying patch $src..."
+patch -Np1 < "../$src"
+done
 }
 build() {
-cd bind9
+cd bind-$pkgver
 export CFLAGS
 CFLAGS+=' -DDIG_SIGCHASE'
 ./configure \
