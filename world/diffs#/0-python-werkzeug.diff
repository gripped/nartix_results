--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,6 +1,6 @@
 
 pkgname=python-werkzeug
-pkgver=3.0.4
+pkgver=3.0.1
 pkgrel=1
 pkgdesc='Swiss Army knife of Python web development'
 url='https://werkzeug.palletsprojects.com/'
@@ -11,11 +11,13 @@
 checkdepends=('python-pytest' 'python-pytest-timeout' 'python-pytest-xprocess' 'python-requests'
               'python-ephemeral-port-reserve' 'python-greenlet' 'python-watchdog'
               'python-cryptography')
-source=("https://github.com/pallets/werkzeug/archive/${pkgver}/$pkgname-$pkgver.tar.gz")
-sha512sums=('b89efc5193b5565f74188475e041961d2d3b24e579b60080fe38f806775f2d04ce7902909fdca43b0d40bde3fc5bef871b02eb1fc2a3b57dbb00d5b07dd16b57')
+source=("https://github.com/pallets/werkzeug/archive/${pkgver}/$pkgname-$pkgver.tar.gz"
+         https://github.com/pallets/werkzeug/commit/4e5bdca7.patch)
+sha512sums=('125a5c7680cba726149198802efa90d06c6586daeafcd0960feda637b765356f602df83af7b14996994303c52d32bc6fa044b774f42f0b8991008d1396675033'
+            'eddd871dfe1faf3b2ab35dac32fe991ee26679eb6116fe6290e7a20f2abe430a025b0345b39137746c05c0da79f555ca10d73df298eb02d5c5ef82b13d6384ad')
 
 prepare() {
-  cd "werkzeug-$pkgver"
+  patch -d werkzeug-$pkgver -p1 < 4e5bdca7.patch # Fix tests with pytest 8
 }
 
 build() {
@@ -36,6 +38,6 @@
   cd "werkzeug-$pkgver"
 
   python -m installer --destdir="$pkgdir" dist/*.whl
-  install -Dm 644 LICENSE.txt -t "$pkgdir/usr/share/licenses/$pkgname"
+  install -Dm 644 LICENSE.rst -t "$pkgdir/usr/share/licenses/$pkgname"
 }
 


############# Stripped diff below #################



--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,5 +1,5 @@
 prepare() {
-cd "werkzeug-$pkgver"
+patch -d werkzeug-$pkgver -p1 < 4e5bdca7.patch # Fix tests with pytest 8
 }
 build() {
 cd "werkzeug-$pkgver"
