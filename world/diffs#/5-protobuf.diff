--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,8 +1,8 @@
 
 pkgbase='protobuf'
 pkgname=('protobuf' 'python-protobuf' 'ruby-google-protobuf')
-pkgver=32.0
-pkgrel=1
+pkgver=31.1
+pkgrel=2
 pkgdesc="Protocol Buffers - Google's data interchange format"
 arch=('x86_64')
 url='https://developers.google.com/protocol-buffers/'
@@ -23,7 +23,6 @@
   'python-setuptools'
   'python-wheel'
   'ruby'
-  'ruby-erb'
   'ruby-ffi-compiler'
   'ruby-rake'
   'ruby-rake-compiler'
@@ -35,9 +34,11 @@
 source=(
   git+https://github.com/protocolbuffers/protobuf.git#tag=v$pkgver
   protobuf-fix-build-type-none.patch
+  $pkgbase-25.3-ruby-disable-LTO.patch
 )
-sha512sums=('0efcb80ec3a1f04f0f2e53ccd629eace4f6b9a2cbe5dae4c1b82140f11e174f8d023b8e35855def7e19c35da838c5b4fcfaa54748ee3534886caf1d35f55cccb'
-            '18bc71031bbcbc3810a9985fa670465040f06a6c104ab8079b56bdfc499bb6cec40805a0cefd455031142490a576dc60aa8000523877ac0353b93558e9beabbd')
+sha512sums=('f87cfe2f3c1830df496460b1c3a2ebd2b4d21698121ff72bb602ac83566068d41ee736c5728549921097e2c623ce1aac734b2d850b2f9964f824d6189fa954e1'
+            '18bc71031bbcbc3810a9985fa670465040f06a6c104ab8079b56bdfc499bb6cec40805a0cefd455031142490a576dc60aa8000523877ac0353b93558e9beabbd'
+            '1ebdea4e533ee0f71baf1b3fe2623ca723b36a08c6b97475ea5996b10aeb6873cf94d9120596ddd1216bd2f6feb991f8c33078e8104008a5078ace5be5431efd')
 
 options=(!lto)
 
@@ -48,6 +49,7 @@
   bazel --version
 
   patch -p1 < ../protobuf-fix-build-type-none.patch # Fix cmake config compatibility mode
+  patch -p1 < ../$pkgbase-25.3-ruby-disable-LTO.patch
 }
 
 build() {
@@ -68,14 +70,7 @@
   cmake --build build --verbose
 
   cd "$pkgbase"
-  local bazel_options=(
-    --noenable_bzlmod
-    --enable_workspace
-  )
-
-  [[ $CARCH == "aarch64" ]] && bazel_options+=(--cpu=linux-aarch_64)
-
-  bazel build //python/dist:binary_wheel "${bazel_options[@]}"
+  bazel build //python/dist:binary_wheel --noenable_bzlmod --enable_workspace
 
   cd ruby
   local _gemdir="$(gem env gemdir)"


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -13,7 +13,6 @@
 python-wheel
 ruby
 ruby-bigdecimal
-ruby-erb
 ruby-ffi-compiler
 ruby-rake
 ruby-rake-compiler

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -2,6 +2,7 @@
 cd "$pkgname"
 bazel --version
 patch -p1 < ../protobuf-fix-build-type-none.patch # Fix cmake config compatibility mode
+patch -p1 < ../$pkgbase-25.3-ruby-disable-LTO.patch
 }
 build() {
 local cmake_options=(
@@ -19,12 +20,7 @@
 cmake "${cmake_options[@]}"
 cmake --build build --verbose
 cd "$pkgbase"
-local bazel_options=(
---noenable_bzlmod
---enable_workspace
-)
-[[ $CARCH == "aarch64" ]] && bazel_options+=(--cpu=linux-aarch_64)
-bazel build //python/dist:binary_wheel "${bazel_options[@]}"
+bazel build //python/dist:binary_wheel --noenable_bzlmod --enable_workspace
 cd ruby
 local _gemdir="$(gem env gemdir)"
 local _gemver=4.$pkgver
