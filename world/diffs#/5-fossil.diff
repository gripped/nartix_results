--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,58 +1,30 @@
 
 pkgname=fossil
-pkgver=2.27
+pkgver=2.25
+_tag=8f798279d5f7c3288099915f2ea88c57b6d6039f3f05eac5e237897af33376dc
 pkgrel=1
 pkgdesc='Simple, high-reliability, distributed software configuration management'
 arch=(x86_64)
+license=(BSD-2-Clause)
 url='https://www.fossil-scm.org'
-license=(BSD-2-Clause)
-depends=(
-  fuse2
-  glibc
-  openssl
-  sqlite
-  zlib
+depends=(glibc openssl zlib sqlite)
+makedepends=(tcl)
+optdepends=(tcl)
+source=(
+  https://fossil-scm.org/home/tarball/$_tag/fossil-src-$pkgver.tar.gz
 )
-makedepends=(tcl)
-optdepends=('tcl: diff --tk support')
-source=(
-  "https://fossil-scm.org/home/tarball/version-$pkgver/fossil-src-$pkgver.tar.gz"
-  "$pkgname.socket"
-  "$pkgname.service"
-  "$pkgname-fix-tests.patch"
-)
-b2sums=('b7e69329e35973532f6b14b2b19f1e8da99855f2c7f6818c5e610b533610c9ef3fa240e26e51b9290885cc3e97d0e3f36eb63675304e9644658a069a9fd902b4'
-        'c08d0f6cf864b10f81af6e27cd1e43c8a6d570085b8da114adbda048d7926e403ee7d208d39a62f24ced6acf9f89b7e91a05d02dcb43a6f9f557238a699b0068'
-        '9dc1b1bf1425dd2b865cb5e0114df401a66d36583aa40cad9ee8ca1875952c094b6439f4decd0748633fd064bad7c8ba469d21477a72794a17cec38ca4ca9b43'
-        'f88ca1638c5b03d5d97b2fad944d08d0f43be415f93829baf52ee7d1800a49fc2b8f108b366e3dc74d0135e8ab0499b295ae7cfa9322dbfbd4eded563e9416bc')
-
-prepare() {
-  cd fossil-src-$pkgver
-  patch -Np1 < ../$pkgname-fix-tests.patch
-}
+sha256sums=('611cfa50d08899eb993a5f475f988b4512366cded82688c906cf913e5191b525')
 
 build() {
   cd fossil-src-$pkgver
-  ./configure --prefix=/usr \
-    --json \
-    --with-sqlite=/usr \
-    --with-tcl=/usr \
-    --with-tcl-private-stubs=1
+  ./configure --prefix=/usr --json --disable-internal-sqlite --with-tcl=/usr --with-tcl-private-stubs=1
   make
 }
 
-check() {
+package() {
   cd fossil-src-$pkgver
-  tclsh test/tester.tcl fossil
+  install -Dm755 fossil "$pkgdir"/usr/bin/fossil
+  install -Dm644 tools/fossil-autocomplete.bash "$pkgdir"/usr/share/bash-completion/completions/fossil
+  install -Dm644 tools/fossil-autocomplete.zsh "$pkgdir"/usr/share/zsh/site-functions/_fossil
+  install -Dm644 COPYRIGHT-BSD2.txt "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
 }
-
-package() {
-  install -vDm644 $pkgname.socket "$pkgdir/usr/lib/systemd/system/$pkgname.socket"
-  install -vDm644 $pkgname.service "$pkgdir/usr/lib/systemd/system/$pkgname@.service"
-
-  cd fossil-src-$pkgver
-  install -vDm755 -t "$pkgdir/usr/bin" fossil
-  install -vDm644 tools/fossil-autocomplete.bash "$pkgdir/usr/share/bash-completion/completions/fossil"
-  install -vDm644 tools/fossil-autocomplete.zsh "$pkgdir/usr/share/zsh/site-functions/_fossil"
-  install -vDm644 -t "$pkgdir/usr/share/licenses/$pkgname" COPYRIGHT-BSD2.txt
-}


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,4 +1,3 @@
-fuse2
 glibc
 openssl
 sqlite

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,13 +1,5 @@
-prepare() {
-cd fossil-src-$pkgver
-patch -Np1 < ../$pkgname-fix-tests.patch
-}
 build() {
 cd fossil-src-$pkgver
-./configure --prefix=/usr \
---json \
---with-sqlite=/usr \
---with-tcl=/usr \
---with-tcl-private-stubs=1
+./configure --prefix=/usr --json --disable-internal-sqlite --with-tcl=/usr --with-tcl-private-stubs=1
 make
 }
