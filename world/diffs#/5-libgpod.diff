--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,11 +1,11 @@
 
 pkgname=libgpod
 pkgver=0.8.3
-pkgrel=20
-pkgdesc='A shared library to access the contents of an iPod'
+pkgrel=18
+pkgdesc="A shared library to access the contents of an iPod"
+url="http://www.gtkpod.org/libgpod/"
 arch=(x86_64)
-url='https://sourceforge.net/projects/gtkpod/'
-license=(LGPL-2.1-or-later)
+license=(LGPL)
 depends=(
   gdk-pixbuf2
   libimobiledevice
@@ -13,11 +13,6 @@
   sg3_utils
   sqlite
   usbmuxd
-  libusb
-  glibc
-  zlib
-  glib2
-  libxml2
 )
 makedepends=(
   docbook-xsl
@@ -28,46 +23,30 @@
 options=(!emptydirs)
 source=(
   https://downloads.sourceforge.net/sourceforge/gtkpod/${pkgname}-${pkgver}.tar.bz2
+  0001-323-Segmentation-fault-when-opening-ipod.patch
   libgpod-0.8.2-pkgconfig_overlinking.patch
   libgpod-0.8.3-pkgconfig_sharp.patch
-  libgpod-playcounts.patch
   libgpod-udev.patch
-  libgpod-0.8.3-libplist-2.2.patch
-  libgpod-0.8.3-libplist-2.3.patch
-  libgpod-0.8.3-implicit-int.patch
-  libgpod-0.8.3-pointer-types.patch
 )
-sha512sums=('e39f22054c2d2bdf5fc764aa1f692de17a1a06c7c7e9c60883d126b216dacca7840bf818e7e7e039218fe2a64c0920ba96d8cbbe310e11c1c4e68b82e7cbbd8e'
-            'c8ebcc18ba7b44aef8fada3f9fea88fdaaf6bae12cf809b08f98e85ab6396ae032bfd7706809cd266be67c694749d4364a9cc591eb750478e095cbbcbe061419'
-            '3266c9cd02d06265b9ec8a967058042a4b6bfabfda8db1b6de59d8b87db5ab63e8a256d5e0f22c2f2dec8e8d229b62283f117b49eae07e71ee2455a34d645d92'
-            'ee72d5875e2240b46c943ae3e45949d08b4fe4916d28b266a70afc52ab40e5d41fbba723376b74e84cd4828562e5fea703eca73e70de34980061ed20c82fe61c'
-            '74f015329656d196674d4d4c9dab247e0e1d0fe969237811af87751927684b42f050d6ec03002154b04c78a5917cb99ee90dd1f3de226e0c9cb73ebac8944713'
-            'd09d6f17930d3b52eb3a5d18978f70a62be79f7499adac1f04212668f062464b6d1ad5ad12d99eab418731dd91db009b0e0ff12386a027267513c9303ffb0392'
-            '905c8e0d3ecec00ff0879a7780e372e449d132b2961dec7adf9e5106b55facecd706460f82c0ac1e8ea41d14c68a8691e1e379aa504c4e87f2cc889cf90e6cdc'
-            '1445c67d6b315efefd69071c4a45c58f341c2bfadb4e154e693e30987c26861e5d2776f9c7a400f4589e1a899cf2d5e438a7475f22dcd20f1101e2ccacba88c4'
-            '10eb4fd50452c1c5e5517e2fe2bc3bc774253c540c1b281cb7b4222bef84a354779318d1d503b590c06160fd58f18cf940e9a8a347900db29e146f55595a9c6b')
+sha256sums=('638a7959d04e95f1e62abad02bd33702e4e8dfef98485ac7d9d50395c37e955d'
+            'b181131ee5b42673074f8217155b4f147623cc63dd382ee4bfa2cb81cd281b20'
+            '02daa2b46d0cfdee14c9d96eabf903ba4638694e669c5cb0ec462076837ac2ff'
+            '8e61c2a26c9144f2d76dae84ebb0b6ac9a73c53e4411fd4046c3938e0bbe5e23'
+            '35786054ebbfab1d247d51e7c7dc7618f8ed9fc17ad3c8b590d89190728452ea')
 b2sums=('e9bc54d23be7f54a17eea3f8a07d7bf6a28224d9c0b0f90fb9d44d97af6cf64c31096de5d9fa4b446e1a9463a6e8f3a59929d73bf52ad8d638732868c3c1b7d0'
+        '4d984ba1d0a8da1e9a28e06cfebe5501a580ffe528a851e3470855f298db78067fedb14c5cb48c6165f0b571e27259cb30bb848d4b9a4724174a25eaa695ff3f'
         '74d924d61ce33c4fd0219e8dedb505bd66cd40e9912efb2dbbb5df31c2bea943ea4a4eb8b9e9baf2762966b02efae3f77c73293f8a4a581f6a43be4cc22eb727'
-        '453bbd8e3df739a4eb3049776911996f9fdf56404841a2f41834c9a068486111192bb188773c4e674417d0e6fdb47fe1527bfac087bfd5594bfba78e77ff8f45'
-        '8a46f6ff8dab53e6fa608e7f8896bd8394ea15868b4c949895d3bd6fca1d8d08b2c3a9d1b294804b850f30b5cb0149283b8ee2618b22dfc45526392f40264d29'
-        '4771e49da6a229481d81db5a98a0f6d25f5e541f05a8be8da002214fd9ad3dc688693397c7e2d9855e8ade56709cd4f420817120c0556d00554771a760836500'
-        '6226ae75d54eead5bb2eaa1af55c5170e02c4f30d3dc7bd5e8d81029d86627148d90d0a2be8ece4dd59300e66f27f3eea93522cd765cd14a335ebe3bb9809f8e'
-        'a1c3f633966d4181197b22cd94a253bce94c8e76bdd4fdd0015a6ef012bc9a70c96b77a322913ba00e0ef586ec3b292b811684c3e6626648f7641bb86fa8ba5a'
-        'c12dfc683301089f73c6dc33acf38b012cdaba16dcae033db5bd027d7d48b0e2a93df0a27a690944d904fb2c6d9bef0c97fd62aea16e3a70e7404d2a1926efdd'
-        '0d86c14195e55459f681c79f0bf660d00d55213d732d999f0cc75dedad2c3fd109014f4480e89f74ab190bbea6a3dce30309c04cd493893a97e53b689a3af5c9')
+        'd3cb8ceaf14811c7bdee072229c838a4b9d7bd8c53ec76d2d0177c954730271b75174e559657d0948ccb5f921170e4d6636d4f1a36b329970f6b32da236ce390'
+        'cbf5e305dd2b219149c09763eaf405f9e50944a2a12310caec31770378828241ce06b1747ba78552261724e37de052eefa145589600c77aeefdcc3a86a0b8a23')
 
 prepare() {
   cd $pkgname-$pkgver
-
-  patch -p1 -i "$srcdir/libgpod-0.8.2-pkgconfig_overlinking.patch"
-  patch -p1 -i "$srcdir/libgpod-0.8.3-pkgconfig_sharp.patch"
-  patch -p1 -i "$srcdir/libgpod-playcounts.patch"
-  patch -p1 -i "$srcdir/libgpod-udev.patch"
-  patch -p1 -i "$srcdir/libgpod-0.8.3-libplist-2.2.patch"
-  patch -p1 -i "$srcdir/libgpod-0.8.3-libplist-2.3.patch"
-  patch -p1 -i "$srcdir/libgpod-0.8.3-implicit-int.patch"
-  patch -p1 -i "$srcdir/libgpod-0.8.3-pointer-types.patch"
-
+  patch -Np1 -i ../0001-323-Segmentation-fault-when-opening-ipod.patch
+  patch -Np1 -i ../libgpod-0.8.2-pkgconfig_overlinking.patch
+  patch -Np1 -i ../libgpod-0.8.3-pkgconfig_sharp.patch
+  patch -Np0 -i ../libgpod-udev.patch
+  sed -e 's|libplist >= 1.0|libplist-2.0 >= 2.2|' -i configure.ac # support libplist 2.2
+  sed -e 's|plist_dict_insert_item|plist_dict_set_item|' -i tools/ipod-lockdown.c # support libplist 2.3
   autoreconf -fvi
 }
 


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,14 +1,9 @@
 docbook-xsl
 gdk-pixbuf2
-glib2
-glibc
 gtk-doc
 intltool
 libimobiledevice
 libplist
-libusb
-libxml2
 sg3_utils
 sqlite
 usbmuxd
-zlib

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,13 +1,11 @@
 prepare() {
 cd $pkgname-$pkgver
-patch -p1 -i "$srcdir/libgpod-0.8.2-pkgconfig_overlinking.patch"
-patch -p1 -i "$srcdir/libgpod-0.8.3-pkgconfig_sharp.patch"
-patch -p1 -i "$srcdir/libgpod-playcounts.patch"
-patch -p1 -i "$srcdir/libgpod-udev.patch"
-patch -p1 -i "$srcdir/libgpod-0.8.3-libplist-2.2.patch"
-patch -p1 -i "$srcdir/libgpod-0.8.3-libplist-2.3.patch"
-patch -p1 -i "$srcdir/libgpod-0.8.3-implicit-int.patch"
-patch -p1 -i "$srcdir/libgpod-0.8.3-pointer-types.patch"
+patch -Np1 -i ../0001-323-Segmentation-fault-when-opening-ipod.patch
+patch -Np1 -i ../libgpod-0.8.2-pkgconfig_overlinking.patch
+patch -Np1 -i ../libgpod-0.8.3-pkgconfig_sharp.patch
+patch -Np0 -i ../libgpod-udev.patch
+sed -e 's|libplist >= 1.0|libplist-2.0 >= 2.2|' -i configure.ac # support libplist 2.2
+sed -e 's|plist_dict_insert_item|plist_dict_set_item|' -i tools/ipod-lockdown.c # support libplist 2.3
 autoreconf -fvi
 }
 build() {
