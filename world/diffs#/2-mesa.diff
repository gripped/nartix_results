--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -13,8 +13,8 @@
   'mesa-vdpau'
   'mesa'
 )
-pkgver=24.0.8
-pkgrel=1
+pkgver=24.0.6
+pkgrel=2
 epoch=1
 pkgdesc="Open-source OpenGL drivers"
 url="https://www.mesa3d.org/"
@@ -44,7 +44,6 @@
   'rust'
   'spirv-llvm-translator'
   'spirv-tools'
-  'systemd-libs'
   'vulkan-icd-loader'
   'wayland'
   'xcb-util-keysyms'
@@ -70,9 +69,6 @@
 
   'libomxil-bellagio'
 )
-options=(
-  !lto
-)
 source=(
   https://mesa.freedesktop.org/archive/mesa-${pkgver}.tar.xz{,.sig}
 )
@@ -96,13 +92,13 @@
   source+=($_crate-${_crates[$_crate]}.tar.gz::https://crates.io/api/v1/crates/$_crate/${_crates[$_crate]}/download)
 done
 
-sha256sums=('d1ed86a266d5b7b8c136ae587ef5618ed1a9837a43440f3713622bf0123bf5c1'
+sha256sums=('8b7a92dbe6468c18f2383700135b5fe9de836cdf0cc8fd7dbae3c7110237d604'
             'SKIP'
             '39278fbbf5fb4f646ce651690877f89d1c5811a3d4acb27700c1cb3cdb78fd3b'
             '3354b9ac3fae1ff6755cb6db53683adb661634f67557942dea4facebec0fee4b'
             '5267fca4496028628a95160fc423a33e8b2e6af8a5302579e322e4b520293cae'
             '23e78b90f2fcf45d3e842032ce32e3f2d1545ba6636271dcbf24fa306d87be7a')
-b2sums=('1919e99e6ccbd51c8e74e55985ea9a3f47bf49c7e4260a195a609ce175eeded9fc5a56970ae35d21bc650e4bb802df484d2088b29ef3861d13942bd495891a9a'
+b2sums=('531482c1a01ec4c0bd6b2f0857640c14fcc2ba70e85a14e4edf0f44ba466c12e39ad067690e6a571a0744ae06080943b1328a29263225cb7570f119464e17fbe'
         'SKIP'
         'fff0dec06b21e391783cc136790238acb783780eaedcf14875a350e7ceb46fdc100c8b9e3f09fb7f4c2196c25d4c6b61e574c0dad762d94533b628faab68cf5c'
         '4cede03c08758ccd6bf53a0d0057d7542dfdd0c93d342e89f3b90460be85518a9fd24958d8b1da2b5a09b5ddbee8a4263982194158e171c2bba3e394d88d6dac'
@@ -119,20 +115,30 @@
   local meson_options=(
     -D android-libbacktrace=disabled
     -D b_ndebug=true
+    -D dri3=enabled
+    -D egl=enabled
     -D gallium-drivers=r300,r600,radeonsi,nouveau,virgl,svga,swrast,i915,iris,crocus,zink,d3d12
     -D gallium-extra-hud=true
     -D gallium-nine=true
     -D gallium-omx=bellagio
     -D gallium-opencl=icd
     -D gallium-rusticl=true
+    -D gallium-va=enabled
+    -D gallium-vdpau=enabled
+    -D gallium-xa=enabled
+    -D gbm=enabled
     -D gles1=disabled
+    -D gles2=enabled
     -D glvnd=true
     -D glx=dri
     -D intel-clc=enabled
     -D libunwind=disabled
+    -D llvm=enabled
+    -D lmsensors=enabled
     -D microsoft-clc=disabled
     -D osmesa=true
     -D platforms=x11,wayland
+    -D shared-glapi=enabled
     -D valgrind=enabled
     -D video-codecs=all
     -D vulkan-drivers=amd,intel,intel_hasvk,swrast,virtio,nouveau-experimental
@@ -144,11 +150,11 @@
 
   export MESON_PACKAGE_CACHE_DIR="$srcdir"
 
-  arch-meson mesa-$pkgver build "${meson_options[@]}"
-  meson configure build --no-pager # Print config
+  artix-meson mesa-$pkgver build "${meson_options[@]}"
+  meson configure build # Print config
   meson compile -C build
 
-  meson install -C build --destdir "$srcdir/fakeinstall"
+  DESTDIR="${srcdir}/fakeinstall" meson install -C build
 }
 
 _install() {
@@ -252,7 +258,6 @@
     'libx11'
     'libxcb'
     'libxshmfence'
-    'systemd-libs'
     'vulkan-icd-loader'
     'wayland'
     'xcb-util-keysyms'
@@ -278,7 +283,6 @@
     'libx11'
     'libxcb'
     'libxshmfence'
-    'systemd-libs'
     'vulkan-icd-loader'
     'wayland'
     'xcb-util-keysyms'
@@ -306,7 +310,6 @@
     'libxcb'
     'libxshmfence'
     'llvm-libs'
-    'systemd-libs'
     'vulkan-icd-loader'
     'wayland'
     'xcb-util-keysyms'
@@ -334,7 +337,6 @@
     'libxcb'
     'libxshmfence'
     'llvm-libs'
-    'systemd-libs'
     'vulkan-icd-loader'
     'wayland'
     'xcb-util-keysyms'
@@ -362,7 +364,6 @@
     'libx11'
     'libxcb'
     'libxshmfence'
-    'systemd-libs'
     'vulkan-icd-loader'
     'wayland'
     'xcb-util-keysyms'


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -33,7 +33,6 @@
 rust-bindgen
 spirv-llvm-translator
 spirv-tools
-systemd-libs
 valgrind
 vulkan-icd-loader
 wayland