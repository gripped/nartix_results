--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,8 +1,8 @@
 
 pkgbase=samba
 pkgname=('libwbclient' 'ldb' 'smbclient' 'samba')
-pkgver=4.23.1
-pkgrel=1
+pkgver=4.23.0
+pkgrel=2
 arch=(x86_64)
 url="https://www.samba.org"
 license=('GPL-3.0-or-later')
@@ -32,7 +32,7 @@
   python-markdown
   readline
   rpcsvc-proto
-  systemd
+
   talloc
   tdb
   tevent
@@ -45,18 +45,24 @@
 epoch=2
 source=(
   https://download.samba.org/samba/ftp/stable/${pkgbase}-${pkgver}.tar{.gz,.asc}
+  4.23.0-fix-winbind-start.patch
   samba.logrotate
   samba.pam
   samba.tmpfiles
 )
 validpgpkeys=('81F5E2832BD2545A1897B713AA99442FB680B620') #Samba Distribution Verification Key <samba-bugs@samba.org>
-b2sums=('27d5c7d24140716692824bd255a757cd93a05f1e8584822614ddd51dbdb1b008e519c98c2de8c6ff5e7d4c92260a655ae84190fe84aa9ac46290ffd60fb613ad'
+b2sums=('e4787045dd85dce9e03b18d04d09ed1c3adae01f13545e99c2d84af8855f42f716bb256d8eee2830164f2fd59c7386f1547f4ec45504edc3c80470b27fe05ab4'
         'SKIP'
+        '1e66610a28bd7e8f5e861bd9f2263006ed05737b01280768ed0c27d17f25bd450d46d191cfcfd7c446b7abdbe654fcfda0f30b3dbca634e6d1020a1e66329988'
         '72ecb413ca3499af984a0bb391f96e678a24a19d8e5c96050ba227878f0770f03466ac7a0ee328416e08204e92e9d16ec22d63ef25b53c20d957a17221cd3a98'
         '3eab84d332d96678fe6e435ee243c8f1a82b838f601d61d3604d11e918aed7a62202edca5e476c4b9031ed284570e6fcd6c659cfdbd9624aa0019d3233755f81'
         'e1f49e14d34cf1a48378cad9f427215101ff55b2461340e0dc2376192f07c45fc238463a07672348c0823e3aa7892c83a939a7d358aabac818e2108ca2c1900f')
 
 
+prepare() {
+      cd ${pkgbase}-${pkgver}
+    patch -Np1 -i ../4.23.0-fix-winbind-start.patch
+}
 
 build() {
 _samba4_idmap_modules=idmap_ad,idmap_rid,idmap_adex,idmap_hash,idmap_tdb2
@@ -80,8 +86,7 @@
     --with-ldap \
     --with-winbind \
     --with-acl-support \
-    --with-systemd \
-    --systemd-install-services \
+    --without-systemd \
     --with-pam \
     --with-pammodulesdir=/usr/lib/security \
     --private-libraries='!ldb' \
@@ -280,7 +285,6 @@
 backup=(
   etc/logrotate.d/samba
   etc/pam.d/samba
-  etc/conf.d/samba
 )
 install=samba.install
 
@@ -296,9 +300,6 @@
       "${pkgdir}"/usr/${script}
   done
 
-  sed -i -e '/^EnvironmentFile/ s/sysconfig/conf.d/' "${pkgdir}"/usr/lib/systemd/system/*.service
-  install -d -m755  "${pkgdir}"/etc/conf.d
-  install -m644 "${srcdir}"/samba-${pkgver}/packaging/systemd/samba.sysconfig "${pkgdir}"/etc/conf.d/samba
 
   install -D -m644 "${srcdir}"/samba.tmpfiles "${pkgdir}"/usr/lib/tmpfiles.d/samba.conf
   install -d -m755 "${pkgdir}"/etc/samba


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -37,7 +37,6 @@
 readline
 rpcsvc-proto
 smbclient>
-systemd
 talloc
 tdb
 tevent