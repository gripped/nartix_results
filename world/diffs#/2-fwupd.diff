--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -4,7 +4,7 @@
   fwupd
   fwupd-docs
 )
-pkgver=2.0.11
+pkgver=2.0.10
 pkgrel=1
 pkgdesc="Simple daemon to allow session software to update firmware"
 arch=(x86_64)
@@ -37,7 +37,6 @@
   python
   shared-mime-info
   sqlite
-  systemd-libs
   tpm2-tss
   xz
   zlib
@@ -64,35 +63,27 @@
 source=(
   "git+https://github.com/fwupd/fwupd.git#tag=${pkgver}?signed"
   fwupd.sysusers
-  0001-remove-DistroVersion-from-fu-test.patch
 )
-sha512sums=('b45510721d2c59f0834c425affe1bddb9610503320d1a20e0fafe3f8452b50fc9e405de5642f5d52cfcdc918515443a4c92754979f34fafd9454a34cf9f721cd'
-            'f9a99c60786a2b98e0de439a9288af61b2c0716f8339a4c93e2df7108d2a7f9ef8128967dcaa1e12022ffa647945bf5eb3749e38cac83e00a28cbc5b015fbee9'
-            '1d3b1dbc0e2101982463c91222bffa1e5bfbde154a5126f654dc5fcf9a84480cdd5a3044408f7effd03b6abdc6abfc6394316ffaa76b96a6c6e23a9436dfcca4')
-b2sums=('c6c934e9d8206eeebc2eed2726a42e20dc0f505124b9a6c3d9fd9de8c9ce4aeab8e7bbaee2272a2aaac406ab91a0a0ceefec08ea21111a1a7b7a2c24e3f08331'
-        'c294c6dd324c0ad0d752affdc459d427d34f4bf865def099ac0e25db6b5dfbfcf645ca325e4e7732d1256e75c624ff27094d5c814726909c7e348128a9dd93f9'
-        'c9a2e706cbd09ab9b69ce41ebc90fb438c3aa251cba0e59358b3017b498d7a8ced2dbbfd94dc170263f2e3caac1c648a2ee8bf33bae403d193d95ba45a6fef30')
+sha512sums=('049fc61293b5b9ad3df10add6d2a81910a04959634c15264c26717f2d7ec25b279b33b3f70775e15aca281a9002b67d3a9313cd77412903a44ee7a381d1f8dc5'
+            'f9a99c60786a2b98e0de439a9288af61b2c0716f8339a4c93e2df7108d2a7f9ef8128967dcaa1e12022ffa647945bf5eb3749e38cac83e00a28cbc5b015fbee9')
+b2sums=('faf940d95b72e7f7be0334ad26c67ecb11c8b6aa57afc93f5c24df5cfbda0211d074489fe915b03e296e9f7092ddc58a2fe75f3f92a07cb64f7e4817629662b1'
+        'c294c6dd324c0ad0d752affdc459d427d34f4bf865def099ac0e25db6b5dfbfcf645ca325e4e7732d1256e75c624ff27094d5c814726909c7e348128a9dd93f9')
 validpgpkeys=(163EB50119225DB3DF8F49EA17ACBA8DFA970E17) # Richard Hughes <richard@hughsie.com>
-
-prepare() {
-  cd ${pkgname}
-  patch -Np1 < ../0001-remove-DistroVersion-from-fu-test.patch
-}
 
 build() {
   local meson_options=(
+    -D systemd=disabled
     -D docs=enabled
     -D efi_binary=false
     -D supported_build=enabled
-    -D systemd_unit_user=fwupd
   )
 
-  arch-meson ${pkgname} build "${meson_options[@]}"
+  artix-meson ${pkgname} build "${meson_options[@]}"
   meson compile -C build
 }
 
 check() {
-  meson test -C build --print-errorlogs
+  meson test -C build --print-errorlogs || :
 }
 
 _pick() {
@@ -135,8 +126,8 @@
   rm -r "${pkgdir}"/usr/{lib,share}/installed-tests/
   mv "${pkgdir}"/usr/bin/{,fwupd-}dbxtool
   mv "${pkgdir}"/usr/share/man/man1/{,fwupd-}dbxtool.1
-  rm "${pkgdir}"/usr/lib/modules-load.d/fwupd-msr.conf
-  rmdir "${pkgdir}"/usr/lib/modules-load.d
+  rm "${pkgdir}"/usr/lib/modules-load.d/fwupd-msr.conf || :
+  rmdir "${pkgdir}"/usr/lib/modules-load.d || :
 
   _pick docs "${pkgdir}"/usr/share/doc/{,fwupd/}{libfwupdplugin,libfwupd}
 }


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -48,7 +48,6 @@
 python-pillow
 shared-mime-info
 sqlite
-systemd-libs
 tpm2-tss
 umockdev
 vala