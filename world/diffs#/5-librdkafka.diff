--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,17 +1,11 @@
 
 pkgname=librdkafka
-pkgver=2.5.3
+pkgver=2.4.0
 pkgrel=1
 pkgdesc='The Apache Kafka C/C++ library'
 arch=(x86_64)
 url='https://github.com/confluentinc/librdkafka'
-license=(
-  Apache-2.0
-  BSD-2-Clause
-  BSD-3-Clause
-  MIT
-  Zlib
-)
+license=(BSD)
 depends=(
   curl
   gcc-libs
@@ -22,40 +16,21 @@
   zlib
   zstd
 )
-makedepends=(
-  cmake
-  python
-  rapidjson
-)
-source=(
-  "$pkgname-$pkgver.tar.gz::$url/archive/v$pkgver.tar.gz"
-  "remove-failing-tests.patch"
-)
-sha256sums=('eaa1213fdddf9c43e28834d9a832d9dd732377d35121e42f875966305f52b8ff'
-            '23c8d030179724d13a91f13cf566b045b195d64a3219eb2c5122d06e1e1c6fd1')
-
-prepare() {
-  cd $pkgname-$pkgver
-  patch -Np1 -i "$srcdir/remove-failing-tests.patch"
-}
+makedepends=(python rapidjson)
+source=(librdkafka-$pkgver.tar.gz::https://github.com/confluentinc/librdkafka/archive/v$pkgver.tar.gz)
+sha256sums=('d645e47d961db47f1ead29652606a502bdd2a880c85c1e060e94eea040f1a19a')
 
 build() {
   cd $pkgname-$pkgver
-  cmake -S . -B build \
-    -DCMAKE_BUILD_TYPE=None \
-    -DCMAKE_INSTALL_PREFIX=/usr \
-    -Wno-dev
-  cmake --build build
+  ./configure --prefix=/usr
+  make
 }
 
 check() {
-  cd $pkgname-$pkgver
-  ctest --test-dir build --output-on-failure \
-    --tests-regex RdKafkaTestBrokerLess
+  make -k check -C $pkgname-$pkgver
 }
 
 package() {
-  cd $pkgname-$pkgver
-  DESTDIR="$pkgdir" cmake --install build
-  install -vDm644 -t "$pkgdir/usr/share/doc/$pkgname" ./*.md
+  make DESTDIR="$pkgdir" install -C $pkgname-$pkgver
+  install -vDm 644 $pkgname-$pkgver/LICENSE* -t "$pkgdir/usr/share/licenses/$pkgname/"
 }


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,4 +1,3 @@
-cmake
 curl
 gcc-libs
 glibc

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,12 +1,5 @@
-prepare() {
-cd $pkgname-$pkgver
-patch -Np1 -i "$srcdir/remove-failing-tests.patch"
-}
 build() {
 cd $pkgname-$pkgver
-cmake -S . -B build \
--DCMAKE_BUILD_TYPE=None \
--DCMAKE_INSTALL_PREFIX=/usr \
--Wno-dev
-cmake --build build
+./configure --prefix=/usr
+make
 }
