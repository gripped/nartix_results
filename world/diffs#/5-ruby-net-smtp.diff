--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,35 +1,36 @@
 
 _gemname='net-smtp'
 pkgname="ruby-${_gemname}"
-pkgver=0.5.1
-pkgrel=1
+pkgver=0.5.0
+pkgrel=5
 pkgdesc='Simple Mail Transfer Protocol client library for Ruby'
 arch=('any')
 url="https://github.com/ruby/${_gemname}"
 license=('RUBY' 'BSD-2-CLAUSE')
 depends=(ruby)
-makedepends=(
-  git
-  ruby-rdoc
-)
 checkdepends=(
   ruby-bundler
   ruby-rake
   ruby-test-unit
 )
 options=('!emptydirs')
-source=("git+${url}#tag=v${pkgver}")
-sha512sums=('5716fc733ba0c52e613b7bce2e75a9ef4f76b4dea18f64c439cace3e83587e61f2ca80bcc6a6290cfb667b3f4d98025c27e5124ce190fd6b7f3ff41d555661da')
-b2sums=('f27ab2b103dfebaa37d94b5041e60ae01f2efdabae7c7f2aaf9f632ca2b2e4a75959c704ec564772fa3b33152f804e032938115bc69531b90d4bebec6be46d95')
+source=("${url}/archive/v${pkgver}/${pkgname}-${pkgver}.tar.gz")
+sha512sums=('bf497150a4b7f59307ddedd02b1b210b971ba0de0d7459872d01a7db8175bb42c29598b5e9b6efdbdf90cc012696da2e000149246e1142a5695e7fe646aa6fa8')
+b2sums=('9969354a7f0fc4a32beac965bfc325aa54a1687d28ee7a4828005bbee1cabcaeefb4ffcdd019761c9162c7623efeccc8a4cb7222df004c75cbc1cced5242df3f')
 
 prepare() {
-  cd "${_gemname}"
+  cd "${_gemname}-${pkgver}"
 
   sed --in-place --regexp-extended 's|~>|>=|g' "${_gemname}.gemspec"
+
+  sed --in-place --regexp-extended \
+    --expression '/spec\.files/d' \
+    --expression "s|net-smtp\"|net-smtp\"\n  spec.files = Dir['lib/**/*', 'README.md', 'NEWS.md', 'LICENSE.txt']|" \
+    "${_gemname}.gemspec"
 }
 
 build() {
-  cd "${_gemname}"
+  cd "${_gemname}-${pkgver}"
 
   local _gemdir="$(gem env gemdir)"
 
@@ -71,7 +72,7 @@
 }
 
 check() {
-  cd "${_gemname}"
+  cd "${_gemname}-${pkgver}"
 
   local _gemdir="$(gem env gemdir)"
 
@@ -79,7 +80,7 @@
 }
 
 package() {
-  cd "${_gemname}"
+  cd "${_gemname}-${pkgver}"
 
   cp --archive --verbose tmp_install/* "${pkgdir}"
 


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,3 +1 @@
-git
 ruby
-ruby-rdoc

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,9 +1,13 @@
 prepare() {
-cd "${_gemname}"
+cd "${_gemname}-${pkgver}"
 sed --in-place --regexp-extended 's|~>|>=|g' "${_gemname}.gemspec"
+sed --in-place --regexp-extended \
+--expression '/spec\.files/d' \
+--expression "s|net-smtp\"|net-smtp\"\n  spec.files = Dir['lib/**/*', 'README.md', 'NEWS.md', 'LICENSE.txt']|" \
+"${_gemname}.gemspec"
 }
 build() {
-cd "${_gemname}"
+cd "${_gemname}-${pkgver}"
 local _gemdir="$(gem env gemdir)"
 gem build --verbose "${_gemname}.gemspec"
 gem install \
