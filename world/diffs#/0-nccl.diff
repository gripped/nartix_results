--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,6 +1,6 @@
 
 pkgname=nccl
-pkgver=2.28.3
+pkgver=2.27.7
 _upstr_pkgrel=1
 pkgrel=1
 pkgdesc='Library for NVIDIA multi-GPU and multi-node collective communication primitives'
@@ -10,8 +10,8 @@
 depends=(glibc gcc-libs)
 makedepends=(git cuda)
 source=(git+https://github.com/NVIDIA/nccl.git#tag=v$pkgver-$_upstr_pkgrel)
-sha256sums=('0e926a88d113851017fb19a4e7a95e36801053e1376d501455b0d4d2eb08c5bc')
-b2sums=('c184ba68bc95ca96862f76a132e0bd8b62eb2a1c4f6047589d5f1b39db281714e210aab17006ed1d249015b4fc67d3fad07aafc6afb8f326671bb2c8dc9dfbf6')
+sha256sums=('e34ea01d667b299ad61821bc02db37fa8a2d11bea44f52bfeae4f8b1321b7078')
+b2sums=('6d6b36845f0dac2c5ed8f71552b84ec63e1eabb3bfa4bade2ade0adb8ebf561f3560ea9e4fc24ee38e8d8c3fdf875ee4b67dfa33031702d4017c581b3a64e2ac')
 
 prepare() {
   cd $pkgname
@@ -28,19 +28,27 @@
 build() {
   cd $pkgname
 
-  export NVCC_GENCODE="-gencode=arch=compute_75,code=sm_75 \
+  export NVCC_GENCODE="-gencode=arch=compute_52,code=sm_52 \
+                       -gencode=arch=compute_53,code=sm_53 \
+                       -gencode=arch=compute_60,code=sm_60 \
+                       -gencode=arch=compute_61,code=sm_61 \
+                       -gencode=arch=compute_62,code=sm_62 \
+                       -gencode=arch=compute_70,code=sm_70 \
+                       -gencode=arch=compute_72,code=sm_72 \
+                       -gencode=arch=compute_75,code=sm_75 \
                        -gencode=arch=compute_80,code=sm_80 \
                        -gencode=arch=compute_86,code=sm_86 \
                        -gencode=arch=compute_87,code=sm_87 \
-                       -gencode=arch=compute_88,code=sm_88 \
                        -gencode=arch=compute_89,code=sm_89 \
                        -gencode=arch=compute_90,code=sm_90 \
+                       -gencode=arch=compute_90a,code=sm_90a \
                        -gencode=arch=compute_100,code=sm_100 \
-                       -gencode=arch=compute_103,code=sm_103 \
-                       -gencode=arch=compute_110,code=sm_110 \
+                       -gencode=arch=compute_100a,code=sm_100a \
+                       -gencode=arch=compute_101,code=sm_101 \
+                       -gencode=arch=compute_101a,code=sm_101a \
                        -gencode=arch=compute_120,code=sm_120 \
-                       -gencode=arch=compute_121,code=sm_121 \
-                       -gencode=arch=compute_121,code=compute_121"
+                       -gencode=arch=compute_120a,code=sm_120a \
+                       -gencode=arch=compute_120,code=compute_120"
 
   export CUDARTLIB=cudart
 
@@ -51,7 +59,7 @@
 package() {
   cd $pkgname
 
-  make CUDA_HOME=/opt/cuda PREFIX="${pkgdir}"/usr install
+  make PREFIX="${pkgdir}"/usr install
   chmod 644 "$pkgdir"/usr/lib/libnccl_static.a
   install -vDm 644 LICENSE.txt -t "$pkgdir"/usr/share/licenses/$pkgname/
 }


############# Stripped diff below #################



--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -10,19 +10,27 @@
 }
 build() {
 cd $pkgname
-export NVCC_GENCODE="-gencode=arch=compute_75,code=sm_75 \
+export NVCC_GENCODE="-gencode=arch=compute_52,code=sm_52 \
+-gencode=arch=compute_53,code=sm_53 \
+-gencode=arch=compute_60,code=sm_60 \
+-gencode=arch=compute_61,code=sm_61 \
+-gencode=arch=compute_62,code=sm_62 \
+-gencode=arch=compute_70,code=sm_70 \
+-gencode=arch=compute_72,code=sm_72 \
+-gencode=arch=compute_75,code=sm_75 \
 -gencode=arch=compute_80,code=sm_80 \
 -gencode=arch=compute_86,code=sm_86 \
 -gencode=arch=compute_87,code=sm_87 \
--gencode=arch=compute_88,code=sm_88 \
 -gencode=arch=compute_89,code=sm_89 \
 -gencode=arch=compute_90,code=sm_90 \
+-gencode=arch=compute_90a,code=sm_90a \
 -gencode=arch=compute_100,code=sm_100 \
--gencode=arch=compute_103,code=sm_103 \
--gencode=arch=compute_110,code=sm_110 \
+-gencode=arch=compute_100a,code=sm_100a \
+-gencode=arch=compute_101,code=sm_101 \
+-gencode=arch=compute_101a,code=sm_101a \
 -gencode=arch=compute_120,code=sm_120 \
--gencode=arch=compute_121,code=sm_121 \
--gencode=arch=compute_121,code=compute_121"
+-gencode=arch=compute_120a,code=sm_120a \
+-gencode=arch=compute_120,code=compute_120"
 export CUDARTLIB=cudart
 export CXXFLAGS+=" -ffat-lto-objects"
 make CXX="$NVCC_CCBIN" CUDA_HOME=/opt/cuda PREFIX=/usr src.build
