--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -2,61 +2,29 @@
 
 
 pkgbase=java11-openjdk
-pkgname=(
-  jre11-openjdk-headless
-  jre11-openjdk
-  jdk11-openjdk
-  openjdk11-src
-  openjdk11-doc
-)
+pkgname=('jre11-openjdk-headless' 'jre11-openjdk' 'jdk11-openjdk' 'openjdk11-src' 'openjdk11-doc')
 _majorver=11
 _minorver=0
 _securityver=27
 _updatever=6
 pkgver=${_majorver}.${_minorver}.${_securityver}.u${_updatever}
-pkgrel=2
+pkgrel=1
 _git_tag=jdk-${_majorver}.${_minorver}.${_securityver}+${_updatever}
 arch=('x86_64')
 url='https://openjdk.java.net/'
 license=('LicenseRef-Java')
-makedepends=(
-  'java-environment=11'
-  alsa-lib
-  bash
-  cpio
-  freetype2
-  gcc14
-  gcc14-libs
-  giflib
-  glibc
-  graphviz
-  harfbuzz
-  lcms2
-  libcups
-  libelf
-  libjpeg-turbo
-  libnet
-  libpng
-  libx11
-  libxext
-  libxrandr
-  libxrender
-  libxt
-  libxtst
-  pandoc
-  unzip
-  zip
-)
+makedepends=('java-environment=11' 'cpio' 'unzip' 'zip' 'libelf' 'libcups' 'libx11'
+             'libxrender' 'libxtst' 'libxt' 'libxext' 'libxrandr' 'alsa-lib' 'pandoc'
+             'graphviz' 'freetype2' 'libjpeg-turbo' 'giflib' 'libpng' 'lcms2'
+             'libnet' 'bash' 'harfbuzz' 'gcc-libs' 'glibc')
 optdepends=(
   'gvfs: open links e.g. hyperlinks'
 )
 options=(!lto)
-source=(
-  https://github.com/openjdk/jdk${_majorver}u/archive/${_git_tag}.tar.gz
-  freedesktop-java.desktop
-  freedesktop-jconsole.desktop
-  freedesktop-jshell.desktop
-)
+source=(https://github.com/openjdk/jdk${_majorver}u/archive/${_git_tag}.tar.gz
+        freedesktop-java.desktop
+        freedesktop-jconsole.desktop
+        freedesktop-jshell.desktop)
 sha256sums=('fa53248e26ccf0635483b8cb6be7dc577548831e1ce421def2782d1e2373ce46'
             '575587ad58dfa9908f046d307b9afc7b0b2eb20a1eb454f8fdbbd539ea7b3d01'
             '2f57b7c7dd671eabe9fa10c4f1283573e99d7f7c36eccd82c95b705979a2e8cb'
@@ -71,35 +39,25 @@
 _jdkdir=jdk${_majorver}u-${_git_tag//+/-}
 _imgdir=${_jdkdir}/build/linux-${_JARCH}-normal-server-release/images
 
-_nonheadless=(
-  lib/libawt_xawt.so
-  lib/libjawt.so
-  lib/libjsound.so
-  lib/libsplashscreen.so
-)
-
-_common=(
-  'java-runtime-common>=3'
-  ca-certificates-utils
-  freetype2
-  gcc14-libs
-  glibc
-  harfbuzz
-  lcms2
-  libfreetype.so
-  libharfbuzz.so
-  libjpeg.so
-  libjpeg-turbo
-  liblcms2.so
-  libnet
-  nss
-)
+_nonheadless=(lib/libawt_xawt.so
+              lib/libjawt.so
+              lib/libjsound.so
+              lib/libsplashscreen.so)
+
+_commondeps=('java-runtime-common>=3' 'ca-certificates-utils' 'nss' 'libjpeg-turbo' 'libjpeg.so'
+           'lcms2' 'liblcms2.so' 'libnet' 'freetype2' 'libfreetype.so' 'harfbuzz' 'libharfbuzz.so'
+           'glibc' 'gcc-libs')
 
 build() {
   cd ${_jdkdir}
 
-  local MAKEFLAG_J=$(echo ${MAKEFLAGS} | sed -En 's/.*-j([0-9]+).*/\1/p')
-  export MAKEFLAGS=${MAKEFLAGS/-j${MAKEFLAG_J}/}
+  NUM_PROC_OPT=''
+  MAKEFLAG_J=$(echo ${MAKEFLAGS} | sed -En 's/.*-j([0-9]+).*/\1/p')
+  if [ -n "${MAKEFLAG_J}" ]; then
+    echo "Removing '-j${MAKEFLAG_J}' from MAKEFLAGS to prevent build fail. Passing it directly to ./configure."
+    export MAKEFLAGS=${MAKEFLAGS/-j${MAKEFLAG_J}/}
+    NUM_PROC_OPT="--with-num-cores=${MAKEFLAG_J}"
+  fi
 
   local _CFLAGS="${CFLAGS//-O2/-O3} ${CPPFLAGS} -fcommon"
   local _CXXFLAGS="${CXXFLAGS//-O2/-O3} ${CPPFLAGS} -fcommon"
@@ -113,10 +71,6 @@
   unset CFLAGS
   unset CXXFLAGS
   unset LDFLAGS
-
-  export CC="gcc-14"
-  export CXX="g++-14"
-  export CXXCPP="gcc-14 -E"
 
   bash configure \
     --with-version-build="${_updatever}" \
@@ -136,7 +90,8 @@
     --with-native-debug-symbols=internal \
     --enable-unlimited-crypto \
     --disable-warnings-as-errors \
-    --with-vendor-name="Arch Linux"
+    --with-vendor-name="Artix Linux" \
+    ${NUM_PROC_OPT}
 
   make images legacy-jre-image docs
 
@@ -150,34 +105,23 @@
 package_jre11-openjdk-headless() {
   pkgdesc="OpenJDK Java ${_majorver} headless runtime environment"
   depends=("${_commondeps[@]}")
-  optdepends=(
-    'java-rhino: for some JavaScript support'
-  )
-  provides=(
-    "java-runtime-headless=${_majorver}"
-    "java-runtime-headless-openjdk=${_majorver}"
-    "jre${_majorver}-openjdk-headless=${pkgver}-${pkgrel}"
-  )
-  conflicts=(
-    jdk11-openjdk
-    jre11-openjdk
-  )
-  backup=(
-    etc/${pkgbase}/logging.properties
-    etc/${pkgbase}/management/jmxremote.access
-    etc/${pkgbase}/management/jmxremote.password.template
-    etc/${pkgbase}/management/management.properties
-    etc/${pkgbase}/net.properties
-    etc/${pkgbase}/security/java.policy
-    etc/${pkgbase}/security/java.security
-    etc/${pkgbase}/security/policy/README.txt
-    etc/${pkgbase}/security/policy/limited/default_US_export.policy
-    etc/${pkgbase}/security/policy/limited/default_local.policy
-    etc/${pkgbase}/security/policy/limited/exempt_local.policy
-    etc/${pkgbase}/security/policy/unlimited/default_US_export.policy
-    etc/${pkgbase}/security/policy/unlimited/default_local.policy
-    etc/${pkgbase}/sound.properties
-  )
+  optdepends=('java-rhino: for some JavaScript support')
+  provides=("java-runtime-headless=${_majorver}" "java-runtime-headless-openjdk=${_majorver}" "jre${_majorver}-openjdk-headless=${pkgver}-${pkgrel}")
+  conflicts=("jdk11-openjdk" "jre11-openjdk")
+  backup=(etc/${pkgbase}/logging.properties
+          etc/${pkgbase}/management/jmxremote.access
+          etc/${pkgbase}/management/jmxremote.password.template
+          etc/${pkgbase}/management/management.properties
+          etc/${pkgbase}/net.properties
+          etc/${pkgbase}/security/java.policy
+          etc/${pkgbase}/security/java.security
+          etc/${pkgbase}/security/policy/README.txt
+          etc/${pkgbase}/security/policy/limited/default_US_export.policy
+          etc/${pkgbase}/security/policy/limited/default_local.policy
+          etc/${pkgbase}/security/policy/limited/exempt_local.policy
+          etc/${pkgbase}/security/policy/unlimited/default_US_export.policy
+          etc/${pkgbase}/security/policy/unlimited/default_local.policy
+          etc/${pkgbase}/sound.properties)
   install=install_jre-openjdk-headless.sh
 
   cd ${_imgdir}/jre
@@ -213,43 +157,26 @@
 
 package_jre11-openjdk() {
   pkgdesc="OpenJDK Java ${_majorver} full runtime environment"
-  depends=(
-    "${_commondeps[@]}"
-    giflib
-    libgif.so
-    libpng
-  )
-  optdepends=(
-    'alsa-lib: for basic sound support'
-    'gtk3: for the Gtk+ 3 look and feel - desktop usage'
-  )
-  provides=(
-    "java-runtime=${_majorver}" "java-runtime-openjdk=${_majorver}"
-    "jre${_majorver}-openjdk=${pkgver}-${pkgrel}"
-    "java-runtime-headless=${_majorver}"
-    "java-runtime-headless-openjdk=${_majorver}"
-    "jre${_majorver}-openjdk-headless=${pkgver}-${pkgrel}"
-  )
-  conflicts=(
-    jdk11-openjdk
-    jre11-openjdk-headless
-  )
-  backup=(
-    etc/${pkgbase}/logging.properties
-    etc/${pkgbase}/management/jmxremote.access
-    etc/${pkgbase}/management/jmxremote.password.template
-    etc/${pkgbase}/management/management.properties
-    etc/${pkgbase}/net.properties
-    etc/${pkgbase}/security/java.policy
-    etc/${pkgbase}/security/java.security
-    etc/${pkgbase}/security/policy/README.txt
-    etc/${pkgbase}/security/policy/limited/default_US_export.policy
-    etc/${pkgbase}/security/policy/limited/default_local.policy
-    etc/${pkgbase}/security/policy/limited/exempt_local.policy
-    etc/${pkgbase}/security/policy/unlimited/default_US_export.policy
-    etc/${pkgbase}/security/policy/unlimited/default_local.policy
-    etc/${pkgbase}/sound.properties
-  )
+  depends=("${_commondeps[@]}" 'giflib' 'libgif.so' 'libpng')
+  optdepends=('alsa-lib: for basic sound support'
+              'gtk3: for the Gtk+ 3 look and feel - desktop usage')
+  provides=("java-runtime=${_majorver}" "java-runtime-openjdk=${_majorver}" "jre${_majorver}-openjdk=${pkgver}-${pkgrel}"
+            "java-runtime-headless=${_majorver}" "java-runtime-headless-openjdk=${_majorver}" "jre${_majorver}-openjdk-headless=${pkgver}-${pkgrel}")
+  conflicts=("jdk11-openjdk" "jre11-openjdk-headless")
+  backup=(etc/${pkgbase}/logging.properties
+          etc/${pkgbase}/management/jmxremote.access
+          etc/${pkgbase}/management/jmxremote.password.template
+          etc/${pkgbase}/management/management.properties
+          etc/${pkgbase}/net.properties
+          etc/${pkgbase}/security/java.policy
+          etc/${pkgbase}/security/java.security
+          etc/${pkgbase}/security/policy/README.txt
+          etc/${pkgbase}/security/policy/limited/default_US_export.policy
+          etc/${pkgbase}/security/policy/limited/default_local.policy
+          etc/${pkgbase}/security/policy/limited/exempt_local.policy
+          etc/${pkgbase}/security/policy/unlimited/default_US_export.policy
+          etc/${pkgbase}/security/policy/unlimited/default_local.policy
+          etc/${pkgbase}/sound.properties)
   install=install_jre-openjdk.sh
 
   cd ${_imgdir}/jre
@@ -291,61 +218,32 @@
 
 package_jdk11-openjdk() {
   pkgdesc="OpenJDK Java ${_majorver} development kit"
-  depends=(
-    "${_commondeps[@]}"
-    'java-environment-common=3'
-    ca-certificates-utils
-    freetype2
-    harfbuzz
-    hicolor-icon-theme
-    lcms2
-    libelf
-    libfreetype.so
-    libgif.so
-    libharfbuzz.so
-    libjpeg.so
-    libjpeg-turbo
-    liblcms2.so
-    libnet
-    libpng
-    nss
-  )
-  optdepends=(
-    'java-rhino: for some JavaScript support'
-    'alsa-lib: for basic sound support'
-    'gtk3: for the Gtk+ 3 look and feel - desktop usage'
-  )
-  provides=(
-    "java-environment=${_majorver}"
-    "java-environment-openjdk=${_majorver}"
-    "jdk${_majorver}-openjdk=${pkgver}-${pkgrel}"
-    "java-runtime=${_majorver}"
-    "java-runtime-openjdk=${_majorver}"
-    "jre${_majorver}-openjdk=${pkgver}-${pkgrel}"
-    "java-runtime-headless=${_majorver}"
-    "java-runtime-headless-openjdk=${_majorver}"
-    "jre${_majorver}-openjdk-headless=${pkgver}-${pkgrel}"
-  )
-  conflicts=(
-    jre11-openjdk
-    jre11-openjdk-headless
-  )
-  backup=(
-    etc/${pkgbase}/logging.properties
-    etc/${pkgbase}/management/jmxremote.access
-    etc/${pkgbase}/management/jmxremote.password.template
-    etc/${pkgbase}/management/management.properties
-    etc/${pkgbase}/net.properties
-    etc/${pkgbase}/security/java.policy
-    etc/${pkgbase}/security/java.security
-    etc/${pkgbase}/security/policy/README.txt
-    etc/${pkgbase}/security/policy/limited/default_US_export.policy
-    etc/${pkgbase}/security/policy/limited/default_local.policy
-    etc/${pkgbase}/security/policy/limited/exempt_local.policy
-    etc/${pkgbase}/security/policy/unlimited/default_US_export.policy
-    etc/${pkgbase}/security/policy/unlimited/default_local.policy
-    etc/${pkgbase}/sound.properties
-  )
+  depends=("${_commondeps[@]}" 'java-environment-common=3'
+           'hicolor-icon-theme' 'libelf' 'libgif.so' 'libpng'
+           'ca-certificates-utils' 'nss' 'libjpeg-turbo' 'libjpeg.so'
+           'lcms2' 'liblcms2.so' 'libnet' 'freetype2' 'libfreetype.so' 'harfbuzz'
+           'libharfbuzz.so')
+  optdepends=('java-rhino: for some JavaScript support'
+              'alsa-lib: for basic sound support'
+              'gtk3: for the Gtk+ 3 look and feel - desktop usage')
+  provides=("java-environment=${_majorver}" "java-environment-openjdk=${_majorver}" "jdk${_majorver}-openjdk=${pkgver}-${pkgrel}"
+            "java-runtime=${_majorver}" "java-runtime-openjdk=${_majorver}" "jre${_majorver}-openjdk=${pkgver}-${pkgrel}"
+            "java-runtime-headless=${_majorver}" "java-runtime-headless-openjdk=${_majorver}" "jre${_majorver}-openjdk-headless=${pkgver}-${pkgrel}")
+  conflicts=("jre11-openjdk" "jre11-openjdk-headless")
+  backup=(etc/${pkgbase}/logging.properties
+          etc/${pkgbase}/management/jmxremote.access
+          etc/${pkgbase}/management/jmxremote.password.template
+          etc/${pkgbase}/management/management.properties
+          etc/${pkgbase}/net.properties
+          etc/${pkgbase}/security/java.policy
+          etc/${pkgbase}/security/java.security
+          etc/${pkgbase}/security/policy/README.txt
+          etc/${pkgbase}/security/policy/limited/default_US_export.policy
+          etc/${pkgbase}/security/policy/limited/default_local.policy
+          etc/${pkgbase}/security/policy/limited/exempt_local.policy
+          etc/${pkgbase}/security/policy/unlimited/default_US_export.policy
+          etc/${pkgbase}/security/policy/unlimited/default_local.policy
+          etc/${pkgbase}/sound.properties)
   install=install_jdk-openjdk.sh
 
   cd ${_imgdir}/jdk


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,11 +1,9 @@
-
 alsa-lib
 bash
 ca-certificates-utils
 cpio
 freetype2
-gcc14
-gcc14-libs
+gcc-libs
 giflib
 glibc
 graphviz
@@ -13,6 +11,7 @@
 hicolor-icon-theme
 java-environment
 java-environment-common
+java-runtime-common>
 jdk11-openjdk
 lcms2
 libcups

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,7 +1,12 @@
 build() {
 cd ${_jdkdir}
-local MAKEFLAG_J=$(echo ${MAKEFLAGS} | sed -En 's/.*-j([0-9]+).*/\1/p')
+NUM_PROC_OPT=''
+MAKEFLAG_J=$(echo ${MAKEFLAGS} | sed -En 's/.*-j([0-9]+).*/\1/p')
+if [ -n "${MAKEFLAG_J}" ]; then
+echo "Removing '-j${MAKEFLAG_J}' from MAKEFLAGS to prevent build fail. Passing it directly to ./configure."
 export MAKEFLAGS=${MAKEFLAGS/-j${MAKEFLAG_J}/}
+NUM_PROC_OPT="--with-num-cores=${MAKEFLAG_J}"
+fi
 local _CFLAGS="${CFLAGS//-O2/-O3} ${CPPFLAGS} -fcommon"
 local _CXXFLAGS="${CXXFLAGS//-O2/-O3} ${CPPFLAGS} -fcommon"
 local _LDFLAGS=${LDFLAGS}
@@ -13,9 +18,6 @@
 unset CFLAGS
 unset CXXFLAGS
 unset LDFLAGS
-export CC="gcc-14"
-export CXX="g++-14"
-export CXXCPP="gcc-14 -E"
 bash configure \
 --with-version-build="${_updatever}" \
 --with-version-pre="" \
@@ -34,7 +36,8 @@
 --with-native-debug-symbols=internal \
 --enable-unlimited-crypto \
 --disable-warnings-as-errors \
---with-vendor-name="Arch Linux"
+--with-vendor-name="Artix Linux" \
+${NUM_PROC_OPT}
 make images legacy-jre-image docs
 find "${srcdir}/${_imgdir}" -iname '*.so' -exec chmod +x {} \;
 }
