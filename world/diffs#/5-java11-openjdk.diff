--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -25,6 +25,8 @@
   bash
   cpio
   freetype2
+  gcc14
+  gcc14-libs
   giflib
   glibc
   graphviz
@@ -51,13 +53,11 @@
 options=(!lto)
 source=(
   https://github.com/openjdk/jdk${_majorver}u/archive/${_git_tag}.tar.gz
-  0001-java11-Build-failure-with-glibc-2.42-due-to-uabs-na.patch::https://github.com/openjdk/jdk11u-dev/commit/fa28fbdc260351ff9ae735e473b3d0d9bdc659bf.patch?full_index=1
   freedesktop-java.desktop
   freedesktop-jconsole.desktop
   freedesktop-jshell.desktop
 )
 sha256sums=('fa53248e26ccf0635483b8cb6be7dc577548831e1ce421def2782d1e2373ce46'
-            'ea0d37b6901d3aae64a551e19dd4f7de5d75b8d9fabc1c219bf0654f8bd70045'
             '575587ad58dfa9908f046d307b9afc7b0b2eb20a1eb454f8fdbbd539ea7b3d01'
             '2f57b7c7dd671eabe9fa10c4f1283573e99d7f7c36eccd82c95b705979a2e8cb'
             'f271618a8c2a892b554caf26857af41efdf0d8bcb95d57ce7ba535d6979e96da')
@@ -65,7 +65,6 @@
 case "${CARCH}" in
   x86_64) _JARCH='x86_64';;
   i686)   _JARCH='x86';;
-  aarch64)_JARCH='aarch64';;
 esac
 
 _jvmdir=/usr/lib/jvm/java-${_majorver}-openjdk
@@ -83,6 +82,7 @@
   'java-runtime-common>=3'
   ca-certificates-utils
   freetype2
+  gcc14-libs
   glibc
   harfbuzz
   lcms2
@@ -95,10 +95,6 @@
   nss
 )
 
-prepare() {
-  patch -Np1 -i ../0001-java11-Build-failure-with-glibc-2.42-due-to-uabs-na.patch -d ${_jdkdir}
-}
-
 build() {
   cd ${_jdkdir}
 
@@ -108,18 +104,19 @@
   local _CFLAGS="${CFLAGS//-O2/-O3} ${CPPFLAGS} -fcommon"
   local _CXXFLAGS="${CXXFLAGS//-O2/-O3} ${CPPFLAGS} -fcommon"
   local _LDFLAGS=${LDFLAGS}
-
   if [[ ${CARCH} = i686 ]]; then
     echo "Removing '-fno-plt' from CFLAGS and CXXFLAGS to prevent build fail with this architecture"
     _CFLAGS=${CFLAGS/-fno-plt/}
     _CXXFLAGS=${CXXFLAGS/-fno-plt/}
   fi
 
-  _CFLAGS+=' -std=gnu17'
-
   unset CFLAGS
   unset CXXFLAGS
   unset LDFLAGS
+
+  export CC="gcc-14"
+  export CXX="g++-14"
+  export CXXCPP="gcc-14 -E"
 
   bash configure \
     --with-version-build="${_updatever}" \
@@ -139,7 +136,7 @@
     --with-native-debug-symbols=internal \
     --enable-unlimited-crypto \
     --disable-warnings-as-errors \
-    --with-vendor-name="Arch Linux"
+    --with-vendor-name="Artix Linux"
 
   make images legacy-jre-image docs
 


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -3,6 +3,8 @@
 ca-certificates-utils
 cpio
 freetype2
+gcc14
+gcc14-libs
 giflib
 glibc
 graphviz

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,6 +1,3 @@
-prepare() {
-patch -Np1 -i ../0001-java11-Build-failure-with-glibc-2.42-due-to-uabs-na.patch -d ${_jdkdir}
-}
 build() {
 cd ${_jdkdir}
 local MAKEFLAG_J=$(echo ${MAKEFLAGS} | sed -En 's/.*-j([0-9]+).*/\1/p')
@@ -13,10 +10,12 @@
 _CFLAGS=${CFLAGS/-fno-plt/}
 _CXXFLAGS=${CXXFLAGS/-fno-plt/}
 fi
-_CFLAGS+=' -std=gnu17'
 unset CFLAGS
 unset CXXFLAGS
 unset LDFLAGS
+export CC="gcc-14"
+export CXX="g++-14"
+export CXXCPP="gcc-14 -E"
 bash configure \
 --with-version-build="${_updatever}" \
 --with-version-pre="" \
@@ -35,7 +34,7 @@
 --with-native-debug-symbols=internal \
 --enable-unlimited-crypto \
 --disable-warnings-as-errors \
---with-vendor-name="Arch Linux"
+--with-vendor-name="Artix Linux"
 make images legacy-jre-image docs
 find "${srcdir}/${_imgdir}" -iname '*.so' -exec chmod +x {} \;
 }
