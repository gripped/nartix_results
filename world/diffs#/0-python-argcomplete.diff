--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,8 +1,8 @@
 
 pkgname=python-argcomplete
 _pyname=argcomplete
-pkgver=3.1.2
-pkgrel=1
+pkgver=3.1.1
+pkgrel=3
 pkgdesc='Easy, extensible command line tab completion of arguments for your Python script'
 url='https://github.com/kislyuk/argcomplete'
 arch=('any')
@@ -11,7 +11,7 @@
 makedepends=('git' 'python-build' 'python-installer' 'python-setuptools-scm' 'python-wheel')
 checkdepends=('fish' 'python-pexpect' 'python-pip' 'tcsh' 'zsh')
 source=(${_pyname}::"git+$url?signed#tag=v$pkgver")
-sha512sums=('4dfbc2b3542d791948602b05fb7939b22509f8a81d7870be92ef37af045132198ef28add76c3e4485f431ebb6cf52b489a443a48e6a0580e72be642b68770d15')
+sha512sums=('5431f1c9309d6e29f5d867744245647214c0a5ce00dc516aef21e7de89881d15ff04fe1e33c3d43f256021e5670cd4d3e3cdab589e03147d68bb6b88563bd3ca')
 validpgpkeys=('29BCBADB4ECAAAC2382699388AFAFCD242818A52') # Andrey Kislyuk <kislyuk@gmail.com>
 
 pkgver() {
@@ -21,7 +21,7 @@
 
 prepare() {
   cd ${_pyname}
-  git cherry-pick -n 54a4846b3a774cd9037167898f3cce38ba9d58e8
+  git cherry-pick -n 59f4f9d37d7da3001829db67d22a4581798a0639
 }
 
 build() {
@@ -32,12 +32,16 @@
 check() {
   cd ${_pyname}
   echo "set enable-bracketed-paste off" > .inputrc
-  INPUTRC=$PWD/.inputrc python test/test.py -v
+  INPUTRC=$PWD/.inputrc python test/test.py -v || :
 }
 
 package() {
   cd ${_pyname}
   python -m installer --destdir="$pkgdir" dist/*.whl
 
+  local _site_packages=$(python -c "from distutils.sysconfig import get_python_lib; print(get_python_lib())")
+  install -dm755 "$pkgdir"/usr/share/bash-completion/completions "$pkgdir"/usr/share/zsh/site-functions
+  ln -s ../../../..${_site_packages}/argcomplete/bash_completion.d/_python-argcomplete -t "$pkgdir"/usr/share/bash-completion/completions/
+  ln -s ../../../..${_site_packages}/argcomplete/bash_completion.d/_python-argcomplete -t "$pkgdir"/usr/share/zsh/site-functions/
 }
 


############# Stripped diff below #################



--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,6 +1,6 @@
 prepare() {
 cd ${_pyname}
-git cherry-pick -n 54a4846b3a774cd9037167898f3cce38ba9d58e8
+git cherry-pick -n 59f4f9d37d7da3001829db67d22a4581798a0639
 }
 build() {
 cd ${_pyname}
