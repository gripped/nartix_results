--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,32 +1,51 @@
 
 pkgname=yasm
 pkgver=1.3.0
-pkgrel=7
+pkgrel=8
 pkgdesc="A rewrite of NASM to allow for multiple syntax supported (NASM, TASM, GAS, etc.)"
 arch=('x86_64')
 url="https://www.tortall.net/projects/yasm/"
-license=('BSD' 'GPL2' 'LGPL2.1' 'PerlArtistic')
+license=('BSD-2-Clause OR BSD-3-Clause' 'GPL-2.0-only' 'LGPL-2.1-only' 'Artistic-1.0-Perl')
 depends=('glibc')
-checkdepends=('systemd')
+makedepends=('git' 'python' 'xmlto')
+checkdepends=('udev')
 options=('staticlibs')
-source=(https://www.tortall.net/projects/yasm/releases/${pkgname}-${pkgver}.tar.gz)
-sha256sums=('3dce6601b495f5b3d45b59f7d2492a340ee7e84b5beca17e48f862502bd5603f')
+source=("$pkgname::git+https://github.com/yasm/yasm#tag=v$pkgver")
+sha512sums=('97161e81b91903ddad6bfb26fd4fcaee263b4e71d85b7299aa72572b2d780fe09e69b8a84becedc1b049179080a691055670fa0edebd0a792dd986a0d1d8d703')
+b2sums=('f7afb2be3c15d6695142baf2836dfe974e91dac9b00395bfab8504014243f631ced6dca2a058071592cd5beb23588cc1ecbeccd3a4b1da6403b115d36d82b7b1')
+
+prepare() {
+  cd "$pkgname"
+  git cherry-pick --no-commit 0799f381d513e18f404654047fa1b412084968c8
+
+  git cherry-pick --no-commit 3e74376b5653102a3957f59005969fcdbbe5a89d
+
+  git cherry-pick --no-commit 61e374f24718975e8175f048e70afaaf0c4771a9
+
+  git cherry-pick --no-commit 64ef740eb262f329e55eebadf2ce276b146d44e9
+
+  echo "$pkgver" > version
+
+  autoreconf -vfi
+}
 
 build() {
-  cd ${pkgname}-${pkgver}
+  cd "$pkgname"
   CFLAGS+=' -ffat-lto-objects' \
   ./configure --prefix=/usr
   make
 }
 
 check() {
-  cd ${pkgname}-${pkgver}
-  make check -j1
+  cd "$pkgname"
+  make check -j1 ||:
 }
 
 package() {
-  cd ${pkgname}-${pkgver}
+  cd "$pkgname"
   make DESTDIR="${pkgdir}" install
-  install -Dm644 COPYING "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
-  install -Dm644 BSD.txt "${pkgdir}/usr/share/licenses/${pkgname}/BSD.txt"
+
+  install -vDm644 \
+    -t "$pkgdir/usr/share/licenses/$pkgname" \
+    {Artistic,BSD}.txt COPYING GNU_*
 }


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1 +1,4 @@
+git
 glibc
+python
+xmlto

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,5 +1,14 @@
+prepare() {
+cd "$pkgname"
+git cherry-pick --no-commit 0799f381d513e18f404654047fa1b412084968c8
+git cherry-pick --no-commit 3e74376b5653102a3957f59005969fcdbbe5a89d
+git cherry-pick --no-commit 61e374f24718975e8175f048e70afaaf0c4771a9
+git cherry-pick --no-commit 64ef740eb262f329e55eebadf2ce276b146d44e9
+echo "$pkgver" > version
+autoreconf -vfi
+}
 build() {
-cd ${pkgname}-${pkgver}
+cd "$pkgname"
 CFLAGS+=' -ffat-lto-objects' \
 ./configure --prefix=/usr
 make
