--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -2,50 +2,42 @@
 _pkgname=CGNS
 pkgname=cgns
 pkgver=4.5.0
-pkgrel=2
+pkgrel=1
 pkgdesc="Standard for recording and recovering computer data associated with the numerical solution of fluid dynamics equations"
 arch=(x86_64)
 url="https://cgns.github.io/"
-license=(Zlib)
-depends=(
-  gcc-libs
-  glibc
-  glu
-  hdf5
-  libxmu
-  tk
-)
-makedepends=(
-  cmake
-  gcc-fortran
-)
-source=("https://github.com/$_pkgname/$_pkgname/archive/v$pkgver/$pkgname-$pkgver.tar.gz")
-sha512sums=('0286ff2faf9102e5fb6d9bed764fd553756d62ae9be9dbb8b37ba6e2d3a7fec9337715320ec38a001960e39d397e846f2adbd4b54930c20e0304edacdd48fc92')
+license=(custom)
+depends=(tk hdf5 libxmu glu)
+makedepends=(gcc-fortran cmake)
+options=(!makeflags)
+source=(https://github.com/${_pkgname}/${_pkgname}/archive/v${pkgver}/${pkgname}-${pkgver}.tar.gz)
+sha256sums=('c72355219318755ba0a8646a8e56ee1c138cf909c1d738d258d2774fa4b529e9')
+
 
 build() {
-  cmake -B build -S ${_pkgname}-${pkgver} \
-    -DCMAKE_BUILD_TYPE=None \
-    -DCMAKE_INSTALL_PREFIX=/usr \
-    -Wno-dev \
-    -DCGNS_BUILD_CGNSTOOLS=ON \
-    -DCGNS_BUILD_SHARED=ON \
-    -DCGNS_ENABLE_64BIT=ON \
-    -DCGNS_ENABLE_FORTRAN=ON \
-    -DCGNS_ENABLE_HDF5=ON \
-    -DCGNS_ENABLE_LEGACY=ON \
-    -DCGNS_ENABLE_SCOPING=OFF \
-    -DCGNS_ENABLE_TESTS=ON \
-    -DCMAKE_SKIP_RPATH=ON
-  cmake --build build
+    CFLAGS+=" -Wno-implicit-function-declaration -Wno-incompatible-pointer-types" \
+    cmake -B build -S ${_pkgname}-${pkgver} \
+        -DCGNS_BUILD_CGNSTOOLS=ON \
+        -DCGNS_BUILD_SHARED=ON \
+        -DCGNS_ENABLE_64BIT=ON \
+        -DCGNS_ENABLE_FORTRAN=ON \
+        -DCGNS_ENABLE_HDF5=ON \
+        -DCGNS_ENABLE_LEGACY=ON \
+        -DCGNS_ENABLE_SCOPING=OFF \
+        -DCGNS_ENABLE_TESTS=ON \
+        -DCMAKE_BUILD_TYPE="Release" \
+        -DCMAKE_INSTALL_PREFIX=/usr \
+        -DCMAKE_SKIP_RPATH=ON
+    make -C build
 }
 
+
 check() {
-  LD_LIBRARY_PATH="$srcdir/build/src" \
-    ctest --test-dir build --output-on-failure
+    LD_LIBRARY_PATH="${srcdir}"/build/src/ make -C build test
 }
 
 package() {
-  DESTDIR="$pkgdir" cmake --install build
-  install -vDm644 -t "$pkgdir/usr/share/licenses/$pkgname" $_pkgname-$pkgver/license.txt
-  rm "$pkgdir/usr/bin/"*.desktop
+    make -C build DESTDIR="${pkgdir}" install
+    install -Dm644 ${_pkgname}-${pkgver}/license.txt -t "${pkgdir}"/usr/share/licenses/${pkgname}/
+    rm "${pkgdir}"/usr/bin/*.desktop
 }


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,7 +1,5 @@
 cmake
 gcc-fortran
-gcc-libs
-glibc
 glu
 hdf5
 libxmu

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,8 +1,6 @@
 build() {
+CFLAGS+=" -Wno-implicit-function-declaration -Wno-incompatible-pointer-types" \
 cmake -B build -S ${_pkgname}-${pkgver} \
--DCMAKE_BUILD_TYPE=None \
--DCMAKE_INSTALL_PREFIX=/usr \
--Wno-dev \
 -DCGNS_BUILD_CGNSTOOLS=ON \
 -DCGNS_BUILD_SHARED=ON \
 -DCGNS_ENABLE_64BIT=ON \
@@ -11,6 +9,8 @@
 -DCGNS_ENABLE_LEGACY=ON \
 -DCGNS_ENABLE_SCOPING=OFF \
 -DCGNS_ENABLE_TESTS=ON \
+-DCMAKE_BUILD_TYPE="Release" \
+-DCMAKE_INSTALL_PREFIX=/usr \
 -DCMAKE_SKIP_RPATH=ON
-cmake --build build
+make -C build
 }
