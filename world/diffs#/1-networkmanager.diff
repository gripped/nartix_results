--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -6,7 +6,7 @@
   nm-cloud-setup
   networkmanager-docs
 )
-pkgver=1.54.3
+pkgver=1.54.2
 pkgrel=1
 pkgdesc="Network connection manager and user applications"
 url="https://networkmanager.dev/"
@@ -47,8 +47,7 @@
   ppp
   python-gobject
   readline
-  systemd
-  systemd-libs
+  elogind
   vala
   vala
   wpa_supplicant
@@ -60,7 +59,7 @@
 source=(
   "git+https://gitlab.freedesktop.org/NetworkManager/NetworkManager.git?signed#tag=${pkgver/[a-z]/-&}"
 )
-b2sums=('5da0800e5ea38f8eda955bf854c778b93e3a17b80da8602b48e017e66e74392caf9458701f6b7a4b9de85108d30ecd89d5491bd26123925228b6788d3b6aae32')
+b2sums=('d2006832430d95898e183c3a926a747e021726855900f245fffd19076340ea77ec6dac2ffad2bc389479d7ed571bddaacaa1eee257c59352dc9de92caaabb076')
 validpgpkeys=(
   3D10AD045AB4AAFF8E8F36AF9B980AC2FB874FEB # Ana Cabral <acabral@redhat.com>
   F07F7C1EABD382F81CBFBA3B998D4828CD7E1656 # Beniamino Galvani <bgalvani@redhat.com>
@@ -72,11 +71,12 @@
   49EA7C670E0850E7419514F629C2366E4DFC5728 # Thomas Haller <thaller@redhat.com>
   07F9AEC86144386D9576210B66A44781B4EBC2D0 # Íñigo Huguet <ihuguet@redhat.com>
   8D1F4C471D38D59A56301CEBE1974C8D8DD6ED2A # Filip Pokryvka <fpokryvk@redhat.com>
-  1CFF865BDF957BE935765BBD2E1878D078DEF7C6 # Íñigo Huguet <ihuguet@riseup.net>
 )
 
 prepare() {
   cd NetworkManager
+
+  git cherry-pick -n 12eff9a7fdfeabab12ce56e5f7d515a13a3d704c
 }
 
 build() {
@@ -85,9 +85,12 @@
 
     -D dist_version="$pkgver-$pkgrel"
     -D session_tracking_consolekit=false
-    -D suspend_resume=systemd
+    -D suspend_resume=elogind
     -D modify_system=true
     -D selinux=false
+    -D systemdsystemunitdir=no
+    -D session_tracking=elogind
+    -D systemd_journal=false
 
     -D iwd=true
     -D teamdctl=true
@@ -105,7 +108,7 @@
     -D qt=false
   )
 
-  arch-meson NetworkManager build "${meson_options[@]}"
+  artix-meson NetworkManager build "${meson_options[@]}"
   meson compile -C build
 }
 
@@ -136,13 +139,14 @@
     libndp
     libnewt
     libnm
+    libnvme
     libpsl
     libteam
     mobile-broadband-provider-info
+    elogind
     nspr
     nss
     readline
-    systemd-libs
     wpa_supplicant
   )
   optdepends=(
@@ -152,7 +156,6 @@
     'firewalld: firewall support'
     'iptables: connection sharing'
     'iwd: wpa_supplicant alternative'
-    'libnvme: NBFT support'
     'modemmanager: cellular network support'
     'nftables: connection sharing'
     'openresolv: alternative resolv.conf manager'
@@ -185,7 +188,6 @@
   _pick libnm usr/include/libnm
   _pick libnm usr/lib/girepository-1.0/NM-*
   _pick libnm usr/lib/libnm.*
-  _pick libnm usr/lib/nm-libnm-helper
   _pick libnm usr/lib/pkgconfig/libnm.pc
   _pick libnm usr/share/gir-1.0/NM-*
   _pick libnm usr/share/vala/vapi/libnm.*
@@ -193,7 +195,6 @@
   _pick cloud usr/lib/**/*nm-cloud-setup*
   _pick cloud usr/share/man/*/nm-cloud-setup*
 
-  _pick ovs usr/lib/systemd/system/NetworkManager.service.d/NetworkManager-ovs.conf
 
   install -d usr/lib/NetworkManager/dispatcher.d/no-wait.d
 }
@@ -206,8 +207,8 @@
     glibc
     nspr
     nss
-    systemd-libs
     util-linux-libs
+    libelogind
   )
   provides=(libnm.so)
 
@@ -222,7 +223,6 @@
     gcc-libs
     glib2
     glibc
-    jansson
     libnm
     networkmanager
   )


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -4,6 +4,7 @@
 curl
 dhcpcd
 dnsmasq
+elogind
 gcc-libs
 git
 glib2
@@ -15,6 +16,7 @@
 iptables
 iwd
 jansson
+libelogind
 libmm-glib
 libndp
 libnewt
@@ -36,8 +38,6 @@
 ppp
 python-gobject
 readline
-systemd
-systemd-libs
 util-linux-libs
 vala
 wpa_supplicant