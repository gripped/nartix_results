--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,28 +1,27 @@
 
 pkgname=pyprof2calltree
 pkgver=1.4.5
-pkgrel=10
+pkgrel=8
 pkgdesc="Help visualize profiling data from cProfile with kcachegrind"
-url="https://github.com/pwaller/pyprof2calltree"
+url="https://pypi.python.org/pypi/pyprof2calltree/"
 arch=('any')
-license=('MIT')
+license=('BSD')
 depends=('python')
-makedepends=('python-setuptools' 'python-build' 'python-installer' 'python-wheel')
-source=("$pkgname-$pkgver.tar.gz::$url/archive/refs/tags/v$pkgver.tar.gz")
-sha512sums=('2fcda74ae67dc3a8abb5dc153864ef59f96cc62b1c9359d02be12e83966c17738f5aa4a3d1c6e2ff81614dc963fc4b2faf375bbbb1ad15650a6817e493cdde39')
+makedepends=('python-setuptools')
+source=("https://pypi.io/packages/source/p/pyprof2calltree/pyprof2calltree-$pkgver.tar.gz")
+sha512sums=('9ad50a5c00881cbd8c361726b16fcb407c899c8dfe201769eddf10c3541531491f49cd5a08658b70d1e85e4c00d9a89801d600ab4f7d9906d357a0de82784f9e')
+
+prepare() {
+  sed -n '/# Copyright/,/# THE SOFTWARE\./p' pyprof2calltree-$pkgver/pyprof2calltree.py > LICENSE
+}
 
 build() {
-  cd $pkgname-$pkgver
-  python -m build --wheel --no-isolation
-}
-
-check() {
-  cd $pkgname-$pkgver
-  python -m unittest discover
+  cd "$srcdir"/pyprof2calltree-$pkgver
+  python setup.py build
 }
 
 package() {
-  cd $pkgname-$pkgver
-  python -m installer --destdir="$pkgdir" dist/*.whl
-  install -D -m644 LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname/
+  cd pyprof2calltree-$pkgver
+  python setup.py install --prefix=/usr --root="$pkgdir" --optimize=1
+  install -D -m644 ../LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
 }


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,5 +1,2 @@
 python
-python-build
-python-installer
 python-setuptools
-python-wheel

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,4 +1,7 @@
+prepare() {
+sed -n '/# Copyright/,/# THE SOFTWARE\./p' pyprof2calltree-$pkgver/pyprof2calltree.py > LICENSE
+}
 build() {
-cd $pkgname-$pkgver
-python -m build --wheel --no-isolation
+cd "$srcdir"/pyprof2calltree-$pkgver
+python setup.py build
 }
