--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,63 +1,30 @@
 
 pkgname=calf
-pkgver=0.90.5.2
+pkgver=0.90.4
 pkgrel=1
 pkgdesc='LV2 plug-in suite and standalone Jack host'
 arch=(x86_64)
 url='https://calf-studio-gear.org'
-_url="https://github.com/calf-studio-gear/calf"
-groups=(
-  lv2-plugins
-  pro-audio
-)
-license=(
-  GPL-2.0-or-later
-  LGPL-2.0-or-later
-)
-depends=(
-  cairo
-  expat
-  fluidsynth
-  gcc-libs
-  gdk-pixbuf2
-  glib2
-  glibc
-  gtk2
-  hicolor-icon-theme
-  jack)
-makedepends=(
-  cmake
-  git
-  lv2
-)
-source=("git+$_url#tag=$pkgver")
-b2sums=('1a04be3a801697d12023c481fc799400de9708db68cf2db82102e3333de1c17143c5016725cdc610abc15141849f581b950c51a2fc84c48c6e0a97c2898e568c')
+groups=(lv2-plugins pro-audio)
+license=(LGPL2.1)
+depends=(cairo expat fluidsynth gcc-libs gdk-pixbuf2 glib2 glibc gtk2 hicolor-icon-theme jack)
+makedepends=(git lv2)
+source=("git+https://github.com/calf-studio-gear/calf#tag=$pkgver")
+b2sums=('a5d2ccca675c21e807b4851d26e519beafce5ce159be8e5c711d1dd1febbf17f164dd9e6bc4e776295bfc2132c6ccb67bf4dc0a975acf49f6094bd0ef8f914b1')
 
 prepare() {
-  sed "s/@VERSION@/$pkgver/" $pkgname/$pkgname.desktop.in > $pkgname.desktop
+  cd $pkgname
+  autoreconf -fiv
 }
 
 build() {
-  local cmake_options=(
-    -B build
-    -D CMAKE_BUILD_TYPE=None
-    -D CMAKE_INSTALL_PREFIX=/usr
-    -D WANT_EXPERIMENTAL=ON
-    -S $pkgname
-    -W no-dev
-  )
-
-  cmake "${cmake_options[@]}"
-  cmake --build build --verbose
+  cd $pkgname
+  ./configure --enable-experimental --enable-sse --prefix=/usr --with-lv2
+  sed -i -e 's/ -shared / -Wl,-O1,--as-needed\0/g' libtool
+  make
 }
 
 package() {
-  DESTDIR="$pkgdir" cmake --install build
-
-  install -vDm 644 $pkgname.desktop -t "$pkgdir/usr/share/applications/"
-  install -vDm 644 $pkgname/$pkgname*.1 -t "$pkgdir/usr/share/man/man1/"
-  install -vDm 644 $pkgname/$pkgname.7 -t "$pkgdir/usr/share/man/man7/"
-  install -vDm 644 $pkgname/$pkgname -t "$pkgdir/usr/share/bash-completion/completions/"
-
-  install -Dm644 $pkgname/{AUTHORS,ChangeLog,README.md} -t "$pkgdir/usr/share/doc/$pkgname"
+  make DESTDIR="$pkgdir" install -C $pkgname
+  install -Dm644 $pkgname/{AUTHORS,ChangeLog,README} -t "$pkgdir/usr/share/doc/$pkgname"
 }


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,5 +1,4 @@
 cairo
-cmake
 expat
 fluidsynth
 gcc-libs

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,15 +1,10 @@
 prepare() {
-sed "s/@VERSION@/$pkgver/" $pkgname/$pkgname.desktop.in > $pkgname.desktop
+cd $pkgname
+autoreconf -fiv
 }
 build() {
-local cmake_options=(
--B build
--D CMAKE_BUILD_TYPE=None
--D CMAKE_INSTALL_PREFIX=/usr
--D WANT_EXPERIMENTAL=ON
--S $pkgname
--W no-dev
-)
-cmake "${cmake_options[@]}"
-cmake --build build --verbose
+cd $pkgname
+./configure --enable-experimental --enable-sse --prefix=/usr --with-lv2
+sed -i -e 's/ -shared / -Wl,-O1,--as-needed\0/g' libtool
+make
 }
