--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,16 +1,21 @@
 
+_name=django-allauth
 pkgname=python-django-allauth
-_name=${pkgname#python-}
-pkgver=65.0.2
-pkgrel=1
+pkgver=64.2.1
+pkgrel=2
 pkgdesc="Authentication, registration, account management and 3rd party account authentication"
 arch=(any)
-url="https://codeberg.org/allauth/django-allauth"
+url="https://github.com/pennersr/django-allauth"
 license=(MIT)
 depends=(
   python
   python-asgiref  # implicitly provided via python-django
+  python-cryptography  # implicitly provided via python-requests-oauthlib -> python-oauthlib
   python-django
+  python-openid
+  python-requests
+  python-requests-oauthlib
+  python-pyjwt
 )
 makedepends=(
   python-build
@@ -19,45 +24,34 @@
   python-wheel
 )
 checkdepends=(
-  python-cryptography
   python-fido2
-  python-openid
   python-pillow
   python-pytest
-  python-pytest-asyncio
   python-pytest-django
-  python-pyjwt
   python-qrcode
-  python-requests
-  python-requests-oauthlib
   python-saml
 )
 optdepends=(
-  'python-cryptography: for social account support'
   'python-fido2: for MFA support'
-  'python-openid: for OpenID and Steam support'
-  'python-pyjwt: for social account support'
   'python-qrcode: for MFA support'
-  'python-requests: for social account support'
-  'python-requests-oauthlib: for social account support'
   'python-saml: for SAML support'
 )
-source=($pkgname-$pkgver.tar.gz::$url/archive/$pkgver.tar.gz)
-sha512sums=('9355a170c2eaec14262596714c9b2a5aaec97f4f4835a6c2157e23e7ae0f9c99bb34b8cb3e8ad4887c90725f9bd66efdf800eb5c0ecb0fcd1a3ee1a3690f9f49')
-b2sums=('0a74118b49cb2b471a3eddb9d43095d52287738cd6d715ab9ec80b702611c7650d8a1e601c49b71aae67ed27725e0aa4da5d4deda0053fdc6f5b2e9ec31ff07c')
+source=($_name-$pkgver.tar.gz::$url/archive/$pkgver.tar.gz)
+sha512sums=('9a467a851f138afd739d54bef31bc05765fdbe8d199c05ff4955ba0f10c9b38997782f523990e2f3bae01a3c046ddb9aaf59f59d77c801a022b23d39b26b9258')
+b2sums=('27fd1bf493aadf69574c02dc3971cfbb533c77deffb58ead245a9664afd61d620177c55e87696bb2fe29b89ac4f1cc938e14595a8e2b0681a4c6e9c856d65906')
 
 build() {
-  cd $_name
+  cd $_name-$pkgver
   python -m build --wheel --skip-dependency-check --no-isolation
 }
 
 check() {
-  cd $_name
-  pytest -vv
+  cd $_name-$pkgver
+  python manage.py test allauth
 }
 
 package() {
-  cd $_name
+  cd $_name-$pkgver
   python -m installer --destdir="$pkgdir" dist/*.whl
   install -vDm 644 README.rst -t "$pkgdir/usr/share/doc/$pkgname"
   install -vDm 644 LICENSE -t "$pkgdir/usr/share/licenses/$pkgname"


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,7 +1,12 @@
 python
 python-asgiref
 python-build
+python-cryptography
 python-django
 python-installer
+python-openid
+python-pyjwt
+python-requests
+python-requests-oauthlib
 python-setuptools
 python-wheel

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,4 +1,4 @@
 build() {
-cd $_name
+cd $_name-$pkgver
 python -m build --wheel --skip-dependency-check --no-isolation
 }
