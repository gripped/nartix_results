--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,52 +1,49 @@
 
-pkgbase=lib32-gdk-pixbuf2
-pkgname=(
-  lib32-gdk-pixbuf2
-)
-pkgver=2.42.11
-pkgrel=1
+pkgname=lib32-gdk-pixbuf2
+pkgver=2.42.10
+pkgrel=2.1
 pkgdesc="An image loading library (32-bit)"
 url="https://wiki.gnome.org/Projects/GdkPixbuf"
 arch=(x86_64)
-license=(LGPL-2.0-or-later)
-depends=(
-  gdk-pixbuf2
-  lib32-glib2
-  lib32-glibc
-  lib32-libjpeg
-  lib32-libpng
-  lib32-libtiff
-  shared-mime-info
-)
-makedepends=(
-  git
-  meson
-)
+license=(LGPL)
+depends=(lib32-glib2 lib32-libpng lib32-libtiff lib32-libjpeg gdk-pixbuf2)
+makedepends=(git meson)
 optdepends=(
   "lib32-librsvg: Load .svg, .svgz, and .svg.gz"
 )
+options=(debug)
+_commit=9ac257eb38f772fec4253e8051743029e75a2acd  # tags/2.42.10^0
 source=(
-  "git+https://gitlab.gnome.org/GNOME/gdk-pixbuf.git#tag=$pkgver"
+  "git+https://gitlab.gnome.org/GNOME/gdk-pixbuf.git#commit=$_commit"
   gdk-pixbuf-query-loaders-32.hook
+  multilib.diff
 )
-b2sums=('23af2f9f3cd542e6d6d14203a8037400df1e22e89884bddfc1439195e5c788ceec532a7bdda2c1685bb2355ea1303484872b836fdb6827cd448b57c36e6786a6'
-        '0b432bdeb31acdd66c8a861551cabf4f83efd3c441614dbb64b7ac11fdbb97c76412b5706bb18ff1ed890de0a4c51bf02bb531eb4693e6d68021b5372cb5897a')
+sha256sums=('SKIP'
+            '60f0f8c2c022f9adef0902bdb4b89881e81f3388cd2e2e4830456eea10f49bae'
+            'a87babba459f952148c0e89a046bb5c776e3530d10dd14ee6b9586c92061d500')
+
+pkgver() {
+  cd gdk-pixbuf
+  git describe --tags | sed 's/[^-]*-g/r&/;s/-/+/g'
+}
 
 prepare() {
   cd gdk-pixbuf
+
+  git apply -3 ../multilib.diff
 }
 
 build() {
-  local meson_options=(
-    --cross-file lib32
-    -D builtin_loaders=all
-    -D gtk_doc=false
+  export CC="gcc -m32"
+  export CXX="g++ -m32"
+  export PKG_CONFIG="i686-pc-linux-gnu-pkg-config"
+
+  artix-meson gdk-pixbuf build \
+    --libdir /usr/lib32 \
+    -D builtin_loaders=all \
+    -D introspection=disabled \
+    -D man=false \
     -D installed_tests=false
-    -D introspection=disabled
-    -D man=false
-  )
-
-  arch-meson gdk-pixbuf build "${meson_options[@]}"
   meson compile -C build
 }
 


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -1,9 +1,7 @@
 gdk-pixbuf2
 git
 lib32-glib2
-lib32-glibc
 lib32-libjpeg
 lib32-libpng
 lib32-libtiff
 meson
-shared-mime-info

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,15 +1,16 @@
 prepare() {
 cd gdk-pixbuf
+git apply -3 ../multilib.diff
 }
 build() {
-local meson_options=(
---cross-file lib32
--D builtin_loaders=all
--D gtk_doc=false
+export CC="gcc -m32"
+export CXX="g++ -m32"
+export PKG_CONFIG="i686-pc-linux-gnu-pkg-config"
+artix-meson gdk-pixbuf build \
+--libdir /usr/lib32 \
+-D builtin_loaders=all \
+-D introspection=disabled \
+-D man=false \
 -D installed_tests=false
--D introspection=disabled
--D man=false
-)
-arch-meson gdk-pixbuf build "${meson_options[@]}"
 meson compile -C build
 }
