--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -12,7 +12,7 @@
   'lib32-mesa-vdpau'
   'lib32-mesa'
 )
-pkgver=24.0.1
+pkgver=24.0.3
 pkgrel=1
 epoch=1
 pkgdesc="An open-source implementation of the OpenGL specification (32-bit)"
@@ -39,7 +39,6 @@
   'lib32-rust-libs'
   'lib32-spirv-llvm-translator'
   'lib32-spirv-tools'
-  'lib32-systemd'
   'lib32-vulkan-icd-loader'
   'lib32-wayland'
   'lib32-xcb-util-keysyms'
@@ -59,13 +58,16 @@
 )
 source=(
   https://mesa.freedesktop.org/archive/mesa-${pkgver}.tar.xz{,.sig}
+  radeon_bo_can_reclaim_slab.diff
   LICENSE
 )
-sha256sums=('f387192b08c471c545590dd12230a2a343244804b5fe866fec6aea02eab57613'
+sha256sums=('77aec9a2a37b7d3596ea1640b3cc53d0b5d9b3b52abed89de07e3717e91bfdbe'
             'SKIP'
+            '3fd1ad8cd29319502a6f80ecb96bb9a059e5de83a8b6e39f23de8d93921fd922'
             '7052ba73bb07ea78873a2431ee4e828f4e72bda7d176d07f770fa48373dec537')
-b2sums=('05eb98f2fec0d15e63e8da2ca2e563d0b6fb7e29d639e66fc69074b7550939160e6f29121b80f2c64083625f2b13aa728221443b1f5adf2dd0fd92056ed9dc40'
+b2sums=('7af5dc7f11bb11a3d04b3d71b5122a5bf9fe9242440444f266c6d1fac5891b4380a5f792fb66216f1937a7d886402f786d44365c93362d31fb6840d0954c95b4'
         'SKIP'
+        'e7c3451a342cc648149375ce58697ae24273d47060e74ca2948d45ea8fe29b104f1daae4c91968fb6f37d41963d176987abf9ee21acfba0172a9b5d30300a72e'
         '1ecf007b82260710a7bf5048f47dd5d600c168824c02c595af654632326536a6527fbe0738670ee7b921dd85a70425108e0f471ba85a8e1ca47d294ad74b4adb')
 validpgpkeys=('8703B6700E7EE06D7A39B8D6EDAE37B02CEB490D'  # Emil Velikov <emil.l.velikov@gmail.com>
               '946D09B5E4C9845E63075FF1D961C596A7203456'  # Andres Gomez <tanty@igalia.com>
@@ -76,6 +78,8 @@
 
 prepare() {
   cd mesa-$pkgver
+
+  patch -Np1 -i ../radeon_bo_can_reclaim_slab.diff
 
   echo "$pkgver-arch$epoch.$pkgrel" >VERSION
 }
@@ -121,7 +125,7 @@
 
   export BINDGEN_EXTRA_CLANG_ARGS="-m32"
 
-  arch-meson mesa-$pkgver build "${meson_options[@]}"
+  artix-meson mesa-$pkgver build "${meson_options[@]}"
   meson configure build # Print config
   meson compile -C build
 
@@ -216,7 +220,6 @@
     'lib32-libdrm'
     'lib32-libx11'
     'lib32-libxshmfence'
-    'lib32-systemd'
     'lib32-wayland'
     'lib32-xcb-util-keysyms'
     'lib32-zstd'
@@ -238,7 +241,6 @@
     'lib32-libx11'
     'lib32-libxshmfence'
     'lib32-llvm-libs'
-    'lib32-systemd'
     'lib32-wayland'
     'lib32-xcb-util-keysyms'
     'lib32-zstd'
@@ -263,7 +265,6 @@
     'lib32-libx11'
     'lib32-libxshmfence'
     'lib32-llvm-libs'
-    'lib32-systemd'
     'lib32-wayland'
     'lib32-xcb-util-keysyms'
     'lib32-zstd'
@@ -285,7 +286,6 @@
     'lib32-libdrm'
     'lib32-libx11'
     'lib32-libxshmfence'
-    'lib32-systemd'
     'lib32-wayland'
     'lib32-xcb-util-keysyms'
     'lib32-zstd'


############# Stripped diff below #################

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -17,6 +17,7 @@
 '57551DE15B968F6341C248F68D8E31AFC32428A6') # Eric Engestrom <eric@engestrom.ch>
 prepare() {
 cd mesa-$pkgver
+patch -Np1 -i ../radeon_bo_can_reclaim_slab.diff
 echo "$pkgver-arch$epoch.$pkgrel" >VERSION
 }
 build() {
@@ -57,7 +58,7 @@
 CFLAGS+=' -g1'
 CXXFLAGS+=' -g1'
 export BINDGEN_EXTRA_CLANG_ARGS="-m32"
-arch-meson mesa-$pkgver build "${meson_options[@]}"
+artix-meson mesa-$pkgver build "${meson_options[@]}"
 meson configure build # Print config
 meson compile -C build
 DESTDIR="${srcdir}/fakeinstall" meson install -C build
@@ -130,7 +131,6 @@
 'lib32-libdrm'
 'lib32-libx11'
 'lib32-libxshmfence'
-'lib32-systemd'
 'lib32-wayland'
 'lib32-xcb-util-keysyms'
 'lib32-zstd'
@@ -147,7 +147,6 @@
 'lib32-libx11'
 'lib32-libxshmfence'
 'lib32-llvm-libs'
-'lib32-systemd'
 'lib32-wayland'
 'lib32-xcb-util-keysyms'
 'lib32-zstd'
@@ -166,7 +165,6 @@
 'lib32-libx11'
 'lib32-libxshmfence'
 'lib32-llvm-libs'
-'lib32-systemd'
 'lib32-wayland'
 'lib32-xcb-util-keysyms'
 'lib32-zstd'
@@ -183,7 +181,6 @@
 'lib32-libdrm'
 'lib32-libx11'
 'lib32-libxshmfence'
-'lib32-systemd'
 'lib32-wayland'
 'lib32-xcb-util-keysyms'
 'lib32-zstd'
