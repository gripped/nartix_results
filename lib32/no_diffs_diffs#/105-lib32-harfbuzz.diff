--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -6,21 +6,16 @@
   lib32-harfbuzz-icu
 )
 pkgver=8.4.0
-pkgrel=2
+pkgrel=1
 pkgdesc="OpenType text shaping engine - 32-bit"
-url="https://harfbuzz.github.io/"
+url="https://www.freedesktop.org/wiki/Software/HarfBuzz"
 arch=(x86_64)
 license=(MIT)
-depends=(
-  harfbuzz
-  lib32-freetype2
-  lib32-gcc-libs
-  lib32-glib2
-  lib32-glibc
-)
 makedepends=(
   git
   lib32-cairo
+  lib32-freetype2
+  lib32-glib2
   lib32-icu
   meson
   python
@@ -30,14 +25,14 @@
   python-fonttools
   python-setuptools
 )
-source=("git+https://github.com/harfbuzz/harfbuzz?signed#tag=$pkgver")
+_commit=63973005bc07aba599b47fdd4cf788647b601ccd  # tags/8.4.0^0
+source=("git+https://github.com/harfbuzz/harfbuzz#commit=$_commit")
 b2sums=('19f25dbf2ba6d90fdbb4ecb1039c8d0d72c55cff3dc3b30d6b75b626c15bf28a2118495837d80b7f622f0929dd7d4a07b5526963e1204bb9c90bc9f976c26977')
-validpgpkeys=(
-  053D20F17CCCA9651B2C6FCB9AB24930C0B997A2 # Khaled Hosny <khaled@aliftype.com> (@khaledhosny)
-  9F377DDB6D3153A48EB3EB1E63CC496475267693 # Caleb Maclennan <caleb@alerque.com> (@alerque)
-  2277650A4E8BDFE4B7F6BE419FEE04E5D3531115 # Ebrahim Byagowi <ebrahim@gnu.org> (@ebraminio)
-  EACF64F53455E2771BA661A4803B21859F015E4E # Behdad Esfahbod <behdad@behdad.org> (@behdad)
-)
+
+pkgver() {
+  cd harfbuzz
+  git describe --tags | sed 's/[^-]*-g/r&/;s/-/+/g'
+}
 
 prepare() {
   cd harfbuzz
@@ -54,7 +49,7 @@
   CFLAGS="${CFLAGS/-fexceptions/}"
   CXXFLAGS="${CXXFLAGS/-fexceptions/}"
 
-  arch-meson harfbuzz build "${meson_options[@]}"
+  artix-meson harfbuzz build "${meson_options[@]}"
   meson compile -C build
 }
 
@@ -75,7 +70,8 @@
 }
 
 package_lib32-harfbuzz() {
-  depends+=(
+  depends=(
+    harfbuzz
     libfreetype.so
     libg{lib,object}-2.0.so
   )
@@ -100,11 +96,6 @@
   pkgdesc+=" - Cairo integration"
   depends=(
     harfbuzz-cairo
-    lib32-cairo
-    lib32-freetype2
-    lib32-glib2
-    lib32-glibc
-    lib32-harfbuzz
     libcairo.so
     libharfbuzz.so
   )
@@ -119,9 +110,6 @@
   pkgdesc+=" - ICU integration"
   depends=(
     harfbuzz-icu
-    lib32-glibc
-    lib32-harfbuzz
-    lib32-icu
     libharfbuzz.so
     libicuuc.so
   )


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -4,10 +4,7 @@
 harfbuzz-icu
 lib32-cairo
 lib32-freetype2
-lib32-gcc-libs
 lib32-glib2
-lib32-glibc
-lib32-harfbuzz
 lib32-icu
 libcairo.so
 libfreetype.so

--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -10,6 +10,6 @@
 )
 CFLAGS="${CFLAGS/-fexceptions/}"
 CXXFLAGS="${CXXFLAGS/-fexceptions/}"
-arch-meson harfbuzz build "${meson_options[@]}"
+artix-meson harfbuzz build "${meson_options[@]}"
 meson compile -C build
 }
