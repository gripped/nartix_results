--- Arch PKGBUILD
+++ Artix PKGBUILD
@@ -1,54 +1,30 @@
 
 pkgname=pam
-pkgver=1.7.0
-pkgrel=1
+pkgver=1.6.1
+pkgrel=3
 pkgdesc="PAM (Pluggable Authentication Modules) library"
 arch=('x86_64')
 license=('GPL-2.0-only')
 url="http://linux-pam.org"
-depends=(
-  audit
-  glibc
-  libaudit.so
-  libcrypt.so
-  libnsl
-  libtirpc
-  libxcrypt
-  pambase
-  systemd-libs
-)
-makedepends=(
-  docbook-xml
-  docbook-xsl
-  docbook5-xml
-  flex
-  fop
-  git
-  libxslt
-  meson
-  w3m
-)
-provides=(
-  libpam.so
-  libpamc.so
-  libpam_misc.so
-)
-backup=(
-  etc/security/{access.conf,faillock.conf,group.conf,limits.conf,namespace.conf,namespace.init,pwhistory.conf,pam_env.conf,time.conf}
-  etc/environment
-)
+depends=('glibc' 'libtirpc' 'pambase' 'audit' 'libaudit.so' 'libxcrypt' 'libcrypt.so' 'libnsl' 'libelogind')
+makedepends=('git' 'flex' 'w3m' 'libxslt' 'docbook-xml' 'docbook5-xml' 'docbook-xsl' 'fop')
+provides=('libpam.so' 'libpamc.so' 'libpam_misc.so')
+backup=(etc/security/{access.conf,faillock.conf,group.conf,limits.conf,namespace.conf,namespace.init,pwhistory.conf,pam_env.conf,time.conf} etc/environment)
 source=("pam::git+https://github.com/linux-pam/linux-pam?signed#tag=v${pkgver}"
-        "${pkgname}.tmpfiles")
+        "${pkgname}.tmpfiles"
+        pam-elogind-suport.patch::https://github.com/linux-pam/linux-pam/pull/787/commits/d59e00bdc9ba133ba11abeba08f80d3495501d14.patch)
 validpgpkeys=(
         '8C6BFD92EE0F42EDF91A6A736D1A7F052E5924BB' # Thorsten Kukuk
         '296D6F29A020808E8717A8842DB5BD89A340AEB7' # Dimitry V. Levin <ldv@altlinux.org>
 )
-b2sums=('88ecba59692fe86f6f6516007b87fb897018cc5f818c106a037f15df4dda7c31e50fbfcb137493d49cb754e41f2f69a60f24ffea3374ff5e38ce6263bfa7abac'
-        '36582c80020008c3810b311a2e126d2fb4ffc94e565ea4c0c0ab567fdb92943e269781ffa548550742feb685847c26c340906c7454dcc31df4e1e47d511d8d6f')
+b2sums=('12891f9064ce7f00d22452d8ff39c14af87c24f9fbf3eab65e475a7d2a592d2b1c1d585f3718b2fa72f277a8ad1faa17149fe0a911bfabdaa4a2957c32e29fe3'
+        '36582c80020008c3810b311a2e126d2fb4ffc94e565ea4c0c0ab567fdb92943e269781ffa548550742feb685847c26c340906c7454dcc31df4e1e47d511d8d6f'
+        '868cd9b237f1f77d5b1b298a0c3607e4a0580d0bad94027e162e4f3b5b677ad7fb3428a9dec102281862540b1109923e5dda025c80f3371ccfa8e9f855d9d7ea')
 options=('!emptydirs')
 
 prepare() {
   cd "${pkgname}"
+  ./autogen.sh
   local src
   for src in "${source[@]}"; do
     src="${src%%::*}"
@@ -60,22 +36,19 @@
 }
 
 build() {
-  arch-meson "${pkgname}" \
-    -Dlogind=enabled \
-    -Deconf=disabled \
-    -Dselinux=disabled \
-    -Dpam_userdb=disabled \
-    build
-  meson compile -C build
-}
-
-check() {
-  meson test -C build
+  cd "${pkgname}"
+  ./configure --without-systemdunitdir \
+    --libdir=/usr/lib \
+    --sbindir=/usr/bin \
+    --enable-logind=elogind \
+    --disable-db
+  make
 }
 
 package() {
-  meson install -C build --destdir "${pkgdir}"
   install -Dm 644 $pkgname.tmpfiles "${pkgdir}"/usr/lib/tmpfiles.d/${pkgname}.conf
+  cd "${pkgname}"
+  make DESTDIR="${pkgdir}" SCONFIGDIR=/etc/security install
 
   chmod +s "${pkgdir}"/usr/bin/unix_chkpwd
 }


############# Stripped diff below #################

--- arch_depends
+++ artix_depends
@@ -8,11 +8,10 @@
 glibc
 libaudit.so
 libcrypt.so
+libelogind
 libnsl
 libtirpc
 libxcrypt
 libxslt
-meson
 pambase
-systemd-libs
 w3m